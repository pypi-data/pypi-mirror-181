# Copyright (c) 2020, NVIDIA CORPORATION. All rights reserved.
# TLT spec file for training the Jasper model for TTS using the Mozilla Common Voice English dataset.

sample_rate: 22050
train_dataset: ???
validation_dataset: ???
prior_folder: ???
phoneme_dict_path: ???
heteronyms_path: ???
whitelist_path: ???
sup_data_types: [ "align_prior_matrix", "pitch" , "speaker_id"]

n_speakers: ???
n_window_size: 1024
n_window_stride: 256
pitch_fmin: ???
pitch_fmax: ???
pitch_avg: ???
pitch_std: ???

train_ds:
  dataset:
    _target_: "nemo.collections.tts.torch.data.TTSDataset"
    manifest_filepath: ${train_dataset}
    max_duration: null
    min_duration: 0.1
    int_values: false
    normalize: true
    sample_rate: ${sample_rate}
    trim: true
    trim_top_db: 50
    sup_data_path: ${prior_folder}
    sup_data_types: ${sup_data_types}
    n_window_stride: ${n_window_stride}
    n_window_size: ${n_window_size}
    pitch_fmin: ${pitch_fmin}
    pitch_fmax: ${pitch_fmax}
    pitch_mean: ${pitch_avg}
    pitch_std: ${pitch_std}
    pitch_norm: true
    n_fft: 1024
    win_length: 1024
    hop_length: 256
    window: "hann"
    n_mels: 80
    lowfreq: 0
    highfreq: 8000
    ignore_file: null
    text_normalizer:
      _target_: nemo_text_processing.text_normalization.normalize.Normalizer
      lang: en
      input_case: cased
      whitelist: ${whitelist_path}
    text_normalizer_call_kwargs:
      verbose: false
      punct_pre_process: true
      punct_post_process: true
    text_tokenizer:
      _target_: nemo.collections.tts.torch.tts_tokenizers.EnglishPhonemesTokenizer
      punct: true
      stresses: true
      chars: true
      apostrophe: true
      pad_with_space: true
      g2p:
        _target_: nemo.collections.tts.torch.g2ps.EnglishG2p
        phoneme_dict: ${phoneme_dict_path}
        heteronyms: ${heteronyms_path}
        phoneme_probability: 0.5
  dataloader_params:
      drop_last: false
      shuffle: true
      batch_size: 16
      num_workers: 12

validation_ds:
  dataset:
    _target_: "nemo.collections.tts.torch.data.TTSDataset"
    manifest_filepath: ${validation_dataset}
    max_duration: null
    min_duration: 0.1
    int_values: false
    normalize: true
    sample_rate: ${sample_rate}
    trim: true
    sup_data_path: ${prior_folder}
    sup_data_types: ${sup_data_types}
    n_window_stride: ${n_window_stride}
    n_window_size: ${n_window_size}
    pitch_fmin: ${pitch_fmin}
    pitch_fmax: ${pitch_fmax}
    pitch_mean: ${pitch_avg}
    pitch_std: ${pitch_std}
    pitch_norm: true
    n_fft: 1024
    win_length: 1024
    hop_length: 256
    window: "hann"
    n_mels: 80
    lowfreq: 0
    highfreq: 8000
    ignore_file: null
    text_normalizer:
      _target_: nemo_text_processing.text_normalization.normalize.Normalizer
      lang: en
      input_case: cased
      whitelist: ${whitelist_path}
    text_normalizer_call_kwargs:
      verbose: false
      punct_pre_process: true
      punct_post_process: true
    text_tokenizer:
      _target_: nemo.collections.tts.torch.tts_tokenizers.EnglishPhonemesTokenizer
      punct: true
      stresses: true
      chars: true
      apostrophe: true
      pad_with_space: true
      g2p:
        _target_: nemo.collections.tts.torch.g2ps.EnglishG2p
        phoneme_dict: ${phoneme_dict_path}
        heteronyms: ${heteronyms_path}
        phoneme_probability: 0.5
  dataloader_params:
      drop_last: false
      shuffle: true
      batch_size: 32
      num_workers: 12



optim:
  name: adam
  lr: 2e-4
  betas: [0.9, 0.98]
  weight_decay: 1e-6

