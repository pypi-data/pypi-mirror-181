---
# Copyright 2022 Red Hat, Inc.
# All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License"); you may
# not use this file except in compliance with the License. You may obtain
# a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
# License for the specific language governing permissions and limitations
# under the License.


# While options found within the vars/ path can be overridden using extra
# vars, items within this path are considered part of the role and not
# intended to be modified.

# All variables within this role should have a prefix of "tripleo_httpd_config"

tripleo_httpd_config_base_dir: '/var/lib/config-data/ansible-generated'

# Those are the default modules loaded by apache when managed by puppetlabs
# with apache::default_mods set to false.
# We also enable ssl module by default, but not wsgi.
tripleo_httpd_config_default_mods:
  authz_core: []
  authz_host: []
  filter: []
  log_config: []
  mime:
    - TypesConfig: "/etc/mime.types"
    - AddType: "application/x-compress .Z"
    - AddType: "application/x-gzip .gz .tgz"
    - AddType: "application/x-bzip2 .bz2"
    - AddType: "text/html .shtml"
    - AddLanguage: "ca .ca"
    - AddLanguage: "cs .cz .cs"
    - AddLanguage: "da .dk"
    - AddLanguage: "de .de"
    - AddLanguage: "el .el"
    - AddLanguage: "en .en"
    - AddLanguage: "eo .eo"
    - AddLanguage: "es .es"
    - AddLanguage: "et .et"
    - AddLanguage: "fr .fr"
    - AddLanguage: "he .he"
    - AddLanguage: "hr .hr"
    - AddLanguage: "it .it"
    - AddLanguage: "ja .ja"
    - AddLanguage: "ko .ko"
    - AddLanguage: "ltz .ltz"
    - AddLanguage: "nl .nl"
    - AddLanguage: "nn .nn"
    - AddLanguage: "no .no"
    - AddLanguage: "pl .po"
    - AddLanguage: "pt .pt"
    - AddLanguage: "pt-BR .pt-br"
    - AddLanguage: "ru .ru"
    - AddLanguage: "sv .sv"
    - AddLanguage: "zh-CN .zh-cn"
    - AddLanguage: "zh-TW .zh-tw"
    - AddHandler: "type-map var"
    - AddOutputFilter: "INCLUDES .shtml"
  mpm_prefork:
    - StartServers: 8
    - MinSpareServers: 5
    - MaxSpareServers: 20
    - ServerLimit: " {{ tripleo_httpd_config_prefork_serverlimit | default(100) }}"
    - MaxRequestWorkers: "{{ tripleo_httpd_config_prefork_maxrequestworkers | default(100) }}"
    - MaxRequestsPerChild: 4000
    - ListenBacklog: 511
  setenvif:
    - BrowserMatch: '"Mozilla/2" nokeepalive'
    - BrowserMatch: '"MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0'
    - BrowserMatch: '"RealPlayer 4\.0" force-response-1.0'
    - BrowserMatch: '"Java/1\.0" force-response-1.0'
    - BrowserMatch: '"JDK/1\.0" force-response-1.0'
    - BrowserMatch: '"Microsoft Data Access Internet Publishing Provider" redirect-carefully'
    - BrowserMatch: '"MS FrontPage" redirect-carefully'
    - BrowserMatch: '"^WebDrive" redirect-carefully'
    - BrowserMatch: '"^WebDAVFS/1.[0123]" redirect-carefully'
    - BrowserMatch: '"^gnome-vfs/1.0" redirect-carefully'
    - BrowserMatch: '"^gvfs/1" redirect-carefully'
    - BrowserMatch: '"^XML Spy" redirect-carefully'
    - BrowserMatch: '"^Dreamweaver-WebDAV-SCM1" redirect-carefully'
    - BrowserMatch: '" Konqueror/4" redirect-carefully'
    - BrowserMatch: '"MSIE [2-6]" nokeepalive ssl-unclean-shutdown downgrade-1.0 force-response-1.0'
    - BrowserMatch: '"MSIE [17-9]" ssl-unclean-shutdown'
  socache_shmcb: []
  status: []
  systemd: []
  unixd: []

# These configurations are the same as provided by default by puppetlabs-apache
tripleo_httpd_config_default_httpd_conf:
  ServerTokens: 'Prod'
  ServerSignature: 'Off'
  TraceEnable: 'Off'
  ServerRoot: '/etc/httpd'
  PidFile: 'run/httpd.pid'
  TimeOut: 90
  KeepAlive: 'On'
  MaxKeepAliveRequests: 100
  KeepAliveTimeout: 15
  LimitRequestFieldSize: 8190
  LimitRequestFields: 100
  User: 'apache'
  Group: 'apache'
  AccessFileName: '.htaccess'
  HostnameLookups: 'Off'
  ErrorLog: '/var/log/httpd/error_log'
  LogLevel: 'warn'
  EnableSendfile: 'On'
