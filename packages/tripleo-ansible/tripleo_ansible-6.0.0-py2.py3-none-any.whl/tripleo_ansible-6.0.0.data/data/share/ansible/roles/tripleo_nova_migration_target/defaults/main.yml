---
# Copyright 2022 Red Hat, Inc.
# All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License"); you may
# not use this file except in compliance with the License. You may obtain
# a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
# License for the specific language governing permissions and limitations
# under the License.


# All variables intended for modification should be placed in this file.

# All variables within this role should have a prefix of "tripleo_nova_migration_target"
tripleo_nova_migration_target_debug: "{{ (ansible_verbosity | int) >= 2 | bool }}"

tripleo_nova_migration_target_hide_sensitive_logs: true

tripleo_nova_migration_target_config_image: ""
tripleo_nova_migration_target_volumes:
  - /var/lib/kolla/config_files/nova-migration-target.json:/var/lib/kolla/config_files/config.json:ro
  - /var/lib/config-data/puppet-generated/nova_libvirt:/var/lib/kolla/config_files/src:ro
  - /etc/ssh:/host-ssh:ro
  - /run/libvirt:/run/libvirt:shared,z
  - /var/lib/nova:/var/lib/nova:shared
tripleo_nova_migration_target_sshd_port: "{{ tripleo_migration_ssh_port | default('2022'. true) }}"
tripleo_nova_migration_target_ssh_key: >
  {{ tripleo_migration_ssh_key | default({"public_key": "", "private_key": ""}, true) }}

# from t-h-t hiera mappings
tripleo_nova_migration_target_sshd_password_authentication: 'no' # not a boolean
tripleo_nova_migration_target_sshd_listen: internal_api # NovaApiNetwork
tripleo_nova_migration_target_ssh_authorized_keys: >
  {{ tripleo_nova_migration_target_ssh_key["public_key"] }}
tripleo_nova_migration_target_sshd_options:
  HostKey:
    - '/etc/ssh/ssh_host_rsa_key'
    - '/etc/ssh/ssh_host_ecdsa_key'
    - '/etc/ssh/ssh_host_ed25519_key'
  SyslogFacility: 'AUTHPRIV'
  AuthorizedKeysFile: '.ssh/authorized_keys'
  ChallengeResponseAuthentication: 'no'
  GSSAPIAuthentication: 'no'
  GSSAPICleanupCredentials: 'no'
  UsePAM: 'yes'
  UseDNS: 'no'
  X11Forwarding: 'yes'
  AcceptEnv:
    - 'LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES'
    - 'LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT'
    - 'LC_IDENTIFICATION LC_ALL LANGUAGE'
    - 'XMODIFIERS'
  Subsystem: 'sftp  /usr/libexec/openssh/sftp-server'
