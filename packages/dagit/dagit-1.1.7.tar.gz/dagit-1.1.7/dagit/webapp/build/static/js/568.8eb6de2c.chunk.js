"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[568],{25429:function(e,n,t){t.d(n,{t:function(){return s}});var o=t(8546),r=(t(325),t(14156)),i=t(32289),s=function(e){console.error("Error launching run:",e);var n="Failed to fetch"===e.message?(0,i.jsx)("div",{style:{fontFamily:o.b.default},children:"Make sure the Dagit server is running and try again."}):(0,i.jsx)("div",{children:e.message});(0,r._)({title:"Could not launch run",body:n})}},42677:function(e,n,t){t.r(n),t.d(n,{RunRoot:function(){return ft},default:function(){return ht}});var o,r,i,s,a,l,u,c,d,p,g=t(99500),f=t(73701),h=t(3159),m=t(32030),v=t(31112),x=t(12745),y=t(8546),w=t(54268),b=t(762),C=t(89646),j=t(325),S=t(27601),L=t(76341),I=t(78093),N=t(39061),Z=t(62e3),R=t(68156),T=t(76336),k=t(37099),E=t(39956),D=t(4998),_=t(59019),K=t(95764),P=t(19065),F=t(922),O=t(17912),U=t(81034),q=t(70157),M=t(7838),$=t(24971),V=t(57994),A=t(98907),G=t(64428),Q=t(28463),J=t(6466),W=t(34595),z=t(65502),H=t.n(z),B=t(32289),Y=j.memo((function(e){var n=e.logData,t=e.location,o=e.isLoading,r=e.isVisible,i=e.downloadUrl,s=j.useRef(null),a=j.useRef(),l=j.useState(!1),u=(0,P.Z)(l,2),c=u[0],d=u[1],p=function(){a.current&&(clearTimeout(a.current),a.current=0)},g=function(){d(!1),p()},f=function(){a.current=window.setTimeout(g,3e3)},h=n,m=X(h);if(h&&m){var v=h.indexOf("\n")+1,x=v<h.length?h.slice(v):h;h="\x1b[33m...logs truncated...\x1b[39m\n"+x}var y=m?(0,B.jsx)(fe,{children:(0,B.jsxs)(J.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,B.jsx)($.JO,{name:"warning",color:M.w.Yellow500}),(0,B.jsxs)("div",{children:["This log has exceeded the 5MB limit."," ",i?(0,B.jsx)("a",{href:i,download:!0,children:"Download the full log file"}):null,"."]})]})}):null;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(se,{isVisible:r,children:[c?(0,B.jsx)(pe,{children:(0,B.jsx)(ge,{onClick:function(){s.current&&s.current.scrollToTop()},onMouseOver:p,onMouseOut:f,children:(0,B.jsxs)(J.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,B.jsx)($.JO,{name:"arrow_upward",color:M.w.White}),"Scroll to top"]})})}):null,(0,B.jsxs)(le,{children:[y,(0,B.jsx)(ue,{children:(0,B.jsx)(ce,{isSelected:!0,content:n,onScrollUp:function(e){p(),e?(d(!0),f()):g()},onScrollDown:g,ref:s})})]}),o?(0,B.jsx)(de,{children:(0,B.jsx)(W.$,{purpose:"page"})}):null]}),t?(0,B.jsx)(ae,{isVisible:r,children:t}):null]})})),X=function(e){return!!e&&(new TextEncoder).encode(e).length>=5242880},ee=function(e){(0,G.Z)(t,e);var n=(0,Q.Z)(t);function t(){var e;(0,V.Z)(this,t);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).container=j.createRef(),e.lastScroll=0,e.onScroll=function(){if(e.container.current&&e.props.isSelected){var n=e.props,t=n.onScrollUp,o=n.onScrollDown,r=e.container.current,i=r.scrollHeight,s=r.scrollTop/(i-r.offsetHeight);e.container.current.scrollTop<e.lastScroll?t&&t(s):o&&o(s),e.lastScroll=e.container.current.scrollTop}},e}return(0,A.Z)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom(),this.container.current&&(this.container.current.focus(),this.container.current.addEventListener("scroll",this.onScroll))}},{key:"getSnapshotBeforeUpdate",value:function(){if(!this.container.current)return!1;var e=this.container.current,n=e.scrollHeight,t=e.scrollTop;return e.offsetHeight+t>=n}},{key:"componentDidUpdate",value:function(e,n,t){t&&this.scrollToBottom(),this.props.isSelected&&!e.isSelected&&this.container.current&&this.container.current.focus()}},{key:"focus",value:function(){var e=this.container.current;e&&e.focus()}},{key:"scrollToBottom",value:function(){var e=this.container.current;e&&(e.scrollTop=e.scrollHeight-e.offsetHeight)}},{key:"scrollToTop",value:function(){var e=this.container.current;e&&(e.scrollTop=0,e.focus())}},{key:"render",value:function(){var e=this.props,n=e.content,t=e.className;return n?(0,B.jsx)("div",{className:t,style:{outline:"none"},ref:this.container,tabIndex:0,children:(0,B.jsxs)(ie,{children:[(0,B.jsx)(ne,{content:n}),(0,B.jsxs)(te,{children:[(0,B.jsx)(re,{}),(0,B.jsx)(H(),{linkify:!1,useClasses:!0,children:n})]})]})}):(0,B.jsx)("div",{className:t,ref:this.container,children:(0,B.jsx)(ie,{style:{justifyContent:"center",alignItems:"center"},children:null==n?"No log file available":"No output"})})}}]),t}(j.Component),ne=function(e){var n=e.content;if(!n)return null;var t=n.match(/\n/g),o=t?t.length:0;return(0,B.jsx)(oe,{children:Array.from(Array(o),(function(e,n){return(0,B.jsx)("div",{children:String(n+1)},n)}))})},te=F.ZP.div.withConfig({displayName:"RawLogContent__Content",componentId:"q0p96u-0"})(["padding:10px;background-color:",";"],M.w.Gray900),oe=F.ZP.div.withConfig({displayName:"RawLogContent__LineNumberContainer",componentId:"q0p96u-1"})(["display:flex;flex-direction:column;align-items:flex-end;border-right:1px solid #5c7080;padding:10px 10px 10px 20px;margin-right:5px;background-color:",";opacity:0.8;color:#858585;min-height:100%;"],M.w.Gray900),re=(0,F.vJ)(o||(o=(0,g.Z)(["\n  .ansi-black {\n    color: #586e75;\n  }\n  .ansi-red {\n    color: #dc322f;\n  }\n  .ansi-green {\n    color: #859900;\n  }\n  .ansi-yellow {\n    color: #b58900;\n  }\n  .ansi-blue {\n    color: #268bd2;\n  }\n  .ansi-magenta {\n    color: #d33682;\n  }\n  .ansi-cyan {\n    color: #2aa198;\n  }\n  .ansi-white {\n    color: #eee8d5;\n  }\n"]))),ie=F.ZP.div.withConfig({displayName:"RawLogContent__ContentContainer",componentId:"q0p96u-2"})(["display:flex;flex-direction:row;min-height:100%;background-color:",";"],M.w.Gray900),se=F.ZP.div.withConfig({displayName:"RawLogContent__FileContainer",componentId:"q0p96u-3"})(["flex:1;height:100%;position:relative;&:first-child{border-right:0.5px solid #5c7080;}display:flex;flex-direction:column;",""],(function(e){return e.isVisible?null:"display: none;"})),ae=F.ZP.div.withConfig({displayName:"RawLogContent__FileFooter",componentId:"q0p96u-4"})(["display:flex;flex-direction:row;align-items:center;height:30px;background-color:",";border-top:0.5px solid #5c7080;color:#aaaaaa;padding:2px 5px;font-size:0.85em;",""],M.w.Gray900,(function(e){return e.isVisible?null:"display: none;"})),le=F.ZP.div.withConfig({displayName:"RawLogContent__FileContent",componentId:"q0p96u-5"})(["flex:1;display:flex;flex-direction:column;"]),ue=F.ZP.div.withConfig({displayName:"RawLogContent__RelativeContainer",componentId:"q0p96u-6"})(["flex:1;position:relative;"]),ce=(0,F.ZP)(ee).withConfig({displayName:"RawLogContent__LogContent",componentId:"q0p96u-7"})(["color:#eeeeee;font-family:",";font-size:16px;white-space:pre;overflow:auto;position:absolute;top:0;bottom:0;left:0;right:0;"],y.b.monospace),de=F.ZP.div.withConfig({displayName:"RawLogContent__LoadingContainer",componentId:"q0p96u-8"})(["display:flex;justifycontent:center;alignitems:center;position:absolute;top:0;bottom:0;left:0;right:0;backgroundcolor:",";opacity:0.3;"],M.w.Gray800),pe=F.ZP.div.withConfig({displayName:"RawLogContent__ScrollToast",componentId:"q0p96u-9"})(["position:absolute;height:30px;top:0;left:0;right:0;display:flex;flex-direction:row;justify-content:center;align-items:flex-start;z-index:1;"]),ge=F.ZP.div.withConfig({displayName:"RawLogContent__ScrollToTop",componentId:"q0p96u-10"})(["background-color:black;padding:10px 20px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;color:white;border-bottom:0.5px solid #5c7080;border-left:0.5px solid #5c7080;border-right:0.5px solid #5c7080;cursor:pointer;"]),fe=F.ZP.div.withConfig({displayName:"RawLogContent__FileWarning",componentId:"q0p96u-11"})(["background-color:#fffae3;padding:10px 20px;margin:20px 70px;border-radius:5px;"]),he=t(52848),me=t(99738),ve=["externalUrl"],xe=j.memo((function(e){var n=e.externalUrl,t=(0,U.Z)(e,ve);return n?(0,B.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",justifyContent:"center",gap:1},background:M.w.Gray900,style:{color:M.w.White,flex:1,minHeight:0},children:["View logs at",(0,B.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",style:{color:M.w.White,textDecoration:"underline",marginLeft:4,marginRight:4},children:n}),(0,B.jsx)($.JO,{name:"open_in_new",color:M.w.White,size:20,style:{marginTop:2}})]}):t.logKey.length?(0,B.jsx)(Te,(0,K.Z)({},t)):null})),ye=5242880,we=function(e){return e.length<ye?e:e.slice(-5242880)},be=function(e,n){return n?we(e?e+n:n):e||null},Ce=function(e,n){var t,o,r;switch(n.type){case"update":return(0,K.Z)((0,K.Z)({},e),{},{isLoading:!1,cursor:null===(t=n.logData)||void 0===t?void 0:t.cursor,stdout:be(e.stdout,null===(o=n.logData)||void 0===o?void 0:o.stdout),stderr:be(e.stderr,null===(r=n.logData)||void 0===r?void 0:r.stderr)});case"metadata":return(0,K.Z)((0,K.Z)({},e),n.metadata);case"reset":return(0,K.Z)({},je);default:return e}},je={stdout:null,stderr:null,cursor:null,isLoading:!0},Se=j.memo((function(e){var n=e.logKey,t=e.onLogData;return(0,q.m)(Le,{fetchPolicy:"no-cache",variables:{logKey:n},onSubscriptionData:function(e){var n,o=e.subscriptionData;null!==(n=o.data)&&void 0!==n&&n.capturedLogs&&t(o.data.capturedLogs)}}),null})),Le=(0,h.Ps)(r||(r=(0,g.Z)(["\n  subscription CapturedLogsSubscription($logKey: [String!]!, $cursor: String) {\n    capturedLogs(logKey: $logKey, cursor: $cursor) {\n      stdout\n      stderr\n      cursor\n    }\n  }\n"]))),Ie=(0,h.Ps)(i||(i=(0,g.Z)(["\n  query CapturedLogsMetadataQuery($logKey: [String!]!) {\n    capturedLogsMetadata(logKey: $logKey) {\n      stdoutDownloadUrl\n      stdoutLocation\n      stderrDownloadUrl\n      stderrLocation\n    }\n  }\n"]))),Ne=function(e){var n=e.logKey,t=e.children,o=j.useReducer(Ce,je),r=(0,P.Z)(o,2),i=r[0],s=r[1],a=JSON.stringify(n);j.useEffect((function(){s({type:"reset"})}),[a]);var l=j.useCallback((function(e){s({type:"update",logData:e})}),[]);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Se,{logKey:n,onLogData:l}),t(i)]})},Ze=function(e){var n=e.logKey,t=e.children,o=j.useReducer(Ce,je),r=(0,P.Z)(o,2),i=r[0],s=r[1],a=JSON.stringify(n);j.useEffect((function(){s({type:"reset"})}),[a]);var l=i.cursor,u=(0,f.a)(Re,{notifyOnNetworkStatusChange:!0,variables:{logKey:n,cursor:l,limit:1e5},pollInterval:5e3,onCompleted:function(e){c(),s({type:"update",logData:e.capturedLogs}),d(5e3)}}),c=u.stopPolling,d=u.startPolling;return(0,B.jsx)(B.Fragment,{children:t(i)})},Re=(0,h.Ps)(s||(s=(0,g.Z)(["\n  query CapturedLogsQuery($logKey: [String!]!, $cursor: String, $limit: Int) {\n    capturedLogs(logKey: $logKey, cursor: $cursor, limit: $limit) {\n      stdout\n      stderr\n      cursor\n    }\n  }\n"]))),Te=j.memo((function(e){var n,t,o=e.logKey,r=e.visibleIOType,i=e.onSetDownloadUrl,s=j.useContext(he.I).rootServerURI,a=j.useContext(me.DN),l=a.availability,u=a.disabled,c=(0,f.a)(Ie,{variables:{logKey:o},fetchPolicy:"cache-and-network"});j.useEffect((function(){if(i&&c.data){var e="stdout"===r?c.data.capturedLogsMetadata.stdoutDownloadUrl:c.data.capturedLogsMetadata.stderrDownloadUrl;e&&(e.startsWith("/")?i(s+e):i(e))}}),[i,r,s,c.data]);var d=(null===(n=c.data)||void 0===n?void 0:n.capturedLogsMetadata.stdoutLocation)||void 0,p=(null===(t=c.data)||void 0===t?void 0:t.capturedLogsMetadata.stderrLocation)||void 0,g="unavailable"===l||u?Ze:Ne;return(0,B.jsx)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:(0,B.jsx)(g,{logKey:o,children:function(e){return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Y,{logData:e.stdout,isLoading:e.isLoading,location:d,isVisible:"stdout"===r}),(0,B.jsx)(Y,{logData:e.stderr,isLoading:e.isLoading,location:p,isVisible:"stderr"===r})]})}})})})),ke=t(14156),Ee=t(25496),De=t(12436),_e=t(47072),Ke=t(41302),Pe=t(82348),Fe=t(44198),Oe=(0,h.Ps)(a||(a=(0,g.Z)(["\n  query InstanceSupportsCapturedLogs {\n    instance {\n      hasCapturedLogManager\n    }\n  }\n"]))),Ue=t(5484),qe=5242880,Me=function(e){return e.length<qe?e:e.slice(-5242880)},$e=function(e,n){if(!n)return e;var t=null===e||void 0===e?void 0:e.data;return null!==e&&void 0!==e&&e.data&&null!==n&&void 0!==n&&n.data?t=Me(e.data+n.data):null!==n&&void 0!==n&&n.data&&(t=Me(n.data)),{__typename:n.__typename,path:n.path,downloadUrl:n.downloadUrl,data:"string"===typeof t?t:null,cursor:n.cursor}},Ve=function(e,n){switch(n.type){case"stdout":var t=n.stepKey===e.stepKey?$e(e.stdout,n.log):n.log;return(0,K.Z)((0,K.Z)({},e),{},{isLoading:!1,stdout:t});case"stderr":var o=n.stepKey===e.stepKey?$e(e.stderr,n.log):n.log;return(0,K.Z)((0,K.Z)({},e),{},{isLoading:!1,stderr:o});default:return e}},Ae={stepKey:"",stdout:null,stderr:null,isLoading:!0},Ge=(0,h.Ps)(l||(l=(0,g.Z)(["\n  subscription ComputeLogsSubscription(\n    $runId: ID!\n    $stepKey: String!\n    $ioType: ComputeIOType!\n    $cursor: String\n  ) {\n    computeLogs(runId: $runId, stepKey: $stepKey, ioType: $ioType, cursor: $cursor) {\n      path\n      cursor\n      data\n      downloadUrl\n    }\n  }\n"]))),Qe=function(e){var n=e.runId,t=e.stepKeys,o=e.computeLogFileKey,r=e.ioType,i=e.setComputeLogUrl;return t.length&&o?(0,B.jsx)(We,{runId:n,computeLogFileKey:o,ioType:r,setComputeLogUrl:i}):(0,B.jsx)(m.x,{flex:{justifyContent:"center",alignItems:"center"},style:{flex:1,height:"100%"},children:(0,B.jsx)(W.$,{purpose:"section"})})},Je=function(e,n){if(!n)return null;var t;return(t=n)&&t.startsWith("/")?e+n:n},We=j.memo((function(e){var n=e.runId,t=e.computeLogFileKey,o=e.ioType,r=e.setComputeLogUrl,i=j.useContext(he.I).rootServerURI,s=function(e,n){var t=j.useReducer(Ve,Ae),o=(0,P.Z)(t,2),r=o[0],i=o[1];return(0,q.m)(Ge,{fetchPolicy:"no-cache",variables:{runId:e,stepKey:n,ioType:Ue.VJ.STDOUT,cursor:null},onSubscriptionData:function(e){var t,o=e.subscriptionData;i({type:"stdout",stepKey:n,log:(null===(t=o.data)||void 0===t?void 0:t.computeLogs)||null})}}),(0,q.m)(Ge,{fetchPolicy:"no-cache",variables:{runId:e,stepKey:n,ioType:Ue.VJ.STDERR,cursor:null},onSubscriptionData:function(e){var t,o=e.subscriptionData;i({type:"stderr",stepKey:n,log:(null===(t=o.data)||void 0===t?void 0:t.computeLogs)||null})}}),r}(n,t),a=s.isLoading,l=s.stdout,u=s.stderr,c=Je(i,(null===l||void 0===l?void 0:l.downloadUrl)||null),d=Je(i,(null===u||void 0===u?void 0:u.downloadUrl)||null);return(0,B.jsxs)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[(0,B.jsx)(ze,{content:l?l.data:null,path:l?l.path:void 0,downloadUrl:c,isLoading:a,isVisible:"stdout"===o,setComputeLogUrl:r}),(0,B.jsx)(ze,{content:u?u.data:null,path:u?u.path:void 0,downloadUrl:d,isLoading:a,isVisible:"stderr"===o,setComputeLogUrl:r})]})})),ze=function(e){var n=e.isLoading,t=e.isVisible,o=e.content,r=e.path,i=e.downloadUrl,s=e.setComputeLogUrl;return j.useEffect((function(){s(i)}),[s,i]),(0,B.jsx)(Y,{logData:o,isLoading:n,isVisible:t,downloadUrl:i,location:r})},He=t(47427),Be=t(31522),Ye=t(72844),Xe=t.n(Ye),en=t(92497),nn=t(98834),tn={DEBUG:0,INFO:0,WARNING:0,ERROR:0,CRITICAL:0,EVENT:0},on=function(e,n){switch(n.type){case"append":var t=n.queued.map((function(e,n){return(0,K.Z)((0,K.Z)({},e),{},{clientsideKey:"csk".concat(e.timestamp,"-").concat(n)})})),o=[].concat((0,_.Z)(e.nodes),(0,_.Z)(t)),r=(0,K.Z)({},e.counts);return t.forEach((function(e){var n=(0,nn.m)(e);r[n]++})),{nodes:o,counts:r,loading:n.hasMore,cursor:n.cursor};case"set-cursor":return(0,K.Z)((0,K.Z)({},e),{},{cursor:n.cursor});case"reset":return{nodes:[],counts:tn,cursor:null,loading:!0};default:return e}},rn={nodes:[],counts:tn,cursor:null,loading:!0},sn=function(e){var n=(0,Be.x)(),t=j.useRef([]),o=j.useReducer(on,rn),r=(0,P.Z)(o,2),i=r[0],s=r[1],a=j.useCallback((function(t){var o=n.readFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:pn,id:"Run:".concat(e)});if(o){var r=(0,K.Z)((0,K.Z)({},o),{},{status:t});t!==Ue.VO.FAILURE&&t!==Ue.VO.SUCCESS&&t!==Ue.VO.STARTING&&t!==Ue.VO.CANCELING&&t!==Ue.VO.CANCELED||(r.canTerminate=!1),n.writeFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:pn,id:"Run:".concat(e),data:r})}}),[n,e]);j.useEffect((function(){t.current=[],s({type:"reset"})}),[e]);var l=j.useMemo((function(){return Xe()((function(){if(t.current.length){var e=(0,_.Z)(t.current);t.current=[];var n=e.flatMap((function(e){return e.messages})),o=e[e.length-1],r=o.hasMorePastEvents,i=o.cursor;s({type:"append",queued:n,hasMore:r,cursor:i});var l=function(e){var n,t=(0,_.Z)(e).reverse(),o=(0,He.Z)(t);try{for(o.s();!(n=o.n()).done;)switch(n.value.__typename){case"RunStartEvent":return Ue.VO.STARTED;case"RunEnqueuedEvent":return Ue.VO.QUEUED;case"RunStartingEvent":return Ue.VO.STARTING;case"RunCancelingEvent":return Ue.VO.CANCELING;case"RunCanceledEvent":return Ue.VO.CANCELED;case"RunSuccessEvent":return Ue.VO.SUCCESS;case"RunFailureEvent":return Ue.VO.FAILURE}}catch(r){o.e(r)}finally{o.f()}return null}(n);l&&!r&&a(l)}}),100)}),[a]),u=i.nodes,c=i.counts,d=i.cursor,p=i.loading,g=j.useContext(me.DN),f=g.availability,h=g.disabled,m=g.status,v=!h&&"available"===f&&m===WebSocket.CLOSED,x=j.useRef(d);v&&(x.current=d);var y=x.current,w=j.useMemo((function(){return{runId:e,cursor:y}}),[e,y]),b=j.useMemo((function(){return(0,B.jsx)(an,{variables:w,onSubscriptionData:function(e){var n,o=null===(n=e.subscriptionData.data)||void 0===n?void 0:n.pipelineRunLogs;o&&"PipelineRunLogsSubscriptionFailure"!==o.__typename&&(t.current.push(o),requestAnimationFrame(l))}})}),[w,l]);return j.useMemo((function(){return null!==u?{allNodes:u,counts:c,loading:p,subscriptionComponent:b}:{allNodes:[],counts:c,loading:p,subscriptionComponent:b}}),[c,p,u,b])},an=function(e){var n=e.variables,t=e.onSubscriptionData;return(0,q.m)(dn,{fetchPolicy:"no-cache",variables:n,onSubscriptionData:t}),null},ln=function(e){var n=sn(e.runId);return(0,B.jsxs)(B.Fragment,{children:[n.subscriptionComponent,e.children(n)]})},un=function(e){var n=e.children,t=e.runId,o=j.useReducer(on,rn),r=(0,P.Z)(o,2),i=r[0],s=r[1],a=i.counts,l=i.cursor,u=i.nodes,c=(0,f.a)(gn,{notifyOnNetworkStatusChange:!0,variables:{runId:t,cursor:l,limit:1e4},pollInterval:5e3,onCompleted:function(e){if(d(),"Run"===(null===e||void 0===e?void 0:e.pipelineRunOrError.__typename)&&"EventConnection"===(null===e||void 0===e?void 0:e.logsForRun.__typename)){var n=e.pipelineRunOrError,t=e.logsForRun.events,o=n.status,r=e.logsForRun.cursor,i=!!o&&o!==Ue.VO.FAILURE&&o!==Ue.VO.SUCCESS&&o!==Ue.VO.CANCELED;s({type:"append",queued:t,hasMore:i,cursor:r}),i&&p(5e3)}}}),d=c.stopPolling,p=c.startPolling;return(0,B.jsx)(B.Fragment,{children:n(null!==u&&u.length>0?{allNodes:u,counts:a,loading:!1}:{allNodes:[],counts:a,loading:!0})})},cn=function(e){var n=e.children,t=e.runId,o=j.useContext(me.DN),r=o.availability,i=o.disabled;return"unavailable"===r||i?(0,B.jsx)(un,{runId:t,children:n}):"attempting-to-connect"===r?(0,B.jsx)(B.Fragment,{children:n({allNodes:[],counts:tn,loading:!0})}):(0,B.jsx)(ln,{runId:t,children:n})},dn=(0,h.Ps)(u||(u=(0,g.Z)(["\n  subscription PipelineRunLogsSubscription($runId: ID!, $cursor: String) {\n    pipelineRunLogs(runId: $runId, cursor: $cursor) {\n      __typename\n      ... on PipelineRunLogsSubscriptionSuccess {\n        messages {\n          ... on MessageEvent {\n            runId\n          }\n          ...RunDagsterRunEventFragment\n        }\n        hasMorePastEvents\n        cursor\n      }\n      ... on PipelineRunLogsSubscriptionFailure {\n        missingRunId\n        message\n      }\n    }\n  }\n\n  ","\n"])),en.O.RunDagsterRunEventFragment),pn=(0,h.Ps)(c||(c=(0,g.Z)(["\n  fragment PipelineRunLogsSubscriptionStatusFragment on Run {\n    id\n    runId\n    status\n    canTerminate\n  }\n"]))),gn=(0,h.Ps)(d||(d=(0,g.Z)(["\n  query RunLogsQuery($runId: ID!, $cursor: String, $limit: Int) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        runId\n        status\n        canTerminate\n      }\n    }\n    logsForRun(runId: $runId, afterCursor: $cursor, limit: $limit) {\n      ... on EventConnection {\n        events {\n          __typename\n          ... on MessageEvent {\n            runId\n          }\n          ...RunDagsterRunEventFragment\n        }\n        cursor\n      }\n      ... on PythonError {\n        message\n        stack\n      }\n    }\n  }\n  ","\n"])),en.O.RunDagsterRunEventFragment),fn=t(12244),hn=t(16798),mn=t(87011),vn=t(42849),xn=t(8412),yn=t(75453),wn=t(31269),bn=t(11831),Cn=t(50346),jn=t(9429),Sn=t(36172),Ln=t(13816),In=t.n(Ln)()((function(){return new Intl.NumberFormat(navigator.language,{compactDisplay:"short",notation:"compact"})})),Nn=t(40355),Zn=F.ZP.div.withConfig({displayName:"ExecutionStateDot",componentId:"sc-1e4maq3-0"})(["display:inline-block;width:11px;height:11px;border-radius:5.5px;transition:background 200ms linear;background:",";&:hover{background:",";}"],(function(e){var n,t=e.state;return(n={},(0,hn.Z)(n,Nn.TN.RUNNING,M.w.Gray400),(0,hn.Z)(n,Nn.TN.SUCCEEDED,M.w.Green700),(0,hn.Z)(n,Nn.TN.SKIPPED,M.w.Yellow500),(0,hn.Z)(n,Nn.TN.FAILED,M.w.Red500),(0,hn.Z)(n,Nn.TN.PREPARING,M.w.Red500),(0,hn.Z)(n,Nn.TN.RETRY_REQUESTED,M.w.Red500),(0,hn.Z)(n,Nn.TN.UNKNOWN,M.w.Red500),n)[t]}),(function(e){var n,t=e.state;return(n={},(0,hn.Z)(n,Nn.TN.RUNNING,M.w.Gray400),(0,hn.Z)(n,Nn.TN.SUCCEEDED,M.w.Green700),(0,hn.Z)(n,Nn.TN.SKIPPED,M.w.Yellow500),(0,hn.Z)(n,Nn.TN.FAILED,M.w.Red200),(0,hn.Z)(n,Nn.TN.PREPARING,M.w.Red500),(0,hn.Z)(n,Nn.TN.RETRY_REQUESTED,M.w.Red500),(0,hn.Z)(n,Nn.TN.UNKNOWN,M.w.Red500),n)[t]})),Rn=t(6527),Tn=t(88863),kn=t(40158),En=t(74386),Dn=function(e,n){switch(n.type){case"show-popover":return(0,K.Z)((0,K.Z)({},e),{},{shown:!0});case"hide-popover":return(0,K.Z)((0,K.Z)({},e),{},{shown:!1});case"highlight":return(0,K.Z)((0,K.Z)({},e),{},{highlight:n.highlight});case"change-query":return(0,K.Z)((0,K.Z)({},e),{},{shown:!0,highlight:0});case"select-suggestion":return(0,K.Z)((0,K.Z)({},e),{},{highlight:0});default:return e}},_n={shown:!1,highlight:0},Kn={threshold:.3},Pn=function(e){var n=e.value,t=e.onChange,o=e.suggestionProviders,r=j.useReducer(Dn,_n),i=(0,P.Z)(r,2),s=i[0],a=i[1],l=s.shown,u=s.highlight,c=j.useRef(null),d=j.useMemo((function(){var e=o.reduce((function(e,n){var t=n.values();return n.token?(0,K.Z)((0,K.Z)({},e),{},(0,hn.Z)({},n.token,{fuse:new kn.Z(t,Kn),all:t})):e}),{}),n=o.map((function(e){return e.token})).filter((function(e){return e}));return{empty:new kn.Z(n,Kn),perProvider:e}}),[o]),p=d.empty,g=d.perProvider,f=j.useCallback((function(e){if(!e)return Object.keys(g);var n=e.split(":"),t=(0,P.Z)(n,2),o=t[0],r=t[1];if(o in g){var i=g[o],s=i.fuse,a=i.all,l=r?s.search(r).map((function(e){return"".concat(o,":").concat(e.item)})):a.map((function(e){return"".concat(o,":").concat(e)}));return l.map((function(e){return e.toLowerCase()})).includes(e)?[]:l}return p.search(e).map((function(e){return e.item}))}),[p,g]),h=function(e,n){var t=n.toLocaleLowerCase().trim().split(/\s+/),o=t[t.length-1]||"",r=j.useMemo((function(){return e(o)}),[e,o]),i=j.useCallback((function(e){var t=n.toLocaleLowerCase().lastIndexOf(o);if(-1!==t){var r=n.slice(0,t);return"".concat(r).concat(e)}return n}),[o,n]);return j.useMemo((function(){return{suggestions:r,onSelectSuggestion:i}}),[i,r])}(f,n),m=h.suggestions,v=h.onSelectSuggestion,x=m.length,y=m[u]||null,w=j.useCallback((function(e){a({type:"change-query"}),t(e.target.value)}),[t]),C=j.useCallback((function(e){a({type:"select-suggestion"}),t(v(e))}),[t,v]),S=j.useCallback((function(){var e;a({type:"change-query"}),t(""),null===(e=c.current)||void 0===e||e.focus()}),[t]);return(0,B.jsx)(b.J,{isOpen:l&&m.length>0,position:"bottom-left",content:(0,B.jsx)(Un,{children:m.map((function(e,n){return(0,B.jsx)(Fn,{suggestion:e,isHighlight:u===n,onSelect:C},e)}))}),children:(0,B.jsx)(On,{placeholder:"Filter\u2026",spellCheck:!1,autoCorrect:"off",value:n,ref:c,onChange:w,onFocus:function(){return a({type:"show-popover"})},onBlur:function(){return a({type:"hide-popover"})},onKeyDown:function(e){var n=e.key;if("Escape"!==n){if(x){var t=x-1;switch(n){case"ArrowUp":e.preventDefault(),a({type:"highlight",highlight:0===u?t:u-1});break;case"ArrowDown":e.preventDefault(),a({type:"highlight",highlight:u===t?0:u+1});break;case"Enter":e.preventDefault(),y&&C(y)}}}else a({type:"hide-popover"})},rightElement:(0,B.jsx)(En.C,{onClick:S,children:(0,B.jsx)($.JO,{name:"cancel"})})})})},Fn=function(e){var n=e.suggestion,t=e.isHighlight,o=e.onSelect,r=j.useRef(null);return j.useEffect((function(){r.current&&t&&r.current.scrollIntoView({block:"nearest"})}),[t]),(0,B.jsx)(qn,{ref:r,isHighlight:t,onMouseDown:function(e){e.preventDefault(),o(n)},children:n})},On=(0,F.ZP)(Tn.oi).withConfig({displayName:"LogsFilterInput__FilterInput",componentId:"sc-3dxor8-0"})(["width:300px;"]),Un=F.ZP.ul.withConfig({displayName:"LogsFilterInput__Results",componentId:"sc-3dxor8-1"})(["list-style:none;margin:0;max-height:200px;max-width:800px;min-width:300px;overflow-y:auto;padding:4px 0;"]),qn=F.ZP.li.withConfig({displayName:"LogsFilterInput__Item",componentId:"sc-3dxor8-2"})(["align-items:center;background-color:",";color:",";cursor:pointer;display:flex;flex-direction:row;font-size:12px;list-style:none;margin:0;padding:4px 8px;white-space:nowrap;text-overflow:ellipsis;&:hover{background-color:",";}"],(function(e){return e.isHighlight?M.w.Blue500:M.w.White}),(function(e){return e.isHighlight?M.w.White:"default"}),(function(e){return e.isHighlight?M.w.Blue500:M.w.Gray100})),Mn=t(1557);!function(e){e.structured="structured",e.stdout="stdout",e.stderr="stderr"}(p||(p={}));var $n=function(e){var n=e.steps,t=e.metadata,o=e.counts,r=e.filter,i=e.onSetFilter,s=e.logType,a=e.onSetLogType,l=e.computeLogFileKey,u=e.onSetComputeLogKey,c=e.computeLogUrl,d=j.useMemo((function(){return new Set([s===p.structured?s:p.stdout])}),[s]);return(0,B.jsxs)(Sn.qn,{children:[(0,B.jsx)(mn.h,{activeItems:d,buttons:[{id:p.structured,icon:"list",tooltip:"Structured event logs"},{id:p.stdout,icon:"wysiwyg",tooltip:"Raw compute logs"}],onClick:function(e){return a(e)}}),(0,B.jsx)(Sn.KC,{}),"structured"===s?(0,B.jsx)(Qn,{counts:o,filter:r,onSetFilter:i,steps:n}):(0,B.jsx)(An,{steps:n,metadata:t,logType:s,onSetLogType:a,computeLogFileKey:l,onSetComputeLogKey:u,computeLogUrl:c})]})},Vn=function(e,n){return n.stepKeys.some((function(n){return e.steps[n].state===Nn.TN.RUNNING}))?Nn.TN.RUNNING:n.stepKeys.some((function(n){return e.steps[n].state===Nn.TN.SKIPPED}))?Nn.TN.SKIPPED:n.stepKeys.every((function(n){return e.steps[n].state===Nn.TN.SUCCEEDED}))?Nn.TN.SUCCEEDED:Nn.TN.FAILED},An=function(e){var n,t,o=e.steps,r=e.metadata,i=e.computeLogFileKey,s=e.onSetComputeLogKey,a=e.logType,l=e.onSetLogType,u=e.computeLogUrl,c=r.logCaptureSteps||(0,Nn.co)(Object.keys(r.steps)),d=i&&c[i],g=function(e){if(!e||!c[e])return null;var n=c[e];return 1===n.stepKeys.length&&e===n.stepKeys[0]?e:n.pid&&1===n.stepKeys.length?n.stepKeys[0]:n.pid?"pid: ".concat(n.pid," (").concat(n.stepKeys.length," steps)"):"".concat(e," (").concat(n.stepKeys.length," steps)")};return(0,B.jsxs)(m.x,{flex:{justifyContent:"space-between",alignItems:"center",direction:"row"},style:{flex:1},children:[(0,B.jsxs)(J.Z,{direction:"row",spacing:24,alignItems:"center",children:[(0,B.jsx)(vn.P,{disabled:!o.length,items:Object.keys(c),itemPredicate:function(e,n){return n.toLocaleLowerCase().includes(e.toLocaleLowerCase())},itemRenderer:function(e,n){return(0,B.jsx)(xn.sN,{onClick:n.handleClick,text:g(e),active:n.modifiers.active},e)},activeItem:i,onItemSelect:function(e){s(e)},children:(0,B.jsx)(yn.zx,{disabled:!o.length,rightIcon:(0,B.jsx)($.JO,{name:"expand_more"}),children:g(i)||"Select a step..."})}),d?(0,B.jsxs)(wn.mQ,{selectedTabId:a,onChange:l,size:"small",children:[(0,B.jsx)(wn.OK,{id:p.stdout,title:"stdout"}),(0,B.jsx)(wn.OK,{id:p.stderr,title:"stderr"})]}):null]}),d?(0,B.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[i&&c[i]?Vn(r,c[i])===Nn.TN.RUNNING?(0,B.jsx)(W.$,{purpose:"body-text"}):(0,B.jsx)(Zn,{state:Vn(r,c[i])}):null,u?(0,B.jsx)(bn.u,{placement:"top-end",content:i&&1===(null===(n=c[i])||void 0===n?void 0:n.stepKeys.length)?"Download ".concat(null===(t=c[i])||void 0===t?void 0:t.stepKeys[0]," compute logs"):"Download compute logs",children:(0,B.jsx)(Gn,{"aria-label":"Download link",href:u,download:!0,children:(0,B.jsx)($.JO,{name:"download_for_offline",color:M.w.Gray600})})}):null]}):null]})},Gn=F.ZP.a.withConfig({displayName:"LogsToolbar__DownloadLink",componentId:"d9cqde-0"})(["border-radius:4px;display:block;text-decoration:none;","{transition:background-color 100ms linear;}:hover ","{background-color:",";}:active ",",:focus ","{background-color:",";}:focus{outline:none;}"],$.a1,$.a1,M.w.Gray800,$.a1,$.a1,M.w.Dark),Qn=function(e){var n,t=e.filter,o=e.counts,r=e.onSetFilter,i=e.steps,s=j.useState("assignment"),a=(0,P.Z)(s,2),l=a[0],u=a[1],c=t.logQuery.map((function(e){var n=e.token,t=e.value;return n?"".concat(n,":").concat(t):t})).join(" "),d=j.useState((function(){return c})),p=(0,P.Z)(d,2),g=p[0],f=p[1],h=(0,jn.m)(),v=(null===(n=t.logQuery.find((function(e){return"step"===e.token})))||void 0===n?void 0:n.value)||null,x=t.logQuery.reduce((function(e,n){return e+n.value}),"");j.useEffect((function(){f(c)}),[c]);return j.useEffect((function(){var e;return"assignment_turned_in"===l&&(e=setTimeout((function(){u("assignment")}),2e3)),function(){e&&clearTimeout(e)}}),[l]),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Pn,{value:g,suggestionProviders:(0,Mn.m)(i),onChange:function(e){var n=e.split(/\s+/).map((function(e){var n=e.split(":");return n.length>1?{token:n[0],value:n[1]}:{value:n[0]}}));r((0,K.Z)((0,K.Z)({},t),{},{logQuery:n})),f(e)}}),x?(0,B.jsx)(Jn,{checked:t.hideNonMatches,onChange:function(e){return r((0,K.Z)((0,K.Z)({},t),{},{hideNonMatches:e.currentTarget.checked}))},label:"Hide non-matches"}):null,(0,B.jsx)(Sn.KC,{}),(0,B.jsx)(m.x,{flex:{direction:"row",alignItems:"center",gap:8},children:Object.keys(Rn.i).map((function(e){var n,i=t.levels[e];return(0,B.jsxs)(Wn,{$enabled:i,children:[(0,B.jsx)(Cn.X,{format:"switch",size:"small",checked:!!i,fillColor:i?M.w.Blue500:M.w.Gray200,onChange:function(){return r((0,K.Z)((0,K.Z)({},t),{},{levels:(0,K.Z)((0,K.Z)({},t.levels),{},(0,hn.Z)({},e,!i))}))}}),(0,B.jsx)(zn,{$enabled:i,children:e.toLowerCase()}),(0,B.jsx)(Hn,{$enabled:i,children:(n=o[e],In().format(n))})]},e)}))}),v&&(0,B.jsx)(Sn.KC,{}),(0,B.jsx)("div",{style:{minWidth:15,flex:1}}),(0,B.jsx)(yn.zx,{icon:(0,B.jsx)($.JO,{name:l}),onClick:function(){h(window.location.href),u("assignment_turned_in")},children:"Copy URL"})]})},Jn=(0,F.ZP)(Cn.X).withConfig({displayName:"LogsToolbar__NonMatchCheckbox",componentId:"d9cqde-1"})(["&&&{margin:0 4px 0 12px;}white-space:nowrap;"]),Wn=F.ZP.label.withConfig({displayName:"LogsToolbar__FilterLabel",componentId:"d9cqde-2"})(["background-color:",";border:none;border-radius:8px;margin:0;padding:4px 6px;overflow:hidden;cursor:pointer;display:inline-flex;flex-direction:row;align-items:center;font-size:12px;font-weight:500;gap:6px;box-shadow:transparent inset 0px 0px 0px 1px;transition:background 50ms linear;:focus{box-shadow:rgba(58,151,212,0.6) 0 0 0 3px;outline:none;}:focus:not(:focus-visible){box-shadow:transparent inset 0px 0px 0px 1px,rgba(0,0,0,0.12) 0px 2px 12px 0px;}"],(function(e){return e.$enabled?M.w.Blue50:M.w.Gray100})),zn=F.ZP.span.withConfig({displayName:"LogsToolbar__LogLabel",componentId:"d9cqde-3"})(["color:",";line-height:16px;transition:background 50ms linear;"],(function(e){return e.$enabled?M.w.Blue500:M.w.Gray700})),Hn=F.ZP.span.withConfig({displayName:"LogsToolbar__LogCount",componentId:"d9cqde-4"})(["background-color:",";border-radius:6px;color:",";font-weight:600;font-family:",";line-height:16px;padding:1px 4px;transition:background 50ms linear;"],(function(e){return e.$enabled?M.w.Blue100:M.w.Gray200}),(function(e){return e.$enabled?M.w.Blue500:M.w.Gray700}),y.b.monospace),Bn=t(3148),Yn=t(3660),Xn=t(79580),et=t(57615),nt="|";function tt(e){return e.sort().map((function(e){return e.toLowerCase()})).join(nt)}var ot={steps:"*",logs:"",levels:tt(Rn.w),hideNonMatches:"true",focusedTime:""},rt=function(e){var n=e.logs.split(nt),t=e.focusedTime&&!e.logs?Number(e.focusedTime):null,o="true"===e.hideNonMatches,r=(0,Mn.m)();return{sinceTime:0,focusedTime:t,hideNonMatches:o,logQuery:n.map((function(e){return(0,et.WD)(e,r)})),levels:e.levels.split(nt).map((function(e){return e.toUpperCase()})).filter((function(e){return Rn.i.hasOwnProperty(e)})).reduce((function(e,n){return(0,K.Z)((0,K.Z)({},e),{},(0,hn.Z)({},n,!0))}),{})}};function it(e){var n=e.logQuery.map((function(e){return e.token?"".concat(e.token,":").concat(e.value):e.value}));return{hideNonMatches:e.hideNonMatches?"true":"false",focusedTime:e.focusedTime||"",logs:n.join(nt),levels:tt(Object.keys(e.levels).filter((function(n){return!!e.levels[n]})))}}var st,at=function(e){var n,t=e.run,o=e.runId,r=(0,Fe.q)({encode:it,decode:rt,defaults:ot}),i=(0,P.Z)(r,2),s=i[0],a=i[1],l=(0,Fe.q)({queryKey:"selection",defaults:{selection:""}}),u=(0,P.Z)(l,2),c=u[0],d=u[1];n=t?function(e){switch(e){case Ue.VO.CANCELED:case Ue.VO.CANCELING:case Ue.VO.FAILURE:return"/favicon-run-failed.svg";case Ue.VO.SUCCESS:return"/favicon-run-success.svg";default:return"/favicon-run-pending.svg"}}(t.status):"/favicon.svg",j.useEffect((function(){var e=document.querySelector('link[rel="icon"][type="image/svg+xml"]');if(e){var t=e.getAttribute("href");return e.setAttribute("href",n),function(){t&&e.setAttribute("href",t)}}}),[n]),(0,Pe.j)(t?"".concat((0,N.pv)(t.pipelineName)?"":t.pipelineName," ").concat(o.slice(0,8)," [").concat(t.status,"]"):"Run: ".concat(o));var p=function(e,n){var t=n.find((function(n){return"ExecutionStepFailureEvent"===n.__typename&&n.stepKey===e}));t&&(0,ke._)({body:(0,B.jsx)(De.T9,{error:t})})},g=function(e){d(e),a((0,K.Z)((0,K.Z)({},s),{},{logQuery:"*"!==e?[{token:"query",value:e}]:[]}))};return(0,B.jsx)(Yn.A.Provider,{value:t,children:(0,B.jsx)(cn,{runId:o,children:function(e){return(0,B.jsx)(Nn.jp,{logs:e,children:function(n){return(0,B.jsx)(ut,{run:t,runId:o,logs:e,logsFilter:s,metadata:n,selectionQuery:c,onSetLogsFilter:a,onSetSelectionQuery:g,onShowStateDetails:p})}})}},o)})},lt=function(e,n){var t=(e?Object.values(e):[]).find((function(e){return e.stepKeys.includes(n)}));return t&&(null===t||void 0===t?void 0:t.fileKey)},ut=function(e){var n=e.run,t=e.runId,o=e.logs,r=e.logsFilter,i=e.metadata,s=e.selectionQuery,a=e.onSetLogsFilter,l=e.onSetSelectionQuery,u=(0,Xn.W)(n),c=j.createRef(),d=function(){var e=(0,f.a)(Oe).data;return!(null===e||void 0===e||!e.instance.hasCapturedLogManager)}(),g=(0,Fe.q)({queryKey:"logType",defaults:{logType:"structured"}}),h=(0,P.Z)(g,2),v=h[0],x=h[1],y=(0,Fe.q)({queryKey:"logFileKey"}),w=(0,P.Z)(y,2),b=w[0],S=w[1],L=function(e){switch(e){case"stdout":return p.stdout;case"stderr":return p.stderr;default:return p.structured}}(v),I=j.useState(null),N=(0,P.Z)(I,2),Z=N[0],R=N[1],T=JSON.stringify(Object.keys(i.steps).sort()),k=j.useMemo((function(){return JSON.parse(T)}),[T]),E=(null===n||void 0===n?void 0:n.executionPlan)&&(0,Ke.J)(null===n||void 0===n?void 0:n.executionPlan,i.steps),D=j.useMemo((function(){return E&&s&&"*"!==s?(0,Ee.V)(E,s).all.map((function(e){return e.name})):[]}),[E,s]);j.useEffect((function(){if(null!==k&&void 0!==k&&k.length&&!b)if(i.logCaptureSteps){var e=Object.keys(i.logCaptureSteps),n=e.find((function(e){return D.every((function(n){return i.logCaptureSteps&&i.logCaptureSteps[e].stepKeys.includes(n)}))}));S(n||e[0])}else if(k.includes(b)){if(1===D.length&&b!==D[0]){var t=lt(i.logCaptureSteps,D[0]);t&&S(t)}}else{var o=lt(i.logCaptureSteps,1===D.length?D[0]:k[0]);o&&S(o)}}),[k,b,D,i.logCaptureSteps,S]);var K=E?r.logQuery.filter((function(e){return e.token&&"query"===e.token})).reduce((function(e,n){return[].concat((0,_.Z)(e),(0,_.Z)((0,Ee.V)(E,n.value).all.map((function(e){return e.name}))))}),[]):[],F=function(e,n){var t,o=D.indexOf(e),r='"'.concat(e,'"');if(n.shiftKey)t=(0,_.Z)(D.map((function(e){return s.includes('"'.concat(e,'"'))?'"'.concat(e,'"'):e}))),-1!==o?t.splice(o,1):t.push(r);else if(1===D.length&&-1!==o)t=[];else{t=[r];var a=lt(i.logCaptureSteps,e);a&&S(a)}l(t.join(", ")||"*")},U=i.logCaptureSteps&&b in i.logCaptureSteps?i.logCaptureSteps[b]:void 0;return(0,B.jsx)(B.Fragment,{children:(0,B.jsx)(O.OS,{ref:c,axis:"vertical",identifier:"run-gantt",firstInitialPercent:35,firstMinSize:56,first:function(e){return n?"QUEUED"===n.status?(0,B.jsx)(_e.Fu,{run:n}):n.executionPlan&&E?(0,B.jsx)(_e.hj,{options:{mode:_e.hS.WATERFALL_TIMED},toolbarActions:(0,B.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[(0,B.jsx)(O.jo,{axis:"vertical",container:c}),(0,B.jsx)(Bn.NX,{run:n,onLaunch:u,graph:E,metadata:e,selection:{query:s,keys:D}})]}),runId:t,graph:E,metadata:e,selection:{query:s,keys:D},onClickStep:F,onSetSelection:l,focusedTime:r.focusedTime}):(0,B.jsx)(C.t,{icon:"error",title:"Unable to build execution plan"}):(0,B.jsx)(_e.ZW,{runId:t})}(i),second:(0,B.jsxs)(ct,{children:[(0,B.jsx)($n,{logType:L,onSetLogType:function(e){return x(p[e])},filter:r,onSetFilter:a,steps:k,metadata:i,computeLogFileKey:b,onSetComputeLogKey:function(e){S(e)},computeLogUrl:Z,counts:o.counts}),L!==p.structured?d?(0,B.jsx)(xe,{logKey:b?[t,"compute_logs",b]:[],externalUrl:null===U||void 0===U?void 0:U.externalUrl,visibleIOType:p[L],onSetDownloadUrl:R}):(0,B.jsx)(Qe,{runId:t,stepKeys:k,computeLogFileKey:b,ioType:p[L],setComputeLogUrl:R}):(0,B.jsx)(fn.S,{logs:o,filter:r,filterStepKeys:K,filterKey:"".concat(JSON.stringify(r)),metadata:i})]})})})},ct=F.ZP.div.withConfig({displayName:"Run__LogsContainer",componentId:"sc-1l2e0ac-0"})(["display:flex;flex-direction:column;height:100%;"]),dt=t(57876),pt=t(37751),gt=t(55752),ft=function(){(0,I.Px)();var e=(0,S.UO)().runId,n=(0,f.a)(vt,{fetchPolicy:"cache-and-network",partialRefetch:!0,variables:{runId:e}}),t=n.data,o=n.loading,r="Run"===(null===t||void 0===t?void 0:t.pipelineRunOrError.__typename)?t.pipelineRunOrError:null,i=null===r||void 0===r?void 0:r.pipelineSnapshotId,s=(0,E._)(r),a=null!==s&&void 0!==s&&s.match?(0,k.kQ)(s.match.repository.name,s.match.repositoryLocation.name):null,l=j.useMemo((function(){return!!(r&&s&&(0,T.E8)(s.match,r.pipelineName))}),[r,s]);return(0,B.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,width:"100%",height:"100%",overflow:"hidden"},children:[(0,B.jsx)(m.x,{flex:{direction:"row",alignItems:"flex-start"},style:{position:"relative",zIndex:1},children:(0,B.jsx)(v.m,{title:(0,B.jsx)(x.X6,{style:{fontFamily:y.b.monospace,fontSize:"20px"},children:e.slice(0,8)}),tags:r?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(pt.K,{status:r.status}),(0,N.pv)(r.pipelineName)?(0,B.jsx)(D.m,{assetKeys:(0,gt.Bo)(r),clickableTags:!0}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(w.V,{icon:"run",children:["Run of"," ",(0,B.jsx)(Z.h,{pipelineName:null===r||void 0===r?void 0:r.pipelineName,pipelineHrefContext:a||"repo-unknown",snapshotId:i,size:"small",isJob:l})]}),(0,B.jsx)(D.m,{assetKeys:r.assets.map((function(e){return e.key})),clickableTags:!0})]}),(0,B.jsxs)(m.x,{flex:{direction:"row",alignItems:"flex-start",gap:12,wrap:"wrap"},children:[null!==r&&void 0!==r&&r.startTime?(0,B.jsx)(b.J,{interactionKind:"hover",placement:"bottom",content:(0,B.jsx)(m.x,{padding:16,children:(0,B.jsx)(dt.lc,{run:r,loading:o})}),children:(0,B.jsx)(w.V,{icon:"schedule",children:(0,B.jsx)(R.v,{timestamp:r.startTime,timeFormat:{showSeconds:!0,showTimezone:!1}})})}):r.updateTime?(0,B.jsx)(w.V,{icon:"schedule",children:(0,B.jsx)(R.v,{timestamp:r.updateTime,timeFormat:{showSeconds:!0,showTimezone:!1}})}):void 0,null!==r&&void 0!==r&&r.startTime&&null!==r&&void 0!==r&&r.endTime?(0,B.jsx)(b.J,{interactionKind:"hover",placement:"bottom",content:(0,B.jsx)(m.x,{padding:16,children:(0,B.jsx)(dt.lc,{run:r,loading:o})}),children:(0,B.jsx)(w.V,{icon:"timer",children:(0,B.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:null!==r&&void 0!==r&&r.startTime?(0,L.fv)((1e3*(null===r||void 0===r?void 0:r.endTime)||Date.now())-1e3*(null===r||void 0===r?void 0:r.startTime)):"\u2013"})})}):null]})]}):null,right:r?(0,B.jsx)(dt.Up,{run:r,isJob:l}):null})}),(0,B.jsx)(mt,{data:t,runId:e})]})},ht=ft,mt=function(e){var n=e.data,t=e.runId;return n&&n.pipelineRunOrError?"Run"!==n.pipelineRunOrError.__typename?(0,B.jsx)(m.x,{padding:{vertical:64},children:(0,B.jsx)(C.t,{icon:"error",title:"No run found",description:"The run with this ID does not exist or has been cleaned up."})}):(0,B.jsx)(at,{run:n.pipelineRunOrError,runId:t}):(0,B.jsx)(at,{run:void 0,runId:t})},vt=(0,h.Ps)(st||(st=(0,g.Z)(["\n  query RunRootQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      __typename\n      ... on Run {\n        id\n        ...RunFragment\n      }\n    }\n  }\n\n  ","\n"])),en.O.RunFragment)},79580:function(e,n,t){t.d(n,{W:function(){return g}});var o=t(85358),r=t(19065),i=t(95550),s=t.n(i),a=t(49148),l=t(325),u=t(27601),c=t(25429),d=t(39956),p=t(55752),g=function(e){var n=(0,u.k6)(),t=(0,a.D)(p.kO),i=(0,r.Z)(t,1)[0],g=(0,d._)(e);return l.useCallback(function(){var t=(0,o.Z)(s().mark((function t(o){var r,a,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&e.pipelineSnapshotId&&g){t.next=2;break}return t.abrupt("return");case 2:return r=(0,p.kz)({run:e,style:o,repositoryLocationName:g.match.repositoryLocation.name,repositoryName:g.match.repository.name}),t.prev=3,t.next=6,i({variables:r});case 6:l=t.sent,(0,p.lF)(e.pipelineName,null===(a=l.data)||void 0===a?void 0:a.launchPipelineReexecution,n,{preserveQuerystring:!0,behavior:"open"}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),(0,c.t)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e){return t.apply(this,arguments)}}(),[n,i,g,e])}},74386:function(e,n,t){t.d(n,{C:function(){return s}});var o=t(922),r=t(24971),i=t(7838),s=o.ZP.button.withConfig({displayName:"ClearButton",componentId:"sc-1rz1pk2-0"})(["background:transparent;border:none;cursor:pointer;margin:0 -2px 0 0;padding:2px;","{background-color:",";transition:background-color 100ms linear;}:hover ",",:focus ","{background-color:",";}:active ","{background-color:",";}:focus{outline:none;}"],r.a1,i.w.Gray400,r.a1,r.a1,i.w.Gray700,r.a1,i.w.Dark)},42849:function(e,n,t){t.d(n,{P:function(){return l}});var o=t(95764),r=t(1492),i=t(3810),s=t.n(i),a=(t(325),t(32289)),l=function(e){var n,t,i=(0,o.Z)((0,o.Z)({},e.popoverProps),{},{minimal:!0,modifiers:s()({offset:{enabled:!0,offset:"0, 8px"}},(null===(n=e.popoverProps)||void 0===n?void 0:n.modifiers)||{}),popoverClassName:"dagit-popover ".concat((null===(t=e.popoverProps)||void 0===t?void 0:t.className)||"")});return(0,a.jsx)(r.P,(0,o.Z)((0,o.Z)({},e),{},{popoverProps:i}))}}}]);
//# sourceMappingURL=568.8eb6de2c.chunk.js.map