{"version":3,"file":"chunks/app_views_settings_projectProguard_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/acl/access.tsx","webpack:///./app/components/acl/role.tsx","webpack:///./app/components/searchBar.tsx","webpack:///./app/utils/routeTitle.tsx","webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/projectProguard/projectProguardRow.tsx","webpack:///./app/views/settings/projectProguard/projectProguard.tsx","webpack:///./app/views/settings/projectProguard/index.tsx"],"sourcesContent":["import {Component} from 'react';\n\nimport Alert from 'sentry/components/alert';\nimport {t} from 'sentry/locale';\nimport {Config, Organization, Scope} from 'sentry/types';\nimport {isRenderFunc} from 'sentry/utils/isRenderFunc';\nimport withConfig from 'sentry/utils/withConfig';\nimport withOrganization from 'sentry/utils/withOrganization';\n\nconst DEFAULT_NO_ACCESS_MESSAGE = (\n  <Alert type=\"error\" showIcon>\n    {t('You do not have sufficient permissions to access this.')}\n  </Alert>\n);\n\n// Props that function children will get.\nexport type ChildRenderProps = {\n  hasAccess: boolean;\n  hasSuperuser: boolean;\n};\n\ntype ChildFunction = (props: ChildRenderProps) => React.ReactNode;\n\ntype DefaultProps = {\n  /**\n   * List of required access levels\n   */\n  access: Scope[];\n\n  /**\n   * Custom renderer function for \"no access\" message OR `true` to use\n   * default message. `false` will suppress message.\n   */\n  renderNoAccessMessage: ChildFunction | boolean;\n\n  /**\n   * Requires superuser\n   */\n  isSuperuser?: boolean;\n\n  /**\n   * Should the component require all access levels or just one or more.\n   */\n  requireAll?: boolean;\n};\n\nconst defaultProps: DefaultProps = {\n  renderNoAccessMessage: false,\n  isSuperuser: false,\n  requireAll: true,\n  access: [],\n};\n\ntype Props = {\n  /**\n   * Configuration from ConfigStore\n   */\n  config: Config;\n\n  /**\n   * Current Organization\n   */\n  organization: Organization;\n\n  /**\n   * Children can be a node or a function as child.\n   */\n  children?: React.ReactNode | ChildFunction;\n} & Partial<DefaultProps>;\n\n/**\n * Component to handle access restrictions.\n */\nclass Access extends Component<Props> {\n  static defaultProps = defaultProps;\n\n  render() {\n    const {\n      organization,\n      config,\n      access,\n      requireAll,\n      isSuperuser,\n      renderNoAccessMessage,\n      children,\n    } = this.props;\n\n    const {access: orgAccess} = organization || {access: []};\n    const method = requireAll ? 'every' : 'some';\n\n    const hasAccess = !access || access[method](acc => orgAccess.includes(acc));\n    const hasSuperuser = !!(config.user && config.user.isSuperuser);\n\n    const renderProps: ChildRenderProps = {\n      hasAccess,\n      hasSuperuser,\n    };\n\n    const render = hasAccess && (!isSuperuser || hasSuperuser);\n\n    if (!render && typeof renderNoAccessMessage === 'function') {\n      return renderNoAccessMessage(renderProps);\n    }\n    if (!render && renderNoAccessMessage) {\n      return DEFAULT_NO_ACCESS_MESSAGE;\n    }\n\n    if (isRenderFunc<ChildFunction>(children)) {\n      return children(renderProps);\n    }\n\n    return render ? children : null;\n  }\n}\n\nexport default withOrganization(withConfig(Access));\n","import {useMemo} from 'react';\n\nimport ConfigStore from 'sentry/stores/configStore';\nimport {Organization, User} from 'sentry/types';\nimport {isActiveSuperuser} from 'sentry/utils/isActiveSuperuser';\nimport {isRenderFunc} from 'sentry/utils/isRenderFunc';\nimport withOrganization from 'sentry/utils/withOrganization';\n\ntype RoleRenderProps = {\n  hasRole: boolean;\n};\n\ntype ChildrenRenderFn = (props: RoleRenderProps) => React.ReactElement | null;\n\nfunction checkUserRole(user: User, organization: Organization, role: RoleProps['role']) {\n  if (!user) {\n    return false;\n  }\n\n  if (isActiveSuperuser()) {\n    return true;\n  }\n\n  if (!Array.isArray(organization.orgRoleList)) {\n    return false;\n  }\n\n  const roleIds = organization.orgRoleList.map(r => r.id);\n\n  if (!roleIds.includes(role) || !roleIds.includes(organization.role ?? '')) {\n    return false;\n  }\n\n  const requiredIndex = roleIds.indexOf(role);\n  const currentIndex = roleIds.indexOf(organization.role ?? '');\n  return currentIndex >= requiredIndex;\n}\n\ninterface RoleProps {\n  /**\n   * If children is a function then will be treated as a render prop and\n   * passed RoleRenderProps.\n   *\n   * The other interface is more simple, only show `children` if user has\n   * the minimum required role.\n   */\n  children: React.ReactElement | ChildrenRenderFn;\n  /**\n   * Current Organization\n   */\n  organization: Organization;\n  /**\n   * Minimum required role\n   */\n  role: string;\n}\n\nfunction Role({role, organization, children}: RoleProps): React.ReactElement | null {\n  const user = ConfigStore.get('user');\n\n  const hasRole = useMemo(\n    () => checkUserRole(user, organization, role),\n    // It seems that this returns a stable reference, but\n    [organization, role, user]\n  );\n\n  if (isRenderFunc<ChildrenRenderFn>(children)) {\n    return children({hasRole});\n  }\n\n  return hasRole ? children : null;\n}\n\nconst withOrganizationRole = withOrganization(Role);\n\nexport {withOrganizationRole as Role};\n","import {useCallback, useEffect, useRef, useState} from 'react';\nimport styled from '@emotion/styled';\n\nimport Button from 'sentry/components/button';\nimport {\n  Input,\n  InputGroup,\n  InputLeadingItems,\n  InputProps,\n  InputTrailingItems,\n} from 'sentry/components/inputGroup';\nimport {IconSearch} from 'sentry/icons';\nimport {IconClose} from 'sentry/icons/iconClose';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\n\ninterface SearchBarProps extends Omit<InputProps, 'onChange'> {\n  defaultQuery?: string;\n  onChange?: (query: string) => void;\n  onSearch?: (query: string) => void;\n  query?: string;\n  trailing?: React.ReactNode;\n  width?: string;\n}\n\nfunction SearchBar({\n  query: queryProp,\n  defaultQuery = '',\n  onChange,\n  onSearch,\n  width,\n  size,\n  className,\n  trailing,\n  ...inputProps\n}: SearchBarProps) {\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const [query, setQuery] = useState(queryProp ?? defaultQuery);\n\n  // if query prop keeps changing we should treat this as\n  // a controlled component and its internal state should be in sync\n  useEffect(() => {\n    if (typeof queryProp === 'string') {\n      setQuery(queryProp);\n    }\n  }, [queryProp]);\n\n  const onQueryChange = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      const {value} = e.target;\n      setQuery(value);\n      onChange?.(value);\n    },\n    [onChange]\n  );\n\n  const onSubmit = useCallback(\n    (e: React.FormEvent<HTMLFormElement>) => {\n      e.preventDefault();\n      inputRef.current?.blur();\n      onSearch?.(query);\n    },\n    [onSearch, query]\n  );\n\n  const clearSearch = useCallback(() => {\n    setQuery('');\n    onChange?.('');\n    onSearch?.('');\n  }, [onChange, onSearch]);\n\n  return (\n    <FormWrap onSubmit={onSubmit} className={className}>\n      <InputGroup>\n        <InputLeadingItems disablePointerEvents>\n          <IconSearch color=\"subText\" size={size === 'xs' ? 'xs' : 'sm'} />\n        </InputLeadingItems>\n        <StyledInput\n          {...inputProps}\n          ref={inputRef}\n          type=\"text\"\n          name=\"query\"\n          autoComplete=\"off\"\n          value={query}\n          onChange={onQueryChange}\n          width={width}\n          size={size}\n        />\n        <InputTrailingItems>\n          {trailing}\n          {!!query && (\n            <SearchBarTrailingButton\n              type=\"button\"\n              size=\"zero\"\n              borderless\n              onClick={clearSearch}\n              icon={<IconClose size=\"xs\" />}\n              aria-label={t('Clear')}\n            />\n          )}\n        </InputTrailingItems>\n      </InputGroup>\n    </FormWrap>\n  );\n}\n\nconst FormWrap = styled('form')`\n  display: block;\n  position: relative;\n`;\n\nconst StyledInput = styled(Input)`\n  ${p => p.width && `width: ${p.width};`}\n`;\n\nexport const SearchBarTrailingButton = styled(Button)`\n  color: ${p => p.theme.subText};\n  padding: ${space(0.5)};\n`;\n\nexport default SearchBar;\n","function routeTitleGen(\n  routeName: string,\n  orgSlug: string,\n  withSentry: boolean = true,\n  projectSlug?: string\n): string {\n  const tmplBase = `${routeName} - ${orgSlug}`;\n  const tmpl = projectSlug ? `${tmplBase} - ${projectSlug}` : tmplBase;\n\n  return withSentry ? `${tmpl} - Sentry` : tmpl;\n}\n\nexport default routeTitleGen;\n","import AsyncComponent from 'sentry/components/asyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import {Fragment} from 'react';\nimport styled from '@emotion/styled';\n\nimport Access from 'sentry/components/acl/access';\nimport {Role} from 'sentry/components/acl/role';\nimport Button from 'sentry/components/button';\nimport ButtonBar from 'sentry/components/buttonBar';\nimport Confirm from 'sentry/components/confirm';\nimport FileSize from 'sentry/components/fileSize';\nimport Link from 'sentry/components/links/link';\nimport TimeSince from 'sentry/components/timeSince';\nimport Tooltip from 'sentry/components/tooltip';\nimport {IconClock, IconDelete, IconDownload} from 'sentry/icons';\nimport {t, tct} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {DebugFile} from 'sentry/types/debugFiles';\n\ntype Props = {\n  downloadRole: string;\n  downloadUrl: string;\n  mapping: DebugFile;\n  onDelete: (id: string) => void;\n  orgSlug: string;\n};\n\nconst ProjectProguardRow = ({\n  mapping,\n  onDelete,\n  downloadUrl,\n  downloadRole,\n  orgSlug,\n}: Props) => {\n  const {id, debugId, uuid, size, dateCreated} = mapping;\n\n  const handleDeleteClick = () => {\n    onDelete(id);\n  };\n\n  return (\n    <Fragment>\n      <NameColumn>\n        <Name>{debugId || uuid || `(${t('empty')})`}</Name>\n        <TimeWrapper>\n          <IconClock size=\"sm\" />\n          <TimeSince date={dateCreated} />\n        </TimeWrapper>\n      </NameColumn>\n      <SizeColumn>\n        <FileSize bytes={size} />\n      </SizeColumn>\n      <ActionsColumn>\n        <ButtonBar gap={0.5}>\n          <Role role={downloadRole}>\n            {({hasRole}) => (\n              <Tooltip\n                title={tct(\n                  'Mappings can only be downloaded by users with organization [downloadRole] role[orHigher]. This can be changed in [settingsLink:Debug Files Access] settings.',\n                  {\n                    downloadRole,\n                    orHigher: downloadRole !== 'owner' ? ` ${t('or higher')}` : '',\n                    settingsLink: <Link to={`/settings/${orgSlug}/#debugFilesRole`} />,\n                  }\n                )}\n                disabled={hasRole}\n                isHoverable\n              >\n                <Button\n                  size=\"sm\"\n                  icon={<IconDownload size=\"sm\" />}\n                  disabled={!hasRole}\n                  href={downloadUrl}\n                  title={hasRole ? t('Download Mapping') : undefined}\n                  aria-label={t('Download Mapping')}\n                />\n              </Tooltip>\n            )}\n          </Role>\n\n          <Access access={['project:releases']}>\n            {({hasAccess}) => (\n              <Tooltip\n                disabled={hasAccess}\n                title={t('You do not have permission to delete mappings.')}\n              >\n                <Confirm\n                  message={t('Are you sure you want to remove this mapping?')}\n                  onConfirm={handleDeleteClick}\n                  disabled={!hasAccess}\n                >\n                  <Button\n                    size=\"sm\"\n                    icon={<IconDelete size=\"sm\" />}\n                    title={hasAccess ? t('Remove Mapping') : undefined}\n                    aria-label={t('Remove Mapping')}\n                    disabled={!hasAccess}\n                  />\n                </Confirm>\n              </Tooltip>\n            )}\n          </Access>\n        </ButtonBar>\n      </ActionsColumn>\n    </Fragment>\n  );\n};\n\nconst NameColumn = styled('div')`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: center;\n`;\n\nconst SizeColumn = styled('div')`\n  display: flex;\n  justify-content: flex-end;\n  text-align: right;\n  align-items: center;\n`;\n\nconst ActionsColumn = styled(SizeColumn)``;\n\nconst Name = styled('div')`\n  padding-right: ${space(4)};\n  overflow-wrap: break-word;\n  word-break: break-all;\n`;\n\nconst TimeWrapper = styled('div')`\n  display: grid;\n  gap: ${space(0.5)};\n  grid-template-columns: min-content 1fr;\n  font-size: ${p => p.theme.fontSizeMedium};\n  align-items: center;\n  color: ${p => p.theme.subText};\n  margin-top: ${space(1)};\n`;\n\nexport default ProjectProguardRow;\n","import {Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\n\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport Pagination from 'sentry/components/pagination';\nimport {PanelTable} from 'sentry/components/panels';\nimport SearchBar from 'sentry/components/searchBar';\nimport {t, tct} from 'sentry/locale';\nimport {Organization, Project} from 'sentry/types';\nimport {DebugFile} from 'sentry/types/debugFiles';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport AsyncView from 'sentry/views/asyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\nimport TextBlock from 'sentry/views/settings/components/text/textBlock';\n\nimport ProjectProguardRow from './projectProguardRow';\n\ntype Props = RouteComponentProps<{orgId: string; projectId: string}, {}> & {\n  organization: Organization;\n  project: Project;\n};\n\ntype State = AsyncView['state'] & {\n  mappings: DebugFile[];\n};\n\nclass ProjectProguard extends AsyncView<Props, State> {\n  getTitle() {\n    const {projectId} = this.props.params;\n\n    return routeTitleGen(t('ProGuard Mappings'), projectId, false);\n  }\n\n  getDefaultState(): State {\n    return {\n      ...super.getDefaultState(),\n      mappings: [],\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {params, location} = this.props;\n    const {orgId, projectId} = params;\n\n    const endpoints: ReturnType<AsyncView['getEndpoints']> = [\n      [\n        'mappings',\n        `/projects/${orgId}/${projectId}/files/dsyms/`,\n        {query: {query: location.query.query, file_formats: 'proguard'}},\n      ],\n    ];\n\n    return endpoints;\n  }\n\n  handleDelete = (id: string) => {\n    const {orgId, projectId} = this.props.params;\n\n    this.setState({\n      loading: true,\n    });\n\n    this.api.request(\n      `/projects/${orgId}/${projectId}/files/dsyms/?id=${encodeURIComponent(id)}`,\n      {\n        method: 'DELETE',\n        complete: () => this.fetchData(),\n      }\n    );\n  };\n\n  handleSearch = (query: string) => {\n    const {location, router} = this.props;\n\n    router.push({\n      ...location,\n      query: {...location.query, cursor: undefined, query},\n    });\n  };\n\n  getQuery() {\n    const {query} = this.props.location.query;\n\n    return typeof query === 'string' ? query : undefined;\n  }\n\n  getEmptyMessage() {\n    if (this.getQuery()) {\n      return t('There are no mappings that match your search.');\n    }\n\n    return t('There are no mappings for this project.');\n  }\n\n  renderLoading() {\n    return this.renderBody();\n  }\n\n  renderMappings() {\n    const {mappings} = this.state;\n    const {organization, params} = this.props;\n    const {orgId, projectId} = params;\n\n    if (!mappings?.length) {\n      return null;\n    }\n\n    return mappings.map(mapping => {\n      const downloadUrl = `${\n        this.api.baseUrl\n      }/projects/${orgId}/${projectId}/files/dsyms/?id=${encodeURIComponent(mapping.id)}`;\n\n      return (\n        <ProjectProguardRow\n          mapping={mapping}\n          downloadUrl={downloadUrl}\n          onDelete={this.handleDelete}\n          downloadRole={organization.debugFilesRole}\n          key={mapping.id}\n          orgSlug={organization.slug}\n        />\n      );\n    });\n  }\n\n  renderBody() {\n    const {loading, mappings, mappingsPageLinks} = this.state;\n\n    return (\n      <Fragment>\n        <SettingsPageHeader\n          title={t('ProGuard Mappings')}\n          action={\n            <SearchBar\n              placeholder={t('Filter mappings')}\n              onSearch={this.handleSearch}\n              query={this.getQuery()}\n              width=\"280px\"\n            />\n          }\n        />\n\n        <TextBlock>\n          {tct(\n            `ProGuard mapping files are used to convert minified classes, methods and field names into a human readable format. To learn more about proguard mapping files, [link: read the docs].`,\n            {\n              link: (\n                <ExternalLink href=\"https://docs.sentry.io/platforms/android/proguard/\" />\n              ),\n            }\n          )}\n        </TextBlock>\n\n        <StyledPanelTable\n          headers={[\n            t('Mapping'),\n            <SizeColumn key=\"size\">{t('File Size')}</SizeColumn>,\n            '',\n          ]}\n          emptyMessage={this.getEmptyMessage()}\n          isEmpty={mappings?.length === 0}\n          isLoading={loading}\n        >\n          {this.renderMappings()}\n        </StyledPanelTable>\n        <Pagination pageLinks={mappingsPageLinks} />\n      </Fragment>\n    );\n  }\n}\n\nconst StyledPanelTable = styled(PanelTable)`\n  grid-template-columns: minmax(220px, 1fr) max-content 120px;\n`;\n\nconst SizeColumn = styled('div')`\n  text-align: right;\n`;\n\nexport default ProjectProguard;\n","import {Component} from 'react';\n\nimport withOrganization from 'sentry/utils/withOrganization';\n\nimport ProjectProguard from './projectProguard';\n\nclass ProjectProguardContainer extends Component<ProjectProguard['props']> {\n  render() {\n    return <ProjectProguard {...this.props} />;\n  }\n}\n\nexport default withOrganization(ProjectProguardContainer);\n"],"names":["DEFAULT_NO_ACCESS_MESSAGE","type","showIcon","t","Access","Component","render","organization","config","access","requireAll","isSuperuser","renderNoAccessMessage","children","this","props","orgAccess","hasAccess","acc","includes","hasSuperuser","user","renderProps","isRenderFunc","withOrganization","withConfig","withOrganizationRole","role","ConfigStore","hasRole","useMemo","isActiveSuperuser","Array","isArray","orgRoleList","roleIds","map","r","id","requiredIndex","indexOf","checkUserRole","SearchBar","query","queryProp","defaultQuery","onChange","onSearch","width","size","className","trailing","inputProps","inputRef","useRef","setQuery","useState","useEffect","onQueryChange","useCallback","e","value","target","onSubmit","preventDefault","current","blur","clearSearch","FormWrap","disablePointerEvents","color","StyledInput","ref","name","autoComplete","SearchBarTrailingButton","borderless","onClick","icon","Input","p","Button","theme","subText","space","routeName","orgSlug","withSentry","projectSlug","tmplBase","tmpl","AsyncView","AsyncComponent","getTitle","title","renderComponent","ProjectProguardRow","mapping","onDelete","downloadUrl","downloadRole","debugId","uuid","dateCreated","handleDeleteClick","Fragment","NameColumn","Name","TimeWrapper","date","SizeColumn","bytes","ActionsColumn","gap","tct","orHigher","settingsLink","to","disabled","isHoverable","href","undefined","message","onConfirm","fontSizeMedium","ProjectProguard","orgId","projectId","params","setState","loading","api","request","encodeURIComponent","method","complete","fetchData","location","router","push","cursor","routeTitleGen","getDefaultState","super","mappings","getEndpoints","file_formats","getQuery","getEmptyMessage","renderLoading","renderBody","renderMappings","state","length","baseUrl","handleDelete","debugFilesRole","slug","mappingsPageLinks","action","placeholder","handleSearch","link","StyledPanelTable","headers","emptyMessage","isEmpty","isLoading","pageLinks","PanelTable","ProjectProguardContainer"],"sourceRoot":""}