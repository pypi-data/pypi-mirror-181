"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionTags_index_tsx"],{"./app/components/charts/components/visualMap.tsx":(e,t,a)=>{function n(e){return e}a.d(t,{Z:()=>n}),a("../node_modules/echarts/lib/component/visualMap.js")},"./app/components/charts/loadingPanel.tsx":(e,t,a)=>{a.d(t,{Z:()=>i});var n=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=a("./app/components/loadingMask.tsx"),o=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=(0,n.Z)((e=>{let{height:t,...a}=e;return(0,o.tZ)("div",{...a,children:(0,o.tZ)(s.Z,{})})}),{target:"eumb2md0"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");r.defaultProps={height:"200px"};const i=r},"./app/components/charts/transitionChart.tsx":(e,t,a)=>{a.d(t,{Z:()=>l});var n=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=a("../node_modules/react/index.js"),o=a("./app/components/charts/loadingPanel.tsx"),r=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends s.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{prevReloading:this.props.reloading,prevLoading:this.props.loading,key:1})}static getDerivedStateFromProps(e,t){const a=t.prevReloading,n=e.reloading,s=t.prevLoading,o=e.loading;return s!==o?{prevReloading:n,prevLoading:o,key:t.key+1}:o?{prevReloading:n,prevLoading:o,key:t.key}:a&&!n?{prevReloading:n,prevLoading:o,key:t.key+1}:{prevReloading:n,prevLoading:o,key:t.key}}render(){const{height:e,loading:t,reloading:a}=this.props;return t&&!a?(0,r.tZ)(o.Z,{height:e,"data-test-id":"events-request-loading"}):(0,r.tZ)(s.Fragment,{children:this.props.children},String(this.state.key))}}i.displayName="TransitionChart",(0,n.Z)(i,"defaultProps",{height:"200px"});const l=i},"./app/components/charts/transparentLoadingMask.tsx":(e,t,a)=>{a.d(t,{Z:()=>r});var n=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=a("./app/components/loadingMask.tsx"),o=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=(0,n.Z)((e=>{let{className:t,visible:a,children:n,...r}=e;const i=a?{...r,"data-test-id":"loading-placeholder"}:r;return(0,o.tZ)(s.Z,{className:t,...i,children:n})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/events/searchBar.tsx":(e,t,a)=>{a.d(t,{Z:()=>V}),a("../node_modules/core-js/modules/es.error.cause.js"),a("../node_modules/core-js/modules/es.array.includes.js");var n=a("../node_modules/react/index.js"),s=a("../node_modules/@sentry/core/esm/exports.js"),o=a("../node_modules/lodash/assign.js"),r=a.n(o),i=a("../node_modules/lodash/flatten.js"),l=a.n(i),d=a("../node_modules/lodash/memoize.js"),c=a.n(d),u=a("../node_modules/lodash/omit.js"),m=a.n(u),p=a("./app/actionCreators/tags.tsx"),g=a("./app/components/smartSearchBar/index.tsx"),h=a("./app/constants/index.tsx"),y=a("./app/types/index.tsx"),Z=a("./app/utils.tsx"),f=a("./app/utils/discover/fields.tsx"),x=a("./app/utils/fields/index.ts"),v=a("./app/utils/measurements/measurements.tsx"),b=a("./app/utils/useApi.tsx"),w=a("./app/utils/withTags.tsx"),k=a("./app/views/dashboardsV2/utils.tsx"),C=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const j=new RegExp(`^${h.c$}|\\${h.ir}`,"g"),S=new Set(Object.keys(f.wZ)),_=Object.keys(f.wZ).reduce(((e,t)=>(e[t]={...f.wZ[t],kind:x.IV.FIELD},e)),{}),T=m()(_,f.J8),L=f.$4.reduce(((e,t)=>(e[t]={name:t,kind:x.IV.METRICS},e)),{}),q=Object.keys(f.jg).reduce(((e,t)=>(e[t]={...f.jg[t],kind:x.IV.FIELD},e)),{});function B(e){const{maxSearchItems:t,organization:a,tags:o,omitTags:i,fields:d,projectIds:u,includeSessionTagsValues:h,maxMenuHeight:w,customMeasurements:B}=e,V=(0,b.Z)(),D=(0,n.useRef)(!1),P=(0,n.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(S.has(t.field)||(0,f.GO)(t.field)||(0,k.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:x.IV.FUNCTION}),e)),{}):[])(d)),[d]),A=(0,n.useMemo)((()=>Object.keys(o).reduce(((e,t)=>(e[t]={...o[t],kind:x.IV.TAG},e)),{})),[o]);(0,n.useEffect)((()=>{R.cache.clear?.()}),[u]);const R=c()(((e,t,n)=>{const s=u?.map(String);return(0,f.h1)(e.key)||(0,f.Xr)(e.key)?Promise.resolve([]):(0,p.Fo)({api:V,orgSlug:a.slug,tagKey:e.key,search:t,projectIds:s,endpointParams:n,includeTransactions:!0,includeSessions:h}).then((e=>l()(e.filter((e=>{let{name:t}=e;return(0,Z.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:a}=e;return`${a}-${t}`})),z=e=>{let t;!D.current&&Object.keys(o).length>0&&(t=s.Yr({name:"SearchBar.getTagList"}),D.current=!0);const n=((e,t)=>{const a=Object.keys(e).reduce(((t,a)=>(t[a]={...e[a],kind:x.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,a)=>(e[a]={...t[a],kind:x.IV.MEASUREMENT},e)),a):a})(e,B),l=a.features.includes("performance-view")?Object.assign({},n,P,L,_):Object.assign({},T);r()(l,A,_,q),l.has={key:x.Sh.HAS,name:"Has property",values:Object.keys(l).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:x.IV.FIELD};const d=i&&i.length>0?m()(l,i):l;if(t){const e=Object.keys(d).length;t.setTag("tags.totalCount",e);const a=[1,5,10,20,50,100,200,300,400,500,600,700,800,900,1e3,1e4].find((t=>e<=t));t.setTag("tags.totalCount.grouped",`<=${a}`),t.finish()}return d};return(0,C.tZ)(v.Z,{children:a=>{let{measurements:n}=a;return(0,C.tZ)(g.Z,{hasRecentSearches:!0,savedSearchType:y.L4.EVENT,onGetTagValues:R,supportedTags:z(n),prepareQuery:e=>e.replace(j,""),maxSearchItems:t,excludedTags:["environment"],maxMenuHeight:w??300,customPerformanceMetrics:B,...e})}})}B.displayName="SearchBar";const V=(0,w.Z)(B)},"./app/components/gridEditable/sortLink.tsx":(e,t,a)=>{a.d(t,{Z:()=>g});var n=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=a("../node_modules/react-router/es/index.js"),o=a("../node_modules/lodash/omit.js"),r=a.n(o),i=a("./app/components/links/link.tsx"),l=a("./app/icons/index.tsx"),d=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{align:t,title:a,canSort:n,generateSortLink:o,onClick:r,direction:i,replace:l}=e;const c=o();if(!c||!n)return(0,d.tZ)(m,{align:t,children:a});const g=i?(0,d.tZ)(p,{size:"xs",direction:"desc"===i?"down":"up"}):null;return(0,d.BX)(u,{align:t,to:c,onClick:e=>{l&&(e.preventDefault(),s.browserHistory.replace(c)),r?.(e)},children:[a," ",g]})}c.displayName="SortLink";const u=(0,n.Z)((e=>{const t=r()(e,["align","css"]);return(0,d.tZ)(i.Z,{...t})}),{target:"e1xb2te62"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),m=(0,n.Z)("div",{target:"e1xb2te61"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),p=(0,n.Z)(l.CC,{target:"e1xb2te60"})({name:"40f4ru",styles:"vertical-align:top"}),g=c},"./app/components/loadingMask.tsx":(e,t,a)=>{a.d(t,{Z:()=>n});const n=(0,a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1dnwgq10"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/utils/withTags.tsx":(e,t,a)=>{a.d(t,{Z:()=>l});var n=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=a("../node_modules/react/index.js"),o=a("./app/stores/tagStore.tsx"),r=a("./app/utils/getDisplayName.tsx"),i=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends s.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{tags:o.Z.getState()}),(0,n.Z)(this,"unsubscribe",o.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...a}=this.props;return(0,i.tZ)(e,{tags:t??this.state.tags,...a})}}return t.displayName="WithTags",(0,n.Z)(t,"displayName",`withTags(${(0,r.Z)(e)})`),t}},"./app/views/performance/transactionSummary/transactionTags/index.tsx":(e,t,a)=>{a.r(t),a.d(t,{default:()=>Je});var n=a("./app/locale.tsx"),s=a("./app/utils/discover/eventView.tsx"),o=a("./app/utils/queryString.tsx"),r=a("./app/utils/tokenizeSearch.tsx"),i=a("./app/utils/withOrganization.tsx"),l=a("./app/utils/withProjects.tsx"),d=a("./app/views/performance/transactionSummary/pageLayout.tsx"),c=a("./app/views/performance/transactionSummary/tabs.tsx"),u=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),m=a("../node_modules/react/index.js"),p=a("../node_modules/react-router/es/index.js"),g=a("./app/components/charts/styles.tsx"),h=a("./app/components/compactSelect.tsx"),y=a("./app/components/datePageFilter.tsx"),Z=a("./app/components/environmentPageFilter.tsx"),f=a("./app/components/events/searchBar.tsx"),x=a("./app/components/layouts/thirds.tsx"),v=a("./app/components/loadingIndicator.tsx"),b=a("./app/components/organizations/pageFilterBar.tsx"),w=a("./app/components/organizations/pageFilters/parse.tsx"),k=a("./app/components/questionTooltip.tsx"),C=a("./app/components/radio.tsx"),j=a("./app/styles/space.tsx"),S=a("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),_=a("./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx"),T=a("./app/views/performance/transactionSummary/utils.tsx"),L=a("./app/views/performance/transactionSummary/filter.tsx"),q=a("./app/views/performance/transactionSummary/transactionOverview/tagExplorer.tsx");let B;!function(e){e.DURATION="transaction.duration",e.LCP="measurements.lcp"}(B||(B={}));const V=[{label:(0,n.t)("LCP"),value:B.LCP},{label:(0,n.t)("Duration"),value:B.DURATION}];var D=a("./app/utils/discover/genericDiscoverQuery.tsx"),P=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function A(e){const{aggregateColumn:t}=e;return function(a){const{eventView:n}=a,s=n.getEventsAPIPayload(a.location);return s.aggregateColumn=t,s.sort=e.sort,s.tagKey=e.tagKey,s.numBucketsPerKey=e.numBucketsPerKey,s}}function R(e,t){return e.aggregateColumn!==t.aggregateColumn||e.sort!==t.sort||e.tagKey!==t.tagKey}function z(e){return(0,P.tZ)(D.ZP,{route:"events-facets-performance-histogram",getRequestPayload:A(e),shouldRefetchData:R,...e})}z.displayName="TagKeyHistogramQuery";const N=z;var I=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),M=(a("../node_modules/core-js/modules/es.array.includes.js"),a("../node_modules/react-dom/profiling.js")),O=a("../node_modules/react-popper/lib/esm/usePopper.js"),E=a("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),F=a("../node_modules/@react-aria/overlays/dist/module.js"),X=a("../node_modules/@react-stately/overlays/dist/module.js"),K=a("../node_modules/@sentry/utils/esm/string.js"),H=a("../node_modules/lodash/memoize.js"),$=a.n(H);a("./app/components/charts/components/visualMap.tsx"),a("../node_modules/echarts/lib/chart/heatmap.js"),a("../node_modules/echarts/lib/component/visualMap.js");var W=a("./app/components/charts/baseChart.tsx");const Q=(0,m.forwardRef)(((e,t)=>{const{series:a,seriesOptions:n,visualMaps:s,...o}=e;return(0,P.tZ)(W.Z,{ref:t,options:{visualMap:s},...o,series:a.map((e=>{let{seriesName:t,data:a,dataArray:s,...o}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:t,...a}=e;return{data:t,...a,type:"heatmap"}}({...n,...o,name:t,data:s||a.map((e=>{let{value:t,name:a}=e;return[a,t]}))})}))})}));var U=a("./app/components/charts/transitionChart.tsx"),G=a("./app/components/charts/transparentLoadingMask.tsx"),Y=a("./app/components/overlay.tsx"),J=a("./app/components/panels/index.tsx"),ee=a("./app/components/performanceDuration.tsx"),te=a("./app/components/placeholder.tsx"),ae=a("./app/components/quickTrace/styles.tsx"),ne=a("./app/components/truncate.tsx"),se=a("./app/utils/discover/charts.tsx"),oe=a("./app/utils/formatters.tsx"),re=a("./app/utils/getDynamicText.tsx");function ie(e,t){return e.query!==t.query}function le(e){return(0,P.tZ)(D.ZP,{route:"events",shouldRefetchData:ie,...e})}le.displayName="TagTransactionsQuery";const de=le;var ce=a("./app/views/performance/utils.tsx"),ue=a("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),me=a("./app/views/performance/transactionSummary/transactionTags/utils.tsx");class pe{constructor(e){(0,I.Z)(this,"boundingRect",void 0),this.boundingRect=e.getBoundingClientRect()}getBoundingClientRect(){return this.boundingRect}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const ge=$()((()=>{let e=document.getElementById("heatmap-portal");return e||(e=document.createElement("div"),e.setAttribute("id","heatmap-portal"),document.body.appendChild(e),e)})),he=e=>{const{tableData:t,isLoading:a,organization:s,eventView:r,location:i,tagKey:l,transactionName:d,aggregateColumn:c}=e,u=(0,m.useRef)(null),[p,g]=(0,m.useState)(),[h,y]=(0,m.useState)(null),[Z,f]=(0,m.useState)(null),[x,b]=(0,m.useState)(),w=["#D1BAFC","#9282F3","#6056BA","#313087","#021156"],C=new Set,S=t&&t.histogram&&t.histogram.data&&t.histogram.data.length?t.histogram.data:void 0,_=t&&t.tags&&t.tags.data?t.tags.data:void 0,L=S&&(q=S[0],Object.keys(q).find((e=>e.includes("histogram"))));var q;const B=_?_.map((e=>e.tags_value)).reverse():[];let V=0;const D=L&&S?S.map((e=>{const t=e[L],a=(0,ce.YL)(t),n=e.tags_value;return C.add(a),V=Math.max(V,e.count),[a,n,e.count]})):null;D?.sort(((e,t)=>{const a=t[0]===e[0]?1:0;return t[a]-e[a]}));const A={height:290,animation:!1,colors:w,tooltip:{},yAxis:{type:"category",data:Array.from(B),splitArea:{show:!0},axisLabel:{formatter:e=>(0,K.$G)(e,30)}},xAxis:{type:"category",splitArea:{show:!0},data:Array.from(C),axisLabel:{show:!0,showMinLabel:!0,showMaxLabel:!0,formatter:e=>(0,se.gu)(e,"number")},axisLine:{},axisPointer:{show:!1},axisTick:{show:!0,interval:0,alignWithLabel:!0}},grid:{left:(0,j.Z)(3),right:(0,j.Z)(3),top:"25px",bottom:(0,j.Z)(4)}},R=[{min:0,max:V,show:!1,orient:"horizontal",calculable:!0,inRange:{color:w}}],z=[];D&&z.push({seriesName:"Count",dataArray:D,label:{show:!0,formatter:e=>(0,oe.Du)(e.value[2])},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}});const N=(0,X.d)({}),{overlayProps:I}=(0,F.Ir)({isOpen:N.isOpen,onClose:N.close,isDismissable:!0,shouldCloseOnBlur:!0,shouldCloseOnInteractOutside:e=>!u.current?.getEchartsInstance().getDom().contains(e)},{current:h??null}),{styles:H,state:$}=(0,O.D)(p,h,{placement:"bottom",strategy:"absolute",modifiers:[{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"offset",options:{offset:[0,8]}},{name:"arrow",options:{element:Z,padding:4}},{name:"preventOverflow",enabled:!0,options:{padding:12,altAxis:!0}}]}),W=(0,E.u)(),J=p&&N.isOpen?(0,P.tZ)(Y.w,{ref:y,zIndex:W.zIndex.dropdown,style:H.popper,...I,children:(0,P.tZ)(Y.a,{arrowProps:{ref:f,style:H.arrow,placement:$?.placement},children:x&&(0,P.tZ)(de,{query:x.getQueryWithAdditionalConditions(),location:i,eventView:x,orgSlug:s.slug,limit:4,referrer:"api.performance.tag-page",children:e=>{let{isLoading:t,tableData:a}=e;if(t)return(0,P.tZ)(ye,{children:(0,P.tZ)(v.Z,{size:40,hideMessage:!0})});const r=(0,ue.xr)({orgSlug:s.slug,transaction:d,projectID:(0,o.ro)(i.query.project),query:{...x.generateQueryStringObject(),query:x.getQueryWithAdditionalConditions()}});return(0,P.BX)("div",{children:[a?.data.length?null:(0,P.tZ)(te.Z,{}),[...a?.data??[]].slice(0,3).map((e=>{const t=(0,T.vd)(d)(s,e,i.query);return(0,P.tZ)(ae.hP,{width:"small",to:t,children:(0,P.BX)(Ze,{children:[(0,P.tZ)(ne.Z,{value:e.id,maxLength:12}),(0,P.tZ)(ae.df,{children:(0,P.tZ)(ee.Z,{milliseconds:Number(e[c]),abbreviation:!0})})]})},e.id)})),r&&a&&a.data.length>3?(0,P.tZ)(ae.hP,{width:"small",to:r,children:(0,P.tZ)(Ze,{children:(0,n.t)("View all events")})}):null]})}})})}):null,ie=S&&(0,me.oT)(S[0]);return(0,P.BX)(fe,{children:[(0,P.BX)(xe,{children:[(0,n.t)("Heat Map"),(0,P.tZ)(k.Z,{size:"sm",position:"top",title:(0,n.t)("This heatmap shows the frequency for each duration across the most common tag values")})]}),(0,P.BX)(U.Z,{loading:a,reloading:a,children:[(0,P.tZ)(G.Z,{visible:a}),(0,P.BX)(m.Fragment,{children:[(0,M.createPortal)((0,P.tZ)("div",{children:J}),ge()),(0,re.Z)({value:(0,P.tZ)(Q,{ref:u,visualMaps:R,series:z,onClick:e=>{const t=e.event.event,a=new pe(t.target);g(a);const n=r.clone();n.fields=[{field:c}];const[o,i]=e.value;if(ie&&S){const t=S[e.dataIndex],a=parseInt(`${t[ie.histogramField]}`,10),s=a+ie.bucketSize;n.additionalConditions.setFilterValues(c,[`>=${a}`,`<${s}`])}l&&n.additionalConditions.setFilterValues(l,[i]),b(n),(0,me.bZ)(s),N.isOpen||N.open()},...A}),fixed:(0,P.tZ)(te.Z,{height:"290px",testId:"skeleton-ui"})})]})]})]})};he.displayName="TagsHeatMap";const ye=(0,u.Z)("div",{target:"eoy5kj73"})({name:"kxllrv",styles:"width:200px;height:100px;display:flex;align-items:center;justify-content:center"}),Ze=(0,u.Z)("div",{target:"eoy5kj72"})({name:"17wn5yb",styles:"width:100%;display:flex;flex-direction:row;justify-content:space-between"}),fe=(0,u.Z)(J.s_,{target:"eoy5kj71"})("padding:",(0,j.Z)(3)," ",(0,j.Z)(3)," 0 ",(0,j.Z)(3),";margin-bottom:0;border-bottom:0;border-bottom-left-radius:0;border-bottom-right-radius:0;"),xe=(0,u.Z)(g.ws,{target:"eoy5kj70"})(""),ve=he;var be=a("./app/components/gridEditable/index.tsx"),we=a("./app/components/gridEditable/sortLink.tsx"),ke=a("./app/components/links/link.tsx"),Ce=a("./app/components/pagination.tsx"),je=a("./app/icons/iconAdd.tsx"),Se=a("./app/utils/discover/fields.tsx"),_e=a("./app/views/eventsV2/table/cellAction.tsx");const Te="tags_cursor";class Le extends m.Component{constructor(){super(...arguments),(0,I.Z)(this,"state",{widths:[]}),(0,I.Z)(this,"renderHeadCellWithMeta",((e,t,a)=>(n,s)=>this.renderHeadCell(e,t,n,a[s]))),(0,I.Z)(this,"handleTagValueClick",((e,t,a)=>{const n=(0,o.ro)(e.query.query),s=new r.MY(n??"");s.addFilterValues(t,[a]);const i=s.formatString();p.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(i).trim()}})})),(0,I.Z)(this,"handleCellAction",((e,t,a)=>n=>{const{eventView:s,location:o,organization:r}=this.props;(0,me.bZ)(r);const i=(0,T.xf)(s.query);(0,_e.rh)(i,n,{...e,name:a.id},t),p.browserHistory.push({pathname:o.pathname,query:{...o.query,[Te]:void 0,query:i.formatString()}})})),(0,I.Z)(this,"generateReleaseLocation",(e=>{const{organization:t,location:a}=this.props,{project:n}=a.query;return{pathname:`/organizations/${t.slug}/releases/${encodeURIComponent(e)}`,query:{project:n}}})),(0,I.Z)(this,"handleReleaseLinkClicked",(()=>{const{organization:e}=this.props;(0,S.Z)("performance_views.tags.jump_to_release",{organization:e})})),(0,I.Z)(this,"renderBodyCell",((e,t,a)=>{const s=a[t.key],{location:o,eventView:i,organization:l}=e;if("key"===t.key)return a.tags_key;const d=[_e.eX.ADD,_e.eX.EXCLUDE];if("tagValue"===t.key){const e={...a,id:a.tags_key};return(0,P.tZ)(_e.ZP,{column:t,dataRow:e,handleCellAction:this.handleCellAction(t,a.tags_value,e),allowActions:d,children:"release"===t.name?(0,P.tZ)(ke.Z,{to:this.generateReleaseLocation(a.tags_value),onClick:this.handleReleaseLinkClicked,children:(0,P.tZ)(q.xS,{row:a})}):(0,P.tZ)(q.xS,{row:a})})}if("frequency"===t.key)return(0,P.tZ)(Be,{children:(0,oe.rl)(a.frequency,0)});if("action"===t.key){const e=new r.MY(i.query).hasFilter(a.tags_key);return(0,P.tZ)(Be,{children:(0,P.tZ)(ke.Z,{disabled:e,to:"",onClick:()=>{(0,me.bZ)(l),this.handleTagValueClick(o,a.tags_key,a.tags_value)},children:(0,P.BX)(Ve,{children:[(0,P.tZ)(je.N,{isCircled:!0}),(0,n.t)("Add to filter")]})})})}if("comparison"===t.key){const e=a.comparison,t=(0,oe.rl)(e-1,0);return e>1?(0,n.t)("+%s slower",t):(0,n.t)("%s faster",t)}return"aggregate"===t.key?(0,P.tZ)(Be,{children:(0,P.tZ)(ee.Z,{abbreviation:!0,milliseconds:a.aggregate})}):"sumdelta"===t.key?(0,P.tZ)(Be,{children:(0,P.tZ)(ee.Z,{abbreviation:!0,milliseconds:a.sumdelta})}):"count"===t.key?(0,P.tZ)(Be,{children:s}):s})),(0,I.Z)(this,"renderBodyCellWithData",(e=>(t,a)=>this.renderBodyCell(e,t,a))),(0,I.Z)(this,"handleResizeColumn",((e,t)=>{const a=[...this.state.widths];a[e]=t.width?Number(t.width):be.z7,this.setState({widths:a})}))}renderHeadCell(e,t,a,n){const{location:s}=this.props,o=(0,Se.qG)(a.key,a.type,t),r={field:a.key,width:a.width},i=e.sortForField(r,t),l=i?i.kind:void 0;return(0,P.tZ)(we.Z,{align:o,title:n.name,direction:l,canSort:!0,generateSortLink:function(){if(!t)return;const a=e.sortOnField(r,t),{sort:n}=a.generateQueryStringObject();return{...s,query:{...s.query,[Te]:void 0,tagSort:n}}}})}render(){const{eventView:e,tagKey:t,location:a,isLoading:n,tableData:s,aggregateColumn:o,pageLinks:r,onCursor:i}=this.props,l=[...Pe].map((e=>{const a={...e};return"tagValue"===e.key&&t&&(a.name=t),"aggregate"===e.key&&"measurements.lcp"===o&&(a.name="Avg LCP"),a}));return(0,P.BX)(qe,{children:[(0,P.tZ)(be.ZP,{isLoading:n,data:s&&s.data?s.data:[],columnOrder:l,columnSortBy:[],grid:{renderHeadCell:this.renderHeadCellWithMeta(e,s?s.meta:{},l),renderBodyCell:this.renderBodyCellWithData(this.props),onResizeColumn:this.handleResizeColumn},location:a}),(0,P.tZ)(Ce.Z,{pageLinks:r,onCursor:i,size:"sm"})]})}}Le.displayName="TagValueTable";const qe=(0,u.Z)("div",{target:"e1gt1k5a2"})({name:"122h187",styles:">div{border-top-left-radius:0;border-top-right-radius:0;}"}),Be=(0,u.Z)("div",{target:"e1gt1k5a1"})({name:"29h503",styles:"text-align:right;flex:1"}),Ve=(0,u.Z)("div",{target:"e1gt1k5a0"})("display:grid;grid-auto-flow:column;gap:",(0,j.Z)(.5),";justify-content:flex-end;align-items:center;"),De="tableCursor",Pe=[{key:"tagValue",field:"tagValue",name:"Tag Values",width:-1,column:{kind:"field"}},{key:"frequency",field:"frequency",name:"Frequency",width:-1,column:{kind:"field"},canSort:!0},{key:"count",field:"count",name:"Events",width:-1,column:{kind:"field"},canSort:!0},{key:"aggregate",field:"aggregate",name:"Avg Duration",width:-1,column:{kind:"field"},canSort:!0},{key:"action",field:"action",name:"",width:-1,column:{kind:"field"}}],Ae=e=>{const{eventView:t,location:a,organization:n,aggregateColumn:r,tagKey:i}=e,l=t.clone(),d=(e,t,a)=>p.browserHistory.push({pathname:t,query:{...a,[De]:e}}),c=(0,o.ro)(a.query?.tableCursor),u=(0,me.oc)(a),g=(0,s.vp)(u);l.fields=Pe;const h=l.withSorts(g.length?g:[{field:"frequency",kind:"desc"}]);return(0,P.tZ)(m.Fragment,{children:i?(0,P.BX)(m.Fragment,{children:[(0,P.tZ)(N,{eventView:l,orgSlug:n.slug,location:a,aggregateColumn:r,numBucketsPerKey:40,tagKey:i,limit:8,cursor:c,sort:u??"-sumdelta",children:t=>{let{isLoading:a,tableData:n}=t;return(0,P.tZ)(ve,{...e,tagKey:i,aggregateColumn:r,tableData:n,isLoading:a})}}),(0,P.tZ)(_.Z,{eventView:h,orgSlug:n.slug,location:a,aggregateColumn:r,tagKey:i,limit:8,cursor:c,sort:u,allTagKeys:!0,children:t=>{let{isLoading:a,tableData:n,pageLinks:s}=t;return(0,P.tZ)(Le,{...e,eventView:h,tagKey:i,aggregateColumn:r,pageLinks:s,tableData:n,isLoading:a,onCursor:d})}})]}):(0,P.BX)(m.Fragment,{children:[(0,P.tZ)(ve,{...e,aggregateColumn:r,tableData:null,isLoading:!1}),(0,P.tZ)(Le,{...e,pageLinks:null,aggregateColumn:r,tableData:null,isLoading:!1})]})})};Ae.displayName="TagsDisplay";const Re=Ae,ze=e=>{const{eventView:t,location:a,organization:n,projects:s}=e,[o,r]=(0,m.useState)((0,q.e2)(L.f1.None,s,t));return(0,P.tZ)(x.or,{fullWidth:!0,children:(0,P.tZ)(_.Z,{eventView:t,orgSlug:n.slug,location:a,aggregateColumn:o,limit:20,sort:"-sumdelta",allTagKeys:!0,children:t=>{let{isLoading:a,tableData:n}=t;return(0,P.tZ)(Ne,{...e,isLoading:a,tableData:n,aggregateColumn:o,onChangeAggregateColumn:r})}})})};ze.displayName="TagsPageContent";const Ne=e=>{const{eventView:t,location:a,organization:s,tableData:r,aggregateColumn:i,onChangeAggregateColumn:l,isLoading:d}=e,c=t.clone(),u=r?function(e){const t=[],a=[];return e.data.forEach((e=>{(e.comparison>1?t:a).push(e.tags_key)})),{suspectTags:t,otherTags:a}}(r):null,g=u?u.suspectTags:[],f=u?u.otherTags:[],x=(0,me.Zn)(a),v=[...g,...f],k=x?v.find((e=>e===x)):void 0,C=v.length?v[0]:void 0,j=k??C,[_,T]=(0,m.useState)(j),L=(0,m.useRef)(""),q=(0,m.useCallback)((e=>{if(L.current!==e){const t=(0,w.fK)({...a.query||{},tagKey:e,[De]:void 0});p.browserHistory.replace({pathname:a.pathname,query:t}),T(e),L.current=(0,o.ro)(a.query.tagKey,"")}}),[a.query,a.pathname]);(0,m.useEffect)((()=>{j&&q(j)}),[j,q]),_&&c.additionalConditions.setFilterValues("has",[_]);const B=(0,o.ro)(a.query.query,"");return(0,P.BX)(Xe,{children:[(0,P.tZ)(Ie,{suspectTags:g,otherTags:f,tagSelected:_,changeTag:(e,t)=>((0,S.Z)("performance_views.tags.change_tag",{organization:s,from_tag:_,to_tag:e,is_other_tag:t}),q(e)),isLoading:d}),(0,P.BX)(He,{children:[(0,P.BX)(We,{children:[(0,P.BX)(b.Z,{condensed:!0,children:[(0,P.tZ)(Z.Z,{}),(0,P.tZ)(y.Z,{alignDropdown:"left"})]}),(0,P.tZ)($e,{organization:s,projectIds:c.project,query:B,fields:c.fields,onSearch:e=>{const t=(0,w.fK)({...a.query||{},query:e});p.browserHistory.push({pathname:a.pathname,query:t})}}),(0,P.tZ)(h.Z,{value:i,options:V,onChange:e=>{(0,S.Z)("performance_views.tags.change_aggregate_column",{organization:s,value:e.value}),l(e.value)},triggerProps:{prefix:(0,n.t)("X-Axis")}})]}),(0,P.tZ)(Re,{...e,tagKey:_})]})]})};Ne.displayName="InnerContent";const Ie=e=>{const{suspectTags:t,otherTags:a,changeTag:s,tagSelected:o,isLoading:r}=e;return(0,P.BX)(Ke,{children:[(0,P.BX)(Fe,{children:[(0,n.t)("Suspect Tags"),(0,P.tZ)(k.Z,{position:"top",title:(0,n.t)("Suspect tags are tags that often correspond to slower transaction"),size:"sm"})]}),r?(0,P.tZ)(Me,{children:(0,P.tZ)(v.Z,{mini:!0})}):t.length?t.map((e=>(0,P.BX)(Oe,{children:[(0,P.tZ)(C.Z,{"aria-label":e,checked:o===e,onChange:()=>s(e,!1)}),(0,P.tZ)(Ee,{className:"truncate",children:e})]},e))):(0,P.tZ)("div",{children:(0,n.t)("No tags detected.")}),(0,P.tZ)(T.uI,{}),(0,P.BX)(Fe,{children:[(0,n.t)("Other Tags"),(0,P.tZ)(k.Z,{position:"top",title:(0,n.t)("Other common tags for this transaction"),size:"sm"})]}),r?(0,P.tZ)(Me,{children:(0,P.tZ)(v.Z,{mini:!0})}):a.length?a.map((e=>(0,P.BX)(Oe,{children:[(0,P.tZ)(C.Z,{"aria-label":e,checked:o===e,onChange:()=>s(e,!0)}),(0,P.tZ)(Ee,{className:"truncate",children:e})]},e))):(0,P.tZ)("div",{children:(0,n.t)("No tags detected.")})]})};Ie.displayName="TagsSideBar";const Me=(0,u.Z)("div",{target:"e5m8yi88"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),Oe=(0,u.Z)("label",{target:"e5m8yi87"})("cursor:pointer;margin-bottom:",(0,j.Z)(1),";font-weight:normal;display:grid;grid-auto-flow:column;grid-auto-columns:max-content 1fr;align-items:center;gap:",(0,j.Z)(1),";"),Ee=(0,u.Z)("span",{target:"e5m8yi86"})({name:"1d3w5wq",styles:"width:100%"}),Fe=(0,u.Z)(g.OT,{target:"e5m8yi85"})("margin-bottom:",(0,j.Z)(2),";"),Xe=(0,u.Z)("div",{target:"e5m8yi84"})("margin:0;background-color:",(e=>e.theme.background),";flex-grow:1;@media (min-width: ",(e=>e.theme.breakpoints.medium),"){display:grid;grid-template-columns:auto 66%;align-content:start;gap:",(0,j.Z)(3),";}@media (min-width: ",(e=>e.theme.breakpoints.large),"){grid-template-columns:225px minmax(100px, auto);}"),Ke=(0,u.Z)("div",{target:"e5m8yi83"})({name:"sarfoe",styles:"grid-column:1/2"}),He=(0,u.Z)("div",{target:"e5m8yi82"})({name:"g99mcu",styles:"grid-column:2/4;max-width:100%"}),$e=(0,u.Z)(f.Z,{target:"e5m8yi81"})("@media (min-width: ",(e=>e.theme.breakpoints.small),"){order:1;grid-column:1/6;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){order:initial;grid-column:auto;}"),We=(0,u.Z)("div",{target:"e5m8yi80"})("display:grid;gap:",(0,j.Z)(2),";margin-bottom:",(0,j.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:auto 1fr auto;}"),Qe=ze;function Ue(e){const{location:t,organization:a,projects:n}=e;return(0,P.tZ)(d.ZP,{location:t,organization:a,projects:n,tab:c.Z.Tags,getDocumentTitle:Ge,generateEventView:Ye,childComponent:Qe})}function Ge(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,n.t)("Tags")].join(" — "):[(0,n.t)("Summary"),(0,n.t)("Tags")].join(" — ")}function Ye(e){let{location:t,transactionName:a}=e;const n=`(${(0,o.ro)(t.query.query,"")})`,i=new r.MY(n);return i.setFilterValues("event.type",["transaction"]),i.setFilterValues("transaction",[a]),s.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:a,fields:["transaction.duration"],query:i.formatString(),projects:[]},t)}Ue.displayName="TransactionTags";const Je=(0,l.Z)((0,i.Z)(Ue))}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionTags_index_tsx.cf5e8187f738b7cfd49e35e04c3ad271.js.map