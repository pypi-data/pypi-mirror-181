"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_releases_detail_index_tsx"],{"./app/actionCreators/release.tsx":(e,t,s)=>{s.d(t,{VE:()=>p,aQ:()=>d,dF:()=>c,o7:()=>l});var o=s("../node_modules/@sentry/core/esm/exports.js"),r=s("./app/actionCreators/indicator.tsx"),n=s("./app/locale.tsx"),a=s("./app/stores/releaseStore.tsx"),i=s("./app/types/index.tsx");function l(e,t){const{orgSlug:s,projectSlug:r,releaseVersion:n}=t,i=`/projects/${s}/${r}/releases/${encodeURIComponent(n)}/`;return a.Z.state.releaseLoading[(0,a.p)(r,n)]=!0,a.Z.loadRelease(s,r,n),e.requestPromise(i,{method:"GET"}).then((e=>{a.Z.loadReleaseSuccess(r,n,e)})).catch((e=>{404!==e.status?(a.Z.loadReleaseError(r,n,e),o.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getRelease-action-creator"]),o.Tb(e)}))):a.Z.loadReleaseSuccess(r,n,null)}))}function c(e,t){const{orgSlug:s,projectSlug:r,releaseVersion:n}=t,i=`/organizations/${s}/releases/${encodeURIComponent(n)}/deploys/`;return a.Z.state.deploysLoading[(0,a.p)(r,n)]=!0,a.Z.loadDeploys(s,r,n),e.requestPromise(i,{method:"GET"}).then((e=>{a.Z.loadDeploysSuccess(r,n,e)})).catch((e=>{404!==e.status?(a.Z.loadDeploysError(r,n,e),o.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getReleaseDeploys-action-creator"]),o.Tb(e)}))):a.Z.loadDeploysSuccess(r,n,null)}))}function p(e,t){const{orgSlug:s,projectSlug:o,releaseVersion:l}=t;return a.Z.loadRelease(s,o,l),(0,r.E3)((0,n.t)("Archiving Release…")),e.requestPromise(`/organizations/${s}/releases/`,{method:"POST",data:{status:i.dE.Archived,projects:[],version:l}}).then((e=>{a.Z.loadReleaseSuccess(o,l,e),(0,r.S9)((0,n.t)("Release was successfully archived."))})).catch((e=>{throw a.Z.loadReleaseError(o,l,e),(0,r.Iw)(e.responseJSON?.detail??(0,n.t)("Release could not be be archived.")),e}))}function d(e,t){const{orgSlug:s,projectSlug:o,releaseVersion:l}=t;return a.Z.loadRelease(s,o,l),(0,r.E3)((0,n.t)("Restoring Release…")),e.requestPromise(`/organizations/${s}/releases/`,{method:"POST",data:{status:i.dE.Active,projects:[],version:l}}).then((e=>{a.Z.loadReleaseSuccess(o,l,e),(0,r.S9)((0,n.t)("Release was successfully restored."))})).catch((e=>{throw a.Z.loadReleaseError(o,l,e),(0,r.Iw)(e.responseJSON?.detail??(0,n.t)("Release could not be be restored.")),e}))}},"./app/components/links/listLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>u});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react-router/es/index.js"),n=s("../node_modules/classnames/index.js"),a=s.n(n),i=s("../node_modules/query-string/index.js"),l=s("./app/utils/useRouter.tsx"),c=s("./app/utils/withDomainRequired.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{children:t,className:s,isActive:o,query:n,to:d,activeClassName:u="active",index:h=!1,disabled:g=!1,...Z}=e;const x=(0,l.Z)(),y=n?i.parse(n):void 0,v="string"==typeof d?{pathname:d,query:y}:d,j=(0,c.D)(v),f=o?.(j,h)??x.isActive(j,h);return(0,p.tZ)(m,{className:a()({[u]:f},s),disabled:g,children:(0,p.tZ)(r.Link,{...Z,onlyActiveOnIndex:h,to:g?"":j,children:t})})}d.displayName="ListLink";const u=d,m=(0,o.Z)("li",{shouldForwardProp:e=>"disabled"!==e,target:"er8tqc10"})((e=>e.disabled&&`\n   a {\n    color:${e.theme.disabled} !important;\n    pointer-events: none;\n    :hover {\n      color: ${e.theme.disabled}  !important;\n    }\n   }\n`),";")},"./app/components/navigationButtonGroup.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var o=s("./app/components/button.tsx"),r=s("./app/components/buttonBar.tsx"),n=s("./app/icons/index.tsx"),a=s("./app/locale.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=e=>{let{links:t,hasNext:s=!1,hasPrevious:l=!1,className:c,size:p,onOldestClick:d,onOlderClick:u,onNewerClick:m,onNewestClick:h}=e;return(0,i.BX)(r.ZP,{className:c,merged:!0,children:[(0,i.tZ)(o.ZP,{size:p,to:t[0],disabled:!l,"aria-label":(0,a.t)("Oldest"),icon:(0,i.tZ)(n.sm,{size:"xs"}),onClick:d}),(0,i.tZ)(o.ZP,{size:p,to:t[1],disabled:!l,onClick:u,children:(0,a.t)("Older")}),(0,i.tZ)(o.ZP,{size:p,to:t[2],disabled:!s,onClick:m,children:(0,a.t)("Newer")}),(0,i.tZ)(o.ZP,{size:p,to:t[3],disabled:!s,"aria-label":(0,a.t)("Newest"),icon:(0,i.tZ)(n.pi,{size:"xs"}),onClick:h})]})};l.displayName="NavigationButtonGroup";const c=l},"./app/utils/routeTitle.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});const o=function(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3?arguments[3]:void 0;const r=`${e} - ${t}`,n=o?`${r} - ${o}`:r;return s?`${n} - Sentry`:n}},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});var o=s("./app/components/asyncComponent.tsx"),r=s("./app/components/sentryDocumentTitle.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends o.Z{getTitle(){return""}render(){return(0,n.tZ)(r.Z,{title:this.getTitle(),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/releases/detail/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{ReleaseContext:()=>ue,ReleasesDetailContainer:()=>he,default:()=>xe});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("../node_modules/react/index.js"),a=s("../node_modules/lodash/isEqual.js"),i=s.n(a),l=s("../node_modules/lodash/pick.js"),c=s.n(l),p=s("./app/components/alert.tsx"),d=s("./app/components/asyncComponent.tsx"),u=s("./app/components/loadingIndicator.tsx"),m=s("./app/components/noProjectMessage.tsx"),h=s("./app/components/organizations/pageFilters/container.tsx"),g=s("./app/components/organizations/pageFilters/parse.tsx"),Z=s("./app/actionCreators/modal.tsx"),x=s("./app/components/contextPickerModal.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function v(e){let{noProjectRedirectPath:t,nextPath:s,router:o,projects:r}=e;const n=s.query;let a=!1,i=`${s.pathname}?project=`;if(n){const e=[...Object.entries(n).filter((e=>{let[t,s]=e;return"project"!==t})).map((e=>{let[t,s]=e;return`${t}=${s}`})),"project="].join("&");i=`${s.pathname}?${e}`}return 1===r.length?(o.replace(i+r[0].id),null):((0,Z.openModal)((e=>(0,y.tZ)(x.Z,{...e,needOrg:!1,needProject:!0,nextPath:`${i}:project`,onFinish:e=>{a=!0,o.replace(e)},projectSlugs:r.map((e=>e.slug))})),{onClose(){a||o.push(t)}}),(0,y.tZ)(j,{}))}v.displayName="PickProjectToContinue";const j=(0,r.Z)("div",{target:"e1sj8doz0"})({name:"4wiox3",styles:"height:100vh;width:100%"}),f=v;var b=s("./app/constants/pageFilters.tsx"),w=s("./app/icons/index.tsx"),R=s("./app/locale.tsx"),z=s("./app/styles/organization.tsx"),C=s("./app/styles/space.tsx"),P=s("./app/types/index.tsx"),k=s("./app/utils/formatters.tsx"),S=s("./app/utils/routeAnalytics/withRouteAnalytics.tsx"),$=s("./app/utils/routeTitle.tsx"),D=s("./app/utils/sessions.tsx"),N=s("./app/utils/withOrganization.tsx"),q=s("./app/utils/withPageFilters.tsx"),B=s("./app/views/asyncView.tsx"),_=s("./app/views/releases/utils/index.tsx"),F=s("./app/components/badge.tsx"),T=s("./app/components/breadcrumbs.tsx"),O=s("./app/components/clipboard.tsx"),A=s("./app/components/idBadge/index.tsx"),E=s("./app/components/layouts/thirds.tsx"),M=s("./app/components/links/externalLink.tsx"),U=s("./app/components/links/listLink.tsx"),I=s("./app/components/navTabs.tsx"),V=s("./app/components/tooltip.tsx"),L=s("./app/components/version.tsx"),X=s("../node_modules/react-router/es/index.js"),G=s("./app/actionCreators/release.tsx"),H=s("./app/api.tsx"),J=s("./app/components/buttonBar.tsx"),Q=s("./app/components/confirm.tsx"),K=s("./app/components/dropdownMenuControl.tsx"),Y=s("./app/components/idBadge/projectBadge.tsx"),W=s("./app/components/navigationButtonGroup.tsx"),ee=s("./app/components/textOverflow.tsx"),te=s("./app/utils/analytics.tsx");function se(e){let{location:t,organization:s,projectSlug:o,release:r,releaseMeta:a,refetchData:i}=e;async function l(){try{await(0,G.VE)(new H.KU,{orgSlug:s.slug,projectSlug:o,releaseVersion:r.version}),X.browserHistory.push(`/organizations/${s.slug}/releases/`)}catch{}}async function c(){try{await(0,G.aQ)(new H.KU,{orgSlug:s.slug,projectSlug:o,releaseVersion:r.version}),i()}catch{}}function p(){const e=a.projects.slice(0,5),t=a.projects.length-e.length;return(0,y.BX)(n.Fragment,{children:[e.map((e=>(0,y.tZ)(Y.Z,{project:e,avatarSize:18},e.slug))),t>0&&(0,y.tZ)("span",{children:(0,y.BX)(V.Z,{title:r.projects.slice(5).map((e=>e.slug)).join(", "),children:["+ ",(0,R.tn)("%s other project","%s other projects",t)]})})]})}function d(e){return(0,y.tZ)("h4",{children:(0,y.tZ)(ee.Z,{children:e})})}function u(e){return(0,y.BX)(n.Fragment,{children:[e,(0,y.tZ)(oe,{children:p()}),(0,R.t)("Are you sure you want to do this?")]})}function m(e){return e?{pathname:t.pathname.replace(encodeURIComponent(r.version),e).replace(r.version,e),query:{...t.query,activeRepo:void 0}}:""}function h(e){(0,te.ec)({eventKey:"release_detail.pagination",eventName:"Release Detail: Pagination",organization_id:parseInt(s.id,10),direction:e})}const g=[(0,_.rF)(r)?{key:"restore",label:(0,R.t)("Restore"),onAction:()=>(0,Q._)({onConfirm:c,header:d((0,R._N)("Restore Release [release]",{release:(0,k.ko)(r.version)})),message:u((0,R.tn)("You are restoring this release for the following project:","By restoring this release, you are also restoring it for the following projects:",a.projects.length)),cancelText:(0,R.t)("Nevermind"),confirmText:(0,R.t)("Restore")})}:{key:"archive",label:(0,R.t)("Archive"),onAction:()=>(0,Q._)({onConfirm:l,header:d((0,R._N)("Archive Release [release]",{release:(0,k.ko)(r.version)})),message:u((0,R.tn)("You are archiving this release for the following project:","By archiving this release, you are also archiving it for the following projects:",a.projects.length)),cancelText:(0,R.t)("Nevermind"),confirmText:(0,R.t)("Archive")})}],{nextReleaseVersion:Z,prevReleaseVersion:x,firstReleaseVersion:v,lastReleaseVersion:j}=r.currentProjectMeta;return(0,y.BX)(J.ZP,{gap:1,children:[(0,y.tZ)(W.Z,{size:"sm",hasPrevious:!!x,hasNext:!!Z,links:[m(v),m(x),m(Z),m(j)],onOldestClick:()=>h("oldest"),onOlderClick:()=>h("older"),onNewerClick:()=>h("newer"),onNewestClick:()=>h("newest")}),(0,y.tZ)(K.Z,{size:"sm",items:g,triggerProps:{showChevron:!1,icon:(0,y.tZ)(w.YR,{size:"xs"}),"aria-label":(0,R.t)("Actions")},position:"bottom-end"})]})}se.displayName="ReleaseActions";const oe=(0,r.Z)("div",{target:"ehxwv690"})("margin:",(0,C.Z)(2)," 0 ",(0,C.Z)(2)," ",(0,C.Z)(2),";display:grid;gap:",(0,C.Z)(.5),";img{border:none!important;box-shadow:none!important;}"),re=se,ne=e=>{let{location:t,organization:s,release:o,project:r,releaseMeta:a,refetchData:i}=e;const{version:l,url:p}=o,{commitCount:d,commitFilesChanged:u}=a,m=`/organizations/${s.slug}/releases/${encodeURIComponent(l)}/`,h=[{title:(0,R.t)("Overview"),to:""},{title:(0,y.BX)(n.Fragment,{children:[(0,R.t)("Commits")," ",(0,y.tZ)(pe,{text:(0,k.Du)(d)})]}),to:"commits/"},{title:(0,y.BX)(n.Fragment,{children:[(0,R.t)("Files Changed"),(0,y.tZ)(pe,{text:(0,k.Du)(u)})]}),to:"files-changed/"}];return(0,y.BX)(E.h4,{children:[(0,y.BX)(E.oB,{children:[(0,y.tZ)(T.Z,{crumbs:[{to:`/organizations/${s.slug}/releases/`,label:(0,R.t)("Releases"),preservePageFilters:!0},{label:(0,R.t)("Release Details")}]}),(0,y.tZ)(E.Dx,{children:(0,y.BX)(ae,{children:[(0,y.tZ)(A.Z,{project:r,avatarSize:28,hideName:!0}),(0,y.tZ)(ie,{version:l,anchor:!1,truncate:!0}),(0,y.tZ)(le,{children:(0,y.tZ)(V.Z,{title:l,containerDisplayMode:"flex",children:(0,y.tZ)(O.Z,{value:l,children:(0,y.tZ)(w.vU,{})})})}),!!p&&(0,y.tZ)(le,{children:(0,y.tZ)(V.Z,{title:p,children:(0,y.tZ)(M.Z,{href:p,children:(0,y.tZ)(w.V$,{})})})})]})})]}),(0,y.tZ)(E.kP,{children:(0,y.tZ)(re,{organization:s,projectSlug:r.slug,release:o,releaseMeta:a,refetchData:i,location:t})}),(0,y.tZ)(n.Fragment,{children:(0,y.tZ)(ce,{children:h.map((e=>{return(0,y.tZ)(U.Z,{to:(s=e.to,{pathname:m+s,query:c()(t.query,Object.values(b.nF))}),isActive:()=>(()=>{const e=h.filter((e=>e.to.length)).find((e=>t.pathname.endsWith(e.to)));return e?e.to:h[0].to})()===e.to,children:e.title},e.to);var s}))})})]})};ne.displayName="ReleaseHeader";const ae=(0,r.Z)("div",{target:"e1l92gzd4"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),ie=(0,r.Z)(L.Z,{target:"e1l92gzd3"})("margin-left:",(0,C.Z)(1),";"),le=(0,r.Z)("span",{target:"e1l92gzd2"})("transition:color 0.3s ease-in-out;margin-left:",(0,C.Z)(1),";&,a{color:",(e=>e.theme.gray300),";display:flex;&:hover{cursor:pointer;color:",(e=>e.theme.textColor),";}}"),ce=(0,r.Z)(I.Z,{target:"e1l92gzd1"})({name:"13jhhqe",styles:"margin-bottom:0;width:100%"}),pe=(0,r.Z)(F.Z,{target:"e1l92gzd0"})("@media (max-width: ",(e=>e.theme.breakpoints.small),"){display:none;}"),de=ne,ue=(0,n.createContext)({});class me extends B.Z{constructor(){super(...arguments),(0,o.Z)(this,"shouldReload",!0)}getTitle(){const{params:e,organization:t,selection:s}=this.props,{release:o}=this.state,r=o?.projects.find((e=>e.id===s.projects[0]));return(0,$.Z)((0,R.t)("Release %s",(0,k.ko)(e.release)),t.slug,!1,r?.slug)}getDefaultState(){return{...super.getDefaultState(),deploys:[],sessions:null}}componentDidUpdate(e,t){const{organization:s,params:o,location:r}=this.props;e.params.release===o.release&&e.organization.slug===s.slug&&i()(this.pickLocationQuery(e.location),this.pickLocationQuery(r))||super.componentDidUpdate(e,t)}getEndpoints(){const{organization:e,location:t,params:s,releaseMeta:o}=this.props,r=`/organizations/${e.slug}/releases/${encodeURIComponent(s.release)}/`,n=[["release",r,{query:{adoptionStages:1,...(0,g.fK)(this.pickLocationQuery(t))}}]];return o.deployCount>0&&n.push(["deploys",`${r}deploys/`]),n.push(["sessions",`/organizations/${e.slug}/sessions/`,{query:{project:t.query.project,environment:t.query.environment??[],query:(0,_.me)(s.release),field:"sum(session)",statsPeriod:"90d",interval:"1d"}},{allowError:e=>400===e.status}]),n}pickLocationQuery(e){return c()(e.query,[...Object.values(b.nF),...Object.values(b.V)])}renderError(){return Object.values(this.state.errors).find((e=>404===e?.status||403===e?.status))?(0,y.tZ)(z.JH,{children:(0,y.tZ)(p.Z,{type:"error",showIcon:!0,children:(0,R.t)("This release may not be in your selected project.")})}):super.renderError(...arguments)}renderLoading(){return(0,y.tZ)(z.JH,{children:(0,y.tZ)(u.Z,{})})}renderBody(){const{organization:e,location:t,selection:s,releaseMeta:o}=this.props,{release:r,deploys:n,sessions:a,reloading:i}=this.state,l=r?.projects.find((e=>e.id===s.projects[0])),c=(0,_.C8)(r);return l&&r?(0,y.tZ)(m.Z,{organization:e,children:(0,y.BX)(ge,{children:[(0,y.tZ)(de,{location:t,organization:e,release:r,project:l,releaseMeta:o,refetchData:this.fetchData}),(0,y.tZ)(ue.Provider,{value:{release:r,project:l,deploys:n,releaseMeta:o,refetchData:this.fetchData,hasHealthData:(0,D.sA)(a?.groups,P.kI.SESSIONS)>0,releaseBounds:c},children:this.props.children})]})}):i?(0,y.tZ)(u.Z,{}):null}}class he extends d.Z{constructor(){super(...arguments),(0,o.Z)(this,"shouldReload",!0)}getEndpoints(){const{organization:e,params:t}=this.props;return[["releaseMeta",`/organizations/${e.slug}/releases/${encodeURIComponent(t.release)}/meta/`]]}componentDidMount(){this.removeGlobalDateTimeFromUrl(),this.props.setRouteAnalyticsParams({release:this.props.params.release})}componentDidUpdate(e,t){const{organization:s,params:o}=this.props;this.removeGlobalDateTimeFromUrl(),e.params.release===o.release&&e.organization.slug===s.slug||(this.props.setRouteAnalyticsParams({release:this.props.params.release}),super.componentDidUpdate(e,t))}removeGlobalDateTimeFromUrl(){const{router:e,location:t}=this.props,{start:s,end:o,statsPeriod:r,utc:n,...a}=t.query;(s||o||r||n)&&e.replace({...t,query:a})}renderError(){return Object.values(this.state.errors).find((e=>404===e?.status))?(0,y.tZ)(z.JH,{children:(0,y.tZ)(p.Z,{type:"error",showIcon:!0,children:(0,R.t)("This release could not be found.")})}):super.renderError(...arguments)}isProjectMissingInUrl(){const e=this.props.location.query.project;return!e||"string"!=typeof e}renderLoading(){return(0,y.tZ)(z.JH,{children:(0,y.tZ)(u.Z,{})})}renderProjectsFooterMessage(){return(0,y.BX)(Ze,{children:[(0,y.tZ)(w.aU,{size:"xs"})," ",(0,R.t)("Only projects with this release are visible.")]})}renderBody(){const{organization:e,params:t,router:s}=this.props,{releaseMeta:o}=this.state;if(!o)return null;const{projects:r}=o;return this.isProjectMissingInUrl()?(0,y.tZ)(f,{projects:r.map((e=>{let{id:t,slug:s}=e;return{id:String(t),slug:s}})),router:s,nextPath:{pathname:`/organizations/${e.slug}/releases/${encodeURIComponent(t.release)}/`},noProjectRedirectPath:`/organizations/${e.slug}/releases/`}):(0,y.tZ)(h.Z,{shouldForceProject:1===r.length,forceProject:1===r.length?{...r[0],id:String(r[0].id)}:void 0,specificProjectSlugs:r.map((e=>e.slug)),children:(0,y.tZ)(me,{...this.props,releaseMeta:o})})}}const ge=(0,r.Z)(z.JH,{target:"eii7qn31"})({name:"1hcx8jb",styles:"padding:0"}),Ze=(0,r.Z)("div",{target:"eii7qn30"})("display:grid;align-items:center;grid-template-columns:min-content 1fr;gap:",(0,C.Z)(1),";"),xe=(0,S.Z)((0,q.Z)((0,N.Z)(he)))}}]);
//# sourceMappingURL=../sourcemaps/app_views_releases_detail_index_tsx.a91fe154e74ef71f13025742e5735c32.js.map