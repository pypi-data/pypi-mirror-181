"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamMembers_tsx"],{"./app/components/roleSelectControl.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("./app/components/forms/controls/selectControl.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{roles:t,disableUnallowed:s,...r}=e;return(0,o.tZ)(a.Z,{options:t?.map((e=>({value:e.id,label:e.name,disabled:s&&!e.allowed||e.isRetired,details:(0,o.tZ)(m,{children:e.desc})}))),showDividers:!0,...r})}i.displayName="RoleSelectControl";const n=i,m=(0,r.Z)("span",{target:"e1cjlayn0"})({name:"vad6xm",styles:"display:inline-block;width:20rem"})},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var r=s("./app/components/asyncComponent.tsx"),a=s("./app/components/sentryDocumentTitle.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends r.Z{getTitle(){return""}render(){return(0,o.tZ)(a.Z,{title:this.getTitle(),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/settings/organizationTeams/roleOverwriteWarning.tsx":(e,t,s)=>{s.d(t,{Sk:()=>m,d8:()=>d,pu:()=>l});var r=s("./app/components/panels/index.tsx"),a=s("./app/components/tooltip.tsx"),o=s("./app/icons/index.tsx"),i=s("./app/locale.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const m=e=>d(e)?(0,n.tZ)(a.Z,{title:c(e),children:(0,n.tZ)(o.aU,{size:"sm",color:"gray300"})}):null;m.displayName="RoleOverwriteIcon";const l=e=>d(e)?(0,n.tZ)(r.aU,{children:c(e)}):null;function d(e){const{orgRole:t,orgRoleList:s,teamRoleList:r}=e,a=s.find((e=>e.id===t));return r.findIndex((e=>e.id===a?.minimumTeamRole))>0}function c(e){const{orgRole:t,orgRoleList:s,teamRoleList:r,isSelf:a}=e,o=s.find((e=>e.id===t)),m=r.find((e=>e.id===o?.minimumTeamRole));return o&&m?(0,i._N)("[selfNoun] organization role as [article] [orgRole] has granted [selfPronoun] a minimum team-level role of [teamRole]",{selfNoun:a?"Your":"This user's",selfPronoun:a?"you":"them",article:"AEIOU".includes(o.name[0])?"an":"a",orgRole:(0,n.tZ)("strong",{children:o.name}),teamRole:(0,n.tZ)("strong",{children:m.name})}):""}l.displayName="RoleOverwritePanelAlert"},"./app/views/settings/organizationTeams/teamMembers.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),i=s("../node_modules/lodash/debounce.js"),n=s.n(i),m=s("./app/actionCreators/indicator.tsx"),l=s("./app/actionCreators/modal.tsx"),d=s("./app/actionCreators/teams.tsx"),c=s("./app/components/avatar/userAvatar.tsx"),p=s("./app/components/dropdownAutoComplete/index.tsx"),u=s("./app/components/dropdownButton.tsx"),h=s("./app/components/emptyMessage.tsx"),g=s("./app/components/links/link.tsx"),b=s("./app/components/loadingError.tsx"),x=s("./app/components/loadingIndicator.tsx"),Z=s("./app/components/pagination.tsx"),f=s("./app/components/panels/index.tsx"),w=s("./app/icons/index.tsx"),v=s("./app/locale.tsx"),y=s("./app/styles/space.tsx"),M=s("./app/utils/withApi.tsx"),R=s("./app/utils/withConfig.tsx"),I=s("./app/utils/withOrganization.tsx"),S=s("./app/views/asyncView.tsx"),T=s("./app/components/button.tsx"),z=s("./app/components/idBadge/index.tsx"),C=s("./app/components/roleSelectControl.tsx"),k=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),j=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const B=e=>{const{organization:t,member:s,user:r,hasWriteAccess:a,removeMember:o,updateMemberRole:i}=e;return(0,j.BX)(O,{children:[(0,j.tZ)("div",{children:(0,j.tZ)(z.Z,{avatarSize:36,member:s,useLink:!0,orgId:t.slug})}),(0,j.tZ)("div",{children:(0,j.tZ)(_,{hasWriteAccess:a,updateMemberRole:i,organization:t,member:s})}),(0,j.tZ)("div",{children:(0,j.tZ)(A,{hasWriteAccess:a,onClick:()=>o(s),member:s,user:r})})]},s.id)};B.displayName="TeamMembersRow";const _=e=>{const{hasWriteAccess:t,organization:s,member:r,updateMemberRole:a}=e,{orgRoleList:o,teamRoleList:i,features:n}=s;if(!n.includes("team-roles"))return null;const{orgRole:m}=r,l=o.find((e=>e.id===m)),d=r.teamRole||l?.minimumTeamRole,c=i.find((e=>e.id===d))||i[0];return!t||(0,k.d8)({orgRole:m,orgRoleList:o,teamRoleList:i})?(0,j.BX)(L,{children:[c.name,(0,j.tZ)(q,{children:(0,j.tZ)(k.Sk,{orgRole:m,orgRoleList:o,teamRoleList:i})})]}):(0,j.tZ)(N,{children:(0,j.tZ)(C.Z,{roles:i,value:c.id,onChange:e=>a(r,e.value),disableUnallowed:!0})})};_.displayName="TeamRoleSelect";const A=e=>{const{member:t,user:s,hasWriteAccess:r,onClick:a}=e,o=t.email===s.email,i=r||o;return i?(0,j.tZ)(T.ZP,{size:"xs",disabled:!i,icon:(0,j.tZ)(w.JZ,{size:"xs",isCircled:!0}),onClick:a,"aria-label":(0,v.t)("Remove"),children:(0,v.t)("Remove")}):null};A.displayName="RemoveButton";const L=(0,a.Z)("div",{target:"e130n5f43"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),q=(0,a.Z)("div",{target:"e130n5f42"})("height:",(0,y.Z)(2),";margin-left:",(0,y.Z)(1),";"),N=(0,a.Z)("div",{target:"e130n5f41"})({name:"5b6t4c",styles:"display:flex;flex-direction:row;align-items:center;>div:first-child{flex-grow:1;}"}),O=(0,a.Z)(f.Lv,{target:"e130n5f40"})("display:grid;grid-template-columns:minmax(120px, 4fr) minmax(120px, 2fr) minmax(100px, 1fr);gap:",(0,y.Z)(2),";align-items:center;>div:last-child{margin-left:auto;}"),D=B;class P extends S.Z{constructor(){super(...arguments),(0,r.Z)(this,"debouncedFetchMembersRequest",n()((e=>this.setState({dropdownBusy:!0},(()=>this.fetchMembersRequest(e)))),200)),(0,r.Z)(this,"fetchMembersRequest",(async e=>{const{params:t,api:s}=this.props,{orgId:r}=t;try{const t=await s.requestPromise(`/organizations/${r}/members/`,{query:{query:e}});this.setState({orgMembers:t,dropdownBusy:!1})}catch(e){(0,m.Iw)((0,v.t)("Unable to load organization members."),{duration:2e3}),this.setState({dropdownBusy:!1})}})),(0,r.Z)(this,"addTeamMember",(e=>{const{params:t}=this.props,{orgMembers:s,teamMembers:r}=this.state;this.setState({loading:!0}),this.debouncedFetchMembersRequest(""),(0,d.um)(this.props.api,{orgId:t.orgId,teamId:t.teamId,memberId:e.value},{success:()=>{const t=s.find((t=>t.id===e.value));void 0!==t&&(this.setState({loading:!1,error:!1,teamMembers:r.concat([t])}),(0,m.S9)((0,v.t)("Successfully added member to team.")))},error:()=>{this.setState({loading:!1}),(0,m.Iw)((0,v.t)("Unable to add team member."))}})})),(0,r.Z)(this,"removeTeamMember",(e=>{const{params:t}=this.props,{teamMembers:s}=this.state;(0,d.s)(this.props.api,{orgId:t.orgId,teamId:t.teamId,memberId:e.id},{success:()=>{this.setState({teamMembers:s.filter((t=>t.id!==e.id))}),(0,m.S9)((0,v.t)("Successfully removed member from team."))},error:()=>(0,m.Iw)((0,v.t)("There was an error while trying to remove a member from the team."))})})),(0,r.Z)(this,"updateTeamMemberRole",((e,t)=>{const{orgId:s,teamId:r}=this.props.params,a=`/organizations/${s}/members/${e.id}/teams/${r}/`;this.props.api.request(a,{method:"PUT",data:{teamRole:t},success:t=>{const s=[...this.state.teamMembers],r=s.findIndex((t=>t.id===e.id));s[r]={...e,teamRole:t.teamRole},this.setState({teamMembers:s}),(0,m.S9)((0,v.t)("Successfully changed role for team member."))},error:()=>{(0,m.Iw)((0,v.t)("There was an error while trying to change the roles for a team member."))}})})),(0,r.Z)(this,"handleMemberFilterChange",(e=>{this.setState({dropdownBusy:!0}),this.debouncedFetchMembersRequest(e.target.value)}))}getDefaultState(){return{...super.getDefaultState(),loading:!0,error:!1,dropdownBusy:!1,teamMembers:[],orgMembers:[]}}componentDidMount(){this.fetchMembersRequest("")}getEndpoints(){const{params:e}=this.props;return[["teamMembers",`/teams/${e.orgId}/${e.teamId}/members/`,{},{paginate:!0}]]}renderDropdown(e){const{organization:t,params:s}=this.props,{orgMembers:r}=this.state,a=new Set(this.state.teamMembers.map((e=>e.id))),o=!!t?.openMembership||e,i=(r||[]).filter((e=>!a.has(e.id))).map((e=>({searchKey:`${e.name} ${e.email}`,value:e.id,label:(0,j.BX)(U,{children:[(0,j.tZ)($,{user:e,size:24,className:"avatar"}),(0,j.tZ)(W,{children:e.name||e.email})]})}))),n=(0,j.BX)(F,{children:[(0,v.t)("Members"),(0,j.tZ)(X,{to:"",onClick:()=>(0,l.openInviteMembersModal)({source:"teams"}),"data-test-id":"invite-member",children:(0,v.t)("Invite Member")})]});return(0,j.tZ)(p.Z,{items:i,alignMenu:"right",onSelect:o?this.addTeamMember:e=>(0,l.openTeamAccessRequestModal)({teamId:s.teamId,orgId:s.orgId,memberId:e.value}),menuHeader:n,emptyMessage:(0,v.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:()=>this.debouncedFetchMembersRequest(""),children:e=>{let{isOpen:t}=e;return(0,j.tZ)(u.Z,{isOpen:t,size:"xs","data-test-id":"add-member",children:(0,v.t)("Add Member")})}})}render(){if(this.state.loading)return(0,j.tZ)(x.Z,{});if(this.state.error)return(0,j.tZ)(b.Z,{onRetry:this.fetchData});const{organization:e,config:t}=this.props,{teamMembersPageLinks:s}=this.state,{access:r}=e,a=r.includes("org:write")||r.includes("team:admin");return(0,j.BX)(o.Fragment,{children:[(0,j.BX)(f.s_,{children:[(0,j.BX)(f.V9,{hasButtons:!0,children:[(0,j.tZ)("div",{children:(0,v.t)("Members")}),(0,j.tZ)("div",{style:{textTransform:"none"},children:this.renderDropdown(a)})]}),this.state.teamMembers.length?this.state.teamMembers.map((s=>(0,j.tZ)(D,{hasWriteAccess:a,member:s,organization:e,removeMember:this.removeTeamMember,updateMemberRole:this.updateTeamMemberRole,user:t.user},s.id))):(0,j.tZ)(h.Z,{icon:(0,j.tZ)(w.qO,{size:"xl"}),size:"large",children:(0,v.t)("This team has no members")})]}),(0,j.tZ)(Z.Z,{pageLinks:s})]})}}P.displayName="TeamMembers";const U=(0,a.Z)("div",{target:"ekipw4c4"})("display:grid;grid-template-columns:max-content 1fr;gap:",(0,y.Z)(.5),";align-items:center;"),W=(0,a.Z)("div",{target:"ekipw4c3"})("font-size:",(e=>e.theme.fontSizeSmall),";",(e=>e.theme.overflowEllipsis),";"),$=(0,a.Z)((e=>(0,j.tZ)(c.Z,{...e})),{target:"ekipw4c2"})({name:"1dy9mco",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em"}),F=(0,a.Z)("div",{target:"ekipw4c1"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,y.Z)(1)," 0;font-size:",(e=>e.theme.fontSizeExtraSmall),";text-transform:uppercase;"),X=(0,a.Z)(g.Z,{target:"ekipw4c0"})({name:"kxbue8",styles:"text-transform:none"}),E=(0,R.Z)((0,M.Z)((0,I.Z)(P)))}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamMembers_tsx.618a1d248b774ca0075eb49aa9a2828d.js.map