"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_create_tsx"],{"./app/components/acl/access.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),i=s("./app/components/alert.tsx"),r=s("./app/locale.tsx"),l=s("./app/utils/isRenderFunc.tsx"),a=s("./app/utils/withConfig.tsx"),c=s("./app/utils/withOrganization.tsx");const d=(0,s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js").tZ)(i.Z,{type:"error",showIcon:!0,children:(0,r.t)("You do not have sufficient permissions to access this.")});class u extends o.Component{render(){const{organization:e,config:t,access:s,requireAll:n,isSuperuser:o,renderNoAccessMessage:i,children:r}=this.props,{access:a}=e||{access:[]},c=!s||s[n?"every":"some"]((e=>a.includes(e))),u=!(!t.user||!t.user.isSuperuser),p={hasAccess:c,hasSuperuser:u},m=c&&(!o||u);return m||"function"!=typeof i?!m&&i?d:(0,l.l)(r)?r(p):m?r:null:i(p)}}u.displayName="Access",(0,n.Z)(u,"defaultProps",{renderNoAccessMessage:!1,isSuperuser:!1,requireAll:!0,access:[]});const p=(0,c.Z)((0,a.Z)(u))},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var n=s("./app/components/asyncComponent.tsx"),o=s("./app/components/sentryDocumentTitle.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class r extends n.Z{getTitle(){return""}render(){return(0,i.tZ)(o.Z,{title:this.getTitle(),children:this.renderComponent()})}}r.displayName="AsyncView"},"./app/views/monitors/create.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/react-router/es/index.js"),r=s("./app/components/layouts/thirds.tsx"),l=s("./app/locale.tsx"),a=s("./app/utils/withDomainRequired.tsx"),c=s("./app/utils/withOrganization.tsx"),d=s("./app/views/asyncView.tsx"),u=s("./app/views/monitors/monitorForm.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class m extends d.Z{constructor(){super(...arguments),(0,n.Z)(this,"onSubmitSuccess",(e=>{const t=(0,a.D)(`/organizations/${this.orgSlug}/monitors/${e.id}/`);i.browserHistory.push(t)}))}getTitle(){return`Monitors - ${this.orgSlug}`}get orgSlug(){return this.props.organization.slug}renderBody(){return(0,p.tZ)(r.uT,{children:(0,p.BX)(r.or,{fullWidth:!0,children:[(0,p.tZ)("h1",{children:(0,l.t)("Set Up Cron Monitor")}),(0,p.tZ)(g,{children:(0,l.t)("Sentry will tell you if your recurring jobs are running on schedule, failing, or succeeding.")}),(0,p.tZ)(u.Z,{apiMethod:"POST",apiEndpoint:`/organizations/${this.orgSlug}/monitors/`,onSubmitSuccess:this.onSubmitSuccess,submitLabel:(0,l.t)("Next Steps")})]})})}}const h=(0,c.Z)(m),g=(0,o.Z)("p",{target:"e9na96i0"})("color:",(e=>e.theme.subText),";max-width:760px;")},"./app/views/monitors/monitorForm.tsx":(e,t,s)=>{s.d(t,{Z:()=>_});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),i=s("../node_modules/mobx-react-lite/es/index.js"),r=s("./app/components/acl/access.tsx"),l=s("./app/components/forms/field/index.tsx"),a=s("./app/components/forms/fields/numberField.tsx"),c=s("./app/components/forms/fields/selectField.tsx"),d=s("./app/components/forms/fields/textField.tsx"),u=s("./app/components/forms/form.tsx"),p=s("./app/components/forms/model.tsx"),m=s("./app/components/panels/index.tsx"),h=s("./app/components/textCopyInput.tsx"),g=s("./app/locale.tsx"),f=s("./app/utils/withPageFilters.tsx"),b=s("./app/utils/withProjects.tsx"),x=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const y=[{value:"crontab",label:"Crontab"},{value:"interval",label:"Interval"}],Z="cron_job",j=[{value:"minute",label:"minute(s)"},{value:"hour",label:"hour(s)"},{value:"day",label:"day(s)"},{value:"week",label:"week(s)"},{value:"month",label:"month(s)"},{value:"year",label:"year(s)"}];function w(e,t){return t.fields.toJSON().reduce(((e,t)=>{let[s,n]=t;return 0!==s.indexOf("config.")?(e[s]=n,e):(e.config||(e.config={}),"config.schedule.frequency"!==s&&"config.schedule.interval"!==s||Array.isArray(e.config.schedule)||(e.config.schedule=[null,null]),"config.schedule.frequency"===s?e.config.schedule[0]=parseInt(n,10):"config.schedule.interval"===s?e.config.schedule[1]=n:e.config[s.substr(7)]=n,e)}),{})}class v extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"form",new p.Z({transformData:w}))}formDataFromConfig(e,t){const s={};return"cron_job"===e&&(s["config.schedule_type"]=t.schedule_type,s["config.checkin_margin"]=t.checkin_margin,s["config.max_runtime"]=t.max_runtime,"interval"===t.schedule_type?(s["config.schedule.frequency"]=t.schedule[0],s["config.schedule.interval"]=t.schedule[1]):s["config.schedule"]=t.schedule),s}render(){const{monitor:e,submitLabel:t}=this.props,s=this.props.selection.projects[0],n=s?this.props.projects.find((e=>e.id===s+"")):null;return(0,x.tZ)(r.Z,{access:["project:write"],children:s=>{let{hasAccess:r}=s;return(0,x.BX)(u.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:this.props.apiEndpoint,apiMethod:this.props.apiMethod,model:this.form,initialData:e?{name:e.name,type:e.type??Z,project:e.project.slug,...this.formDataFromConfig(e.type,e.config)}:{project:n?n.slug:null,type:Z},onSubmitSuccess:this.props.onSubmitSuccess,submitLabel:t,children:[(0,x.BX)(m.s_,{children:[(0,x.tZ)(m.V9,{children:(0,g.t)("Details")}),(0,x.BX)(m.N,{children:[e&&(0,x.tZ)(l.Z,{label:(0,g.t)("ID"),children:(0,x.tZ)("div",{className:"controls",children:(0,x.tZ)(h.ZP,{children:e.id})})}),(0,x.tZ)(c.Z,{name:"project",label:(0,g.t)("Project"),disabled:!r,options:this.props.projects.filter((e=>e.isMember)).map((e=>({value:e.slug,label:e.slug}))),help:(0,g.t)("Select the project which contains the recurring job you'd like to monitor."),required:!0}),(0,x.tZ)(d.Z,{name:"name",placeholder:(0,g.t)("My Cron Job"),label:(0,g.t)("Name your cron monitor"),disabled:!r,required:!0})]})]}),(0,x.BX)(m.s_,{children:[(0,x.tZ)(m.V9,{children:(0,g.t)("Config")}),(0,x.BX)(m.N,{children:[(0,x.tZ)(a.Z,{name:"config.max_runtime",label:(0,g.t)("Max Runtime"),disabled:!r,help:(0,g.t)("Set the number of minutes a recurring job is allowed to run before it's considered failed"),placeholder:"e.g. 30"}),(0,x.tZ)(c.Z,{name:"config.schedule_type",label:(0,g.t)("Schedule Type"),disabled:!r,options:y,required:!0}),(0,x.tZ)(i.Qj,{children:()=>{switch(this.form.getValue("config.schedule_type")){case"crontab":return(0,x.BX)(o.Fragment,{children:[(0,x.tZ)(d.Z,{name:"config.schedule",label:(0,g.t)("Schedule"),disabled:!r,placeholder:"*/5 * * * *",required:!0,help:(0,g._N)("Any schedule changes will be applied to the next check-in. See [link:Wikipedia] for crontab syntax.",{link:(0,x.tZ)("a",{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,x.tZ)(a.Z,{name:"config.checkin_margin",label:(0,g.t)("Check-in Margin"),disabled:!r,help:(0,g.t)("The max error margin (in minutes) before a check-in is considered missed. If you don't expect your job to start immediately at the scheduled time, expand this margin to account for delays."),placeholder:"e.g. 30"})]});case"interval":return(0,x.BX)(o.Fragment,{children:[(0,x.tZ)(a.Z,{name:"config.schedule.frequency",label:(0,g.t)("Frequency"),disabled:!r,placeholder:"e.g. 1",help:(0,g.t)("The amount of intervals that pass between executions of the cron job."),required:!0}),(0,x.tZ)(c.Z,{name:"config.schedule.interval",label:(0,g.t)("Interval"),disabled:!r,options:j,help:(0,g.t)("The interval on which the frequency will be applied. 1 time every X amount of (minutes, hours, days)"),required:!0}),(0,x.tZ)(a.Z,{name:"config.checkin_margin",label:(0,g.t)("Check-in Margin"),disabled:!r,help:(0,g.t)("The max error margin (in minutes) before a check-in is considered missed. If you don't expect your job to start immediately at the scheduled time, expand this margin to account for delays."),placeholder:"e.g. 30"})]});default:return null}}})]})]})]})}})}}v.displayName="MonitorForm";const _=(0,f.Z)((0,b.Z)(v))}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_create_tsx.1d7d88e17107333cc494c378b3a85340.js.map