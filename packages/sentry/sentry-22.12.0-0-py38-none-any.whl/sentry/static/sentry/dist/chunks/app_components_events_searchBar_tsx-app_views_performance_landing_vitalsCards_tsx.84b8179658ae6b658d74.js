"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>O}),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/react/index.js"),a=s("../node_modules/@sentry/core/esm/exports.js"),i=s("../node_modules/lodash/assign.js"),n=s.n(i),o=s("../node_modules/lodash/flatten.js"),l=s.n(o),d=s("../node_modules/lodash/memoize.js"),c=s.n(d),p=s("../node_modules/lodash/omit.js"),u=s.n(p),m=s("./app/actionCreators/tags.tsx"),h=s("./app/components/smartSearchBar/index.tsx"),g=s("./app/constants/index.tsx"),v=s("./app/types/index.tsx"),x=s("./app/utils.tsx"),f=s("./app/utils/discover/fields.tsx"),y=s("./app/utils/fields/index.ts"),Z=s("./app/utils/measurements/measurements.tsx"),b=s("./app/utils/useApi.tsx"),w=s("./app/utils/withTags.tsx"),j=s("./app/views/dashboardsV2/utils.tsx"),k=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const S=new RegExp(`^${g.c$}|\\${g.ir}`,"g"),_=new Set(Object.keys(f.wZ)),T=Object.keys(f.wZ).reduce(((e,t)=>(e[t]={...f.wZ[t],kind:y.IV.FIELD},e)),{}),N=u()(T,f.J8),P=f.$4.reduce(((e,t)=>(e[t]={name:t,kind:y.IV.METRICS},e)),{}),C=Object.keys(f.jg).reduce(((e,t)=>(e[t]={...f.jg[t],kind:y.IV.FIELD},e)),{});function V(e){const{maxSearchItems:t,organization:s,tags:i,omitTags:o,fields:d,projectIds:p,includeSessionTagsValues:g,maxMenuHeight:w,customMeasurements:V}=e,O=(0,b.Z)(),E=(0,r.useRef)(!1),I=(0,r.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(_.has(t.field)||(0,f.GO)(t.field)||(0,j.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:y.IV.FUNCTION}),e)),{}):[])(d)),[d]),A=(0,r.useMemo)((()=>Object.keys(i).reduce(((e,t)=>(e[t]={...i[t],kind:y.IV.TAG},e)),{})),[i]);(0,r.useEffect)((()=>{M.cache.clear?.()}),[p]);const M=c()(((e,t,r)=>{const a=p?.map(String);return(0,f.h1)(e.key)||(0,f.Xr)(e.key)?Promise.resolve([]):(0,m.Fo)({api:O,orgSlug:s.slug,tagKey:e.key,search:t,projectIds:a,endpointParams:r,includeTransactions:!0,includeSessions:g}).then((e=>l()(e.filter((e=>{let{name:t}=e;return(0,x.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`})),H=e=>{let t;!E.current&&Object.keys(i).length>0&&(t=a.Yr({name:"SearchBar.getTagList"}),E.current=!0);const r=((e,t)=>{const s=Object.keys(e).reduce(((t,s)=>(t[s]={...e[s],kind:y.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,s)=>(e[s]={...t[s],kind:y.IV.MEASUREMENT},e)),s):s})(e,V),l=s.features.includes("performance-view")?Object.assign({},r,I,P,T):Object.assign({},N);n()(l,A,T,C),l.has={key:y.Sh.HAS,name:"Has property",values:Object.keys(l).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:y.IV.FIELD};const d=o&&o.length>0?u()(l,o):l;if(t){const e=Object.keys(d).length;t.setTag("tags.totalCount",e);const s=[1,5,10,20,50,100,200,300,400,500,600,700,800,900,1e3,1e4].find((t=>e<=t));t.setTag("tags.totalCount.grouped",`<=${s}`),t.finish()}return d};return(0,k.tZ)(Z.Z,{children:s=>{let{measurements:r}=s;return(0,k.tZ)(h.Z,{hasRecentSearches:!0,savedSearchType:v.L4.EVENT,onGetTagValues:M,supportedTags:H(r),prepareQuery:e=>e.replace(S,""),maxSearchItems:t,excludedTags:["environment"],maxMenuHeight:w??300,customPerformanceMetrics:V,...e})}})}V.displayName="SearchBar";const O=(0,w.Z)(V)},"./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var r=s("../node_modules/lodash/pick.js"),a=s.n(r),i=s("./app/utils/discover/genericDiscoverQuery.tsx"),n=s("./app/utils/performance/constants.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){const{eventView:t,vitals:s}=e,r=t?.getEventsAPIPayload(e.location);return{vital:s,...a()(r,["query",...Object.values(n.s)])}}function d(e){return(0,o.tZ)(i.ZP,{getRequestPayload:l,route:"events-vitals",...e,children:t=>{let{tableData:s,...r}=t;return e.children({vitalsData:s,...r})}})}d.displayName="VitalsCardsDiscoverQuery";const c=d},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=s("../node_modules/react/index.js"),i=s("./app/stores/tagStore.tsx"),n=s("./app/utils/getDisplayName.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends a.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{tags:i.Z.getState()}),(0,r.Z)(this,"unsubscribe",i.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,o.tZ)(e,{tags:t??this.state.tags,...s})}}return t.displayName="WithTags",(0,r.Z)(t,"displayName",`withTags(${(0,n.Z)(e)})`),t}},"./app/views/performance/landing/vitalsCards.tsx":(e,t,s)=>{s.d(t,{JO:()=>F});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),i=s("../node_modules/@sentry/core/esm/exports.js"),n=s("./app/components/card.tsx"),o=s("./app/components/charts/eventsRequest.tsx"),l=s("./app/components/charts/styles.tsx"),d=s("./app/components/charts/utils.tsx"),c=s("./app/components/emptyStateWarning.tsx"),p=(s("./app/components/links/link.tsx"),s("./app/components/placeholder.tsx")),u=s("./app/components/questionTooltip.tsx"),m=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),h=s("../node_modules/react-sparklines/build/index.js"),g=s("../node_modules/prop-types/index.js");class v extends h.Sparklines{}(0,m.Z)(v,"propTypes",{children:g.node,data:g.array,limit:g.number,width:g.number,height:g.number,svgWidth:g.number,svgHeight:g.number,preserveAspectRatio:g.string,margin:g.number,style:g.object,min:g.number,max:g.number,onMouseMove:g.func});var x=s("./app/components/tooltip.tsx"),f=s("./app/locale.tsx"),y=s("./app/styles/space.tsx"),Z=s("./app/utils.tsx"),b=s("./app/utils/dates.tsx"),w=s("./app/utils/discover/discoverQuery.tsx"),j=s("./app/utils/discover/fields.tsx"),k=s("./app/utils/fields/index.ts"),S=(s("./app/utils/performance/vitals/constants.tsx"),s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),s("./app/utils/queryString.tsx"),s("./app/utils/theme.tsx")),_=s("./app/utils/toArray.tsx"),T=s("./app/utils/useApi.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const P=e=>(0,N.tZ)(C,{barHeight:e.barHeight,fractions:e.colorStops.map((e=>{let{percent:t}=e;return t})),children:e.colorStops.map((e=>{const t=(0,N.tZ)(V,{color:e.color},e.color);return e.renderBarStatus?.(t,e.color)??t}))});P.displayName="ColorBar";const C=(0,r.Z)("div",{target:"etd41501"})("height:",(e=>e.barHeight?`${e.barHeight}px`:"16px"),";width:100%;overflow:hidden;position:relative;background:",(e=>e.theme.gray100),";display:grid;grid-template-columns:",(e=>e.fractions.map((e=>`${e}fr`)).join(" ")),";margin-bottom:",(e=>e.barHeight?"":(0,y.Z)(1)),";border-radius:2px;"),V=(0,r.Z)("div",{target:"etd41500"})("background-color:",(e=>e.theme[e.color]??e.color),";"),O=P;var E=s("./app/views/performance/vitalDetail/utils.tsx"),I=s("./app/utils/formatters.tsx");function A(e,t){const s=Array.isArray(e)||e===k.Zl.CLS?"":"ms";switch(t){case E.SP.POOR:return Array.isArray(e)?(0,f.t)("Poor"):(0,f._N)("(>[threshold][unit])",{threshold:E.eE[e],unit:s});case E.SP.MEH:return Array.isArray(e)?(0,f.t)("Meh"):(0,f._N)("(>[threshold][unit])",{threshold:E.MN[e],unit:s});case E.SP.GOOD:return Array.isArray(e)?(0,f.t)("Good"):(0,f._N)("(<=[threshold][unit])",{threshold:E.MN[e],unit:s});default:return null}}function M(e){return(0,N.tZ)(H,{children:e.percents.map((t=>(0,N.BX)(D,{"data-test-id":"vital-status",children:[E.Np[t.vitalState],e.showVitalPercentNames&&t.vitalState," ",(0,I.rl)(t.percent,0),e.showVitalThresholds&&A(e.vital,t.vitalState)]},t.vitalState)))})}M.displayName="VitalPercents";const H=(0,r.Z)("div",{target:"ex3thpn1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,y.Z)(2),";"),D=(0,r.Z)("div",{target:"ex3thpn0"})("display:flex;align-items:center;gap:",(0,y.Z)(.5),";font-size:",(e=>e.theme.fontSizeMedium),";");var B=s("./app/views/performance/landing/utils.tsx");function z(e){const t=(0,T.Z)(),{eventView:s,location:r,organization:a,functions:n}=e,{query:l}=r,c=s.withColumns(n),p=c.getPageFilters(),u=p.datetime.start?(0,b.hC)(p.datetime.start):void 0,m=p.datetime.end?(0,b.hC)(p.datetime.end):void 0,h="string"==typeof l.sparkInterval?l.sparkInterval:(0,d.ZS)({start:u||null,end:m||null,period:p.datetime.period},"low"),g=c.getEventsAPIPayload(r);return(0,N.tZ)(w.Z,{location:r,eventView:c,orgSlug:a.slug,limit:1,referrer:"api.performance.vitals-cards",children:e=>{let{isLoading:s,tableData:r}=e;return(0,N.tZ)(o.Z,{api:t,organization:a,period:p.datetime.period,project:p.projects,environment:p.environments,team:g.team,start:u,end:m,interval:h,query:g.query,includePrevious:!1,yAxis:c.getFields(),partial:!0,children:e=>{let{results:t}=e;const o=t?.reduce(((e,t)=>(e[t.seriesName]=t.data.map((e=>e.value)),e)),{}),l=(0,B.hv)(a);return(0,N.tZ)(R,{children:n.map((e=>{let t=(0,j.sN)(e);t.includes("apdex")&&(t="apdex()");const a=l[t];if(!a)return i.uT(`Missing field '${t}' in vital cards.`),null;const{title:n,tooltip:d,formatter:c}=a,p=(0,j.LY)(t),u=r?.data?.[0]?.[p],m=o?.[t],h=s||!(0,Z.ri)(u)?"—":c(u),g=(0,N.tZ)(L,{data:m});return(0,N.tZ)(G,{title:n,tooltip:d,value:h,chart:g,horizontal:!0,minHeight:96,isNotInteractive:!0},t)}))})}})}})}function L(e){const{data:t}=e,s=S.ZP.charts.getColorPalette(1)[0];return(0,N.tZ)($,{"data-test-id":"sparkline",width:150,height:24,children:(0,N.tZ)(v,{data:t,width:150,height:24,children:(0,N.tZ)(h.SparklinesLine,{style:{stroke:s,fill:"none",strokeWidth:3}})})})}(0,y.Z)(1.5),z.displayName="GenericCards",L.displayName="SparklineChart";const $=(0,r.Z)("div",{target:"e1he14ku8"})("flex-grow:4;max-height:",(e=>e.height),"px;max-width:",(e=>e.width),"px;margin:",(0,y.Z)(1)," ",(0,y.Z)(0)," ",(0,y.Z)(.5)," ",(0,y.Z)(3),";"),R=(0,r.Z)("div",{target:"e1he14ku7"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,y.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints.large),"){grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));}");function F(e){const{isLoading:t,data:s,vital:r,value:i,showBar:n=!0,showStates:o=!1,showDurationDetail:l=!1,showVitalPercentNames:d=!0,showVitalThresholds:c=!1,showDetail:u=!0,showTooltip:m=!1,barHeight:h}=e;if(t)return o?(0,N.tZ)(p.Z,{height:"48px"}):null;const g=o?(0,N.tZ)(q,{small:!0,children:(0,f.t)("No vitals found")}):null;if(!s)return g;const v={poor:0,meh:0,good:0,total:0};if((0,_.Z)(r).forEach((e=>{const t=s?.[e]??{};Object.keys(v).forEach((e=>v[e]+=t[e]))})),!v.total)return g;const x=Array.isArray(r)?null:i??function(e,t){const s=e?.p75??null;return null===s?"—":t===k.Zl.CLS?s.toFixed(2):`${s.toFixed(0)}ms`}(s?.[r]??null,r),y=function(e){let{poor:t,meh:s,good:r,total:a}=e;const i=t/a,n=s/a,o=r/a;return[{vitalState:E.SP.GOOD,percent:o},{vitalState:E.SP.MEH,percent:n},{vitalState:E.SP.POOR,percent:i}]}(v),Z=function(e){return e.map((e=>{let{percent:t,vitalState:s}=e;return{percent:t,color:E.fL[s]}}))}(y);return(0,N.BX)(a.Fragment,{children:[n&&(0,N.tZ)(U,{title:(0,N.tZ)(M,{vital:r,percents:y,showVitalPercentNames:!1,showVitalThresholds:!1,hideTooltips:m}),disabled:!m,position:"bottom",children:(0,N.tZ)(O,{barHeight:h,colorStops:Z})}),u&&(0,N.BX)(W,{children:[l&&x&&(0,N.BX)("div",{children:[(0,f.t)("The p75 for all transactions is "),(0,N.tZ)("strong",{children:x})]}),(0,N.tZ)(M,{vital:r,percents:y,showVitalPercentNames:d,showVitalThresholds:c})]})]})}F.displayName="VitalBar";const q=(0,r.Z)(c.Z,{target:"e1he14ku6"})("height:48px;padding:",(0,y.Z)(1.5)," 15%;");function G(e){const{chart:t,minHeight:s,horizontal:r,title:a,tooltip:i,value:n,isNotInteractive:o}=e;return(0,N.BX)(Q,{interactive:!o,minHeight:s,children:[(0,N.BX)(l.Gh,{children:[(0,N.tZ)(Y,{children:a}),(0,N.tZ)(u.Z,{size:"sm",position:"top",title:i})]}),(0,N.BX)(X,{horizontal:r,children:[(0,N.tZ)(J,{children:n}),t]})]})}G.displayName="VitalCard";const X=(0,r.Z)("div",{target:"e1he14ku5"})("width:100%;display:flex;flex-direction:",(e=>e.horizontal?"row":"column"),";justify-content:space-between;"),Q=(0,r.Z)(n.Z,{target:"e1he14ku4"})("color:",(e=>e.theme.textColor),";padding:",(0,y.Z)(2)," ",(0,y.Z)(3),";align-items:flex-start;margin-bottom:",(0,y.Z)(2),";",(e=>e.minHeight&&`min-height: ${e.minHeight}px`),";"),U=(0,r.Z)(x.Z,{target:"e1he14ku3"})({name:"1d3w5wq",styles:"width:100%"});const W=(0,r.Z)("div",{target:"e1he14ku2"})("font-size:",(e=>e.theme.fontSizeMedium),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){display:flex;justify-content:space-between;}"),J=(0,r.Z)("div",{target:"e1he14ku1"})("font-size:32px;margin-top:",(0,y.Z)(1),";"),Y=(0,r.Z)("div",{target:"e1he14ku0"})((e=>e.theme.overflowEllipsis),";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx.0f773b1c26e12a5c45d7302fee93805f.js.map