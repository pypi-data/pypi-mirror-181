"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_projectPlugins_index_tsx"],{"./app/actionCreators/plugins.tsx":(e,t,s)=>{s.d(t,{Cg:()=>u,MM:()=>c,rR:()=>d}),s("../node_modules/core-js/modules/es.error.cause.js");var n=s("./app/actionCreators/indicator.tsx"),i=s("./app/api.tsx"),r=s("./app/locale.tsx"),o=s("./app/stores/pluginsStore.tsx");const a={},l=new i.KU;function p(e){let{orgId:t,projectId:s,pluginId:n,update:i,...r}=e;o.Z.onUpdate(n,i);const a=l.requestPromise(`/projects/${t}/${s}/plugins/${n}/`,{...r});return a.then((()=>{o.Z.onUpdateSuccess(n,i)})).catch((e=>{const t=e&&e.responseJSON&&"string"==typeof e.responseJSON.detail?new Error(e.responseJSON.detail):new Error("Unable to update plugin");o.Z.onUpdateError(n,i,t)})),a}function c(e,t){let{orgId:s,projectId:n}=e;const i=`/projects/${s}/${n}/plugins/`;if(a[i])return a[i];o.Z.onFetchAll(t);const r=l.requestPromise(i,{method:"GET",includeAllArgs:!0});return a[i]=r,r.then((e=>{let[t,s,n]=e;return o.Z.onFetchAllSuccess(t,{pageLinks:n?.getResponseHeader("Link")??void 0}),t})).catch((e=>{throw o.Z.onFetchAllError(e),new Error("Unable to fetch plugins")})).then((()=>a[i]=null)),r}function u(e){return(0,n.E3)((0,r.t)("Enabling...")),p({...e,update:{enabled:!0},method:"POST"}).then((()=>(0,n.S9)((0,r.t)("Plugin was enabled")))).catch((()=>(0,n.Iw)((0,r.t)("Unable to enable plugin"))))}function d(e){return(0,n.E3)((0,r.t)("Disabling...")),p({...e,update:{enabled:!1},method:"DELETE"}).then((()=>(0,n.S9)((0,r.t)("Plugin was disabled")))).catch((()=>(0,n.Iw)((0,r.t)("Unable to disable plugin"))))}},"./app/components/acl/access.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),r=s("./app/components/alert.tsx"),o=s("./app/locale.tsx"),a=s("./app/utils/isRenderFunc.tsx"),l=s("./app/utils/withConfig.tsx"),p=s("./app/utils/withOrganization.tsx");const c=(0,s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js").tZ)(r.Z,{type:"error",showIcon:!0,children:(0,o.t)("You do not have sufficient permissions to access this.")});class u extends i.Component{render(){const{organization:e,config:t,access:s,requireAll:n,isSuperuser:i,renderNoAccessMessage:r,children:o}=this.props,{access:l}=e||{access:[]},p=!s||s[n?"every":"some"]((e=>l.includes(e))),u=!(!t.user||!t.user.isSuperuser),d={hasAccess:p,hasSuperuser:u},g=p&&(!i||u);return g||"function"!=typeof r?!g&&r?c:(0,a.l)(o)?o(d):g?o:null:r(d)}}u.displayName="Access",(0,n.Z)(u,"defaultProps",{renderNoAccessMessage:!1,isSuperuser:!1,requireAll:!0,access:[]});const d=(0,p.Z)((0,l.Z)(u))},"./app/stores/pluginsStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var n=s("../node_modules/reflux/src/index.js");const i={loading:!0,plugins:[],error:null,pageLinks:null},r={plugins:null,state:{...i},updating:new Map,reset(){return this.plugins=null,this.state={...i},this.updating=new Map,this.state},getInitialState(){return this.getState()},getState(){const{plugins:e,...t}=this.state;return{...t,plugins:this.plugins?Array.from(this.plugins.values()):[]}},init(){this.reset()},triggerState(){this.trigger(this.getState())},onFetchAll(){let{resetLoading:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&(this.state.loading=!0,this.state.error=null,this.plugins=null),this.triggerState()},onFetchAllSuccess(e,t){let{pageLinks:s}=t;this.plugins=new Map(e.map((e=>[e.id,e]))),this.state.pageLinks=s||null,this.state.loading=!1,this.triggerState()},onFetchAllError(e){this.plugins=null,this.state.loading=!1,this.state.error=e,this.triggerState()},onUpdate(e,t){if(!this.plugins)return;const s=this.plugins.get(e);if(!s)return;const n={...s,...t};this.plugins.set(e,n),this.updating.set(e,s),this.triggerState()},onUpdateSuccess(e,t){this.updating.delete(e)},onUpdateError(e,t,s){const n=this.updating.get(e);n&&this.plugins&&(this.plugins.set(e,n),this.updating.delete(e),this.state.error=s,this.triggerState())}},o=(0,n.createStore)(r)},"./app/utils/withPlugins.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/react/index.js"),r=s("./app/actionCreators/plugins.tsx"),o=s("./app/stores/pluginsStore.tsx"),a=s("./app/utils.tsx"),l=s("./app/utils/getDisplayName.tsx"),p=s("./app/utils/withOrganization.tsx"),c=s("./app/utils/withProject.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=function(e){class t extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{plugins:[],loading:!0}),(0,n.Z)(this,"unsubscribe",o.Z.listen((e=>{let{plugins:t,loading:s}=e;this.setState({plugins:t,loading:s})}),void 0))}componentDidMount(){this.fetchPlugins()}componentDidUpdate(e,t,s){const{organization:n,project:i}=this.props,r=e.organization||s?.organization,o=e.project||s?.project;if(!(0,a.ri)(o)||!(0,a.ri)(r))return;const l=r.slug===n.slug,p=o.slug===i?.slug;l&&p||this.fetchPlugins()}componentWillUnmount(){this.unsubscribe()}fetchPlugins(){const{organization:e,project:t}=this.props;t&&e&&(0,r.MM)({projectId:t.slug,orgId:e.slug})}render(){return(0,u.tZ)(e,{...this.props,plugins:this.state})}}return t.displayName="WithPlugins",(0,n.Z)(t,"displayName",`withPlugins(${(0,l.Z)(e)})`),(0,p.Z)((0,c.Z)(t))}},"./app/views/settings/project/permissionAlert.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var n=s("./app/components/acl/access.tsx"),i=s("./app/components/alert.tsx"),r=s("./app/locale.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=e=>{let{access:t=["project:write"],...s}=e;return(0,o.tZ)(n.Z,{access:t,children:e=>{let{hasAccess:t}=e;return!t&&(0,o.tZ)(i.Z,{"data-test-id":"project-permission-alert",type:"warning",...s,children:(0,r.t)("These settings can only be edited by users with the organization owner, manager, or admin role.")})}})};a.displayName="PermissionAlert";const l=a},"./app/views/settings/projectPlugins/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{ProjectPluginsContainer:()=>L,default:()=>M});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/react/index.js"),r=s("./app/actionCreators/plugins.tsx"),o=s("./app/components/sentryDocumentTitle.tsx"),a=s("./app/locale.tsx"),l=s("./app/utils/integrationUtil.tsx"),p=s("./app/utils/withPlugins.tsx"),c=s("./app/views/settings/components/settingsPageHeader.tsx"),u=s("./app/views/settings/project/permissionAlert.tsx"),d=s("./app/components/acl/access.tsx"),g=s("./app/components/links/link.tsx"),h=s("./app/components/loadingIndicator.tsx"),m=s("./app/components/panels/index.tsx"),x=s("./app/views/routeError.tsx"),Z=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),j=s("./app/components/links/externalLink.tsx"),f=s("./app/components/switchButton.tsx"),b=s("./app/plugins/components/pluginIcon.tsx"),w=s("./app/utils/getDynamicText.tsx"),y=s("./app/utils/recreateRoute.tsx"),v=s("./app/utils/withOrganization.tsx"),P=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const S={name:"is2cq7",styles:"color:#979ba0"};class C extends i.PureComponent{constructor(){super(...arguments),(0,n.Z)(this,"handleChange",(()=>{const{onChange:e,id:t,enabled:s}=this.props;e(t,!s);const n=s?"integrations.disabled":"integrations.enabled";(0,l.Db)(n,{integration:t,integration_type:"plugin",view:"legacy_integrations",organization:this.props.organization})}))}render(){const{id:e,name:t,slug:s,version:n,author:i,hasConfiguration:r,enabled:o,canDisable:l}=this.props,p=(0,y.Z)(e,this.props);return(0,P.tZ)(d.Z,{access:["project:write"],children:c=>{let{hasAccess:u}=c;const d=u?g.Z:"span";return(0,P.BX)(_,{className:s,children:[(0,P.BX)(z,{children:[(0,P.tZ)(E,{size:48,pluginId:e}),(0,P.BX)(A,{children:[(0,P.BX)(k,{children:[`${t} `,(0,w.Z)({value:(0,P.tZ)(N,{children:n?`v${n}`:(0,P.tZ)("em",{children:(0,a.t)("n/a")})}),fixed:(0,P.tZ)(N,{children:"v10"})})]}),(0,P.BX)("div",{children:[i&&(0,P.tZ)(j.Z,{css:S,href:i.url,children:i.name}),r&&(0,P.BX)("span",{children:[" ","Â·"," ",(0,P.tZ)(d,{css:S,to:p,children:(0,a.t)("Configure plugin")})]})]})]})]}),(0,P.tZ)(f.Z,{size:"lg",isDisabled:!u||!l,isActive:o,toggle:this.handleChange})]},e)}})}}C.displayName="ProjectPluginRow";const I=(0,v.Z)(C),_=(0,Z.Z)("div",{target:"evund0f5"})({name:"zol16h",styles:"display:flex;flex:1;align-items:center"}),A=(0,Z.Z)("div",{target:"evund0f4"})({name:"1cepywk",styles:"display:flex;justify-content:center;flex-direction:column"}),z=(0,Z.Z)("div",{target:"evund0f3"})({name:"1l1txui",styles:"display:flex;flex:1;line-height:24px"}),k=(0,Z.Z)("div",{target:"evund0f2"})({name:"11g4mt0",styles:"font-size:16px"}),E=(0,Z.Z)(b.ZP,{target:"evund0f1"})({name:"o7nnmj",styles:"margin-right:16px"}),N=(0,Z.Z)("span",{target:"evund0f0"})({name:"qhuumn",styles:"color:#babec2"});class U extends i.Component{render(){const{plugins:e,loading:t,error:s,onChange:n,routes:i,params:r,project:o}=this.props,{orgId:l}=this.props.params,p=!s&&t;return s?(0,P.tZ)(x.Z,{error:s}):p?(0,P.tZ)(h.Z,{}):(0,P.BX)(m.s_,{children:[(0,P.BX)(m.V9,{children:[(0,P.tZ)("div",{children:(0,a.t)("Legacy Integration")}),(0,P.tZ)("div",{children:(0,a.t)("Enabled")})]}),(0,P.BX)(m.N,{children:[(0,P.tZ)(m.aU,{type:"warning",children:(0,P.tZ)(d.Z,{access:["org:integrations"],children:e=>{let{hasAccess:t}=e;return t?(0,a._N)("Legacy Integrations must be configured per-project. It's recommended to prefer organization integrations over the legacy project integrations when available. Visit the [link:organization integrations] settings to manage them.",{link:(0,P.tZ)(g.Z,{to:`/settings/${l}/integrations`})}):(0,a.t)("Legacy Integrations must be configured per-project. It's recommended to prefer organization integrations over the legacy project integrations when available.")}})}),e.filter((e=>!e.isHidden)).map((e=>(0,P.tZ)(m.Lv,{children:(0,P.tZ)(I,{params:r,routes:i,project:o,...e,onChange:n})},e.id)))]})]})}}U.displayName="ProjectPlugins";const D=U;class L extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"fetchData",(async()=>{const e=(await(0,r.MM)(this.props.params)).filter((e=>e.hasConfiguration&&e.enabled)).length;(0,l.Db)("integrations.index_viewed",{integrations_installed:e,view:"legacy_integrations",organization:this.props.organization},{startSession:!0})})),(0,n.Z)(this,"handleChange",((e,t)=>{const{projectId:s,orgId:n}=this.props.params;(t?r.Cg:r.rR)({projectId:s,orgId:n,pluginId:e})}))}componentDidMount(){this.fetchData()}render(){const{loading:e,error:t,plugins:s}=this.props.plugins||{},{orgId:n}=this.props.params,r=(0,a.t)("Legacy Integrations");return(0,P.BX)(i.Fragment,{children:[(0,P.tZ)(o.Z,{title:r,orgSlug:n}),(0,P.tZ)(c.Z,{title:r}),(0,P.tZ)(u.Z,{}),(0,P.tZ)(D,{...this.props,onChange:this.handleChange,loading:e,error:t,plugins:s})]})}}L.displayName="ProjectPluginsContainer";const M=(0,p.Z)(L)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_projectPlugins_index_tsx.b902ddbe36eae70ab7988725613a7422.js.map