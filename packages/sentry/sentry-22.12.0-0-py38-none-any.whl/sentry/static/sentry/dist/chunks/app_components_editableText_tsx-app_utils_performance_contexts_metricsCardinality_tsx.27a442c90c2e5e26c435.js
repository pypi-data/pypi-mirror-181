"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx"],{"./app/components/editableText.tsx":(e,t,n)=>{n.d(t,{Z:()=>f});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=n("../node_modules/react/index.js"),r=n("./app/actionCreators/indicator.tsx"),s=n("./app/components/input.tsx"),i=n("./app/components/textOverflow.tsx"),c=n("./app/icons/iconEdit.tsx"),l=n("./app/styles/space.tsx"),u=n("./app/utils.tsx");const d=(e,t)=>{const[n,a]=(0,o.useState)(!1),r=t??document.body;return(0,o.useEffect)((()=>{const t=t=>{let{key:n}=t;n===e&&a(!0)},n=t=>{let{key:n}=t;n===e&&a(!1)};return r.addEventListener("keydown",t),r.addEventListener("keyup",n),()=>{r.removeEventListener("keydown",t),r.removeEventListener("keyup",n)}}),[e,r]),n};var m=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{value:t,onChange:n,name:a,errorMessage:s,successMessage:i,maxLength:l,isDisabled:p=!1,autoSelect:f=!1,className:Z,"aria-label":C}=e;const[_,w]=(0,o.useState)(!1),[k,E]=(0,o.useState)(t),L=!k.trim(),P=(0,o.useRef)(null),j=(0,o.useRef)(null),D=(0,o.useRef)(null),T=d("Enter"),z=d("Escape");function N(){t!==k&&E(t),_&&w(!1)}var O,S;O=P,S=()=>{_&&(L?R("error"):(k!==t&&(n(k),R("success")),w(!1)))},(0,o.useEffect)((()=>{const e=e=>{const t=O?.current;t&&!t.contains(e.target)&&S(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[O,S]);const A=(0,o.useCallback)((()=>{if(T){if(L)return void R("error");k!==t&&(n(k),R("success")),w(!1)}}),[T,k,n]),M=(0,o.useCallback)((()=>{z&&N()}),[z]);function R(e){"error"!==e?i&&(0,r.S9)(i):s&&(0,r.Iw)(s)}return(0,o.useEffect)((()=>{N()}),[p,t]),(0,o.useEffect)((()=>{if(_){const e=D.current;(0,u.ri)(e)&&e.focus()}}),[_]),(0,o.useEffect)((()=>{_&&(A(),M())}),[A,M,_]),(0,m.tZ)(x,{isDisabled:p,isEditing:_,className:Z,children:_?(0,m.BX)(y,{ref:P,isEmpty:L,"data-test-id":"editable-text-input",children:[(0,m.tZ)(v,{"aria-label":C,name:a,ref:D,value:k,onChange:function(e){E(e.target.value)},onFocus:e=>f&&e.target.select(),maxLength:l}),(0,m.tZ)(h,{children:k})]}):(0,m.BX)(g,{onClick:p?void 0:function(){w(!0)},ref:j,isDisabled:p,"data-test-id":"editable-text-label",children:[(0,m.tZ)(b,{children:k}),!p&&(0,m.tZ)(c.y,{})]})})}p.displayName="EditableText";const f=p,g=(0,a.Z)("div",{target:"e1nzw5k75"})("display:grid;grid-auto-flow:column;align-items:center;gap:",(0,l.Z)(1),";cursor:",(e=>e.isDisabled?"default":"pointer"),";"),b=(0,a.Z)(i.Z,{target:"e1nzw5k74"})("border-top:1px solid transparent;border-bottom:1px dotted ",(e=>e.theme.gray200),";"),y=(0,a.Z)("div",{target:"e1nzw5k73"})("display:inline-block;background:",(e=>e.theme.gray100),";border-radius:",(e=>e.theme.borderRadius),";margin:-",(0,l.Z)(.5)," -",(0,l.Z)(1),";padding:",(0,l.Z)(.5)," ",(0,l.Z)(1),";max-width:calc(100% + ",(0,l.Z)(2),");"),v=(0,a.Z)(s.Z,{target:"e1nzw5k72"})({name:"1v43sqt",styles:"border:none!important;background:transparent;height:auto;min-height:34px;padding:0;font-size:inherit;&,&:focus,&:active,&:hover{box-shadow:none;}"}),h=(0,a.Z)("div",{target:"e1nzw5k71"})("height:0;opacity:0;white-space:pre;padding:0 ",(0,l.Z)(1),";"),x=(0,a.Z)("div",{target:"e1nzw5k70"})("display:flex;",(e=>e.isDisabled&&`\n      ${b} {\n        border-bottom-color: transparent;\n      }\n    `),";")},"./app/utils/performance/contexts/metricsCardinality.tsx":(e,t,n)=>{n.d(t,{BT:()=>x,e0:()=>C}),n("../node_modules/core-js/modules/es.array.includes.js");var a=n("../node_modules/react/index.js"),o=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),r=n("./app/utils/dates.tsx"),s=n("./app/utils/discover/eventView.tsx"),i=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),c=n("../node_modules/lodash/omit.js"),l=n.n(c),u=n("./app/utils/discover/genericDiscoverQuery.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{eventView:t,location:n}=e;return l()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function p(e){let{children:t,...n}=e;return(0,d.tZ)(u.ZP,{route:"metrics-compatibility-sums",getRequestPayload:m,...n,children:e=>{let{tableData:n,...a}=e;return t({tableData:n,...a})}})}function f(e){let{eventView:t,location:n}=e;return l()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function g(e){let{children:t,...n}=e;return(0,d.tZ)(u.ZP,{route:"metrics-compatibility",getRequestPayload:f,...n,children:e=>{let{tableData:n,...a}=e;return t({tableData:n,...a})}})}p.displayName="MetricsCompatibilityQuery",g.displayName="MetricsCompatibilitySumsQuery";var b=n("./app/utils/performance/contexts/utils.tsx");const[y,v,h]=(0,b.n)({name:"MetricsCardinalityContext",strict:!1}),x=e=>{if(!(0,i.gp)(e.organization))return(0,d.tZ)(y,{value:{isLoading:!1,outcome:{forceTransactionsOnly:!0}},children:e.children});const t={location:e.location,orgSlug:e.organization.slug,cursor:"0:0:0"},n=s.ZP.fromLocation(e.location);n.fields=[{field:"tpm()"}];const o=function(e){const t=e.clone();return t.start||t.end||(t.statsPeriod?(0,r.YJ)(t.statsPeriod)>1&&(t.statsPeriod="1h",t.start=void 0,t.end=void 0):(t.statsPeriod="1h",t.start=void 0,t.end=void 0)),t}(n);return(0,d.tZ)(a.Fragment,{children:(0,d.tZ)(p,{eventView:o,...t,children:n=>(0,d.tZ)(g,{eventView:o,...t,children:t=>{const a=n.isLoading||t.isLoading,o=n.isLoading||t.isLoading?void 0:function(e,t,n){const a={forceTransactionsOnly:!0},o=n.features.includes("performance-mep-bannerless-ui");if(!e)return a;const r=e.compatible_projects;return t?a:e?function(e){return!_(e).metricsCount}(e)?a:function(e,t){const n=_(e);return t?n.nullCount/n.metricsCount>.01:n.nullCount>0}(e,o)?{shouldWarnIncompatibleSDK:!0,forceTransactionsOnly:!0,compatibleProjects:r}:function(e){const t=_(e);return t.unparamCount>=t.metricsCount}(e)?{shouldNotifyUnnamedTransactions:!0,forceTransactionsOnly:!0,compatibleProjects:r}:function(e,t){const n=_(e);return t?n.unparamCount/n.metricsCount>.01:n.unparamCount>0}(e,o)?{shouldNotifyUnnamedTransactions:!0,compatibleProjects:r,forceTransactionsOnly:!1}:{forceTransactionsOnly:!1}:a}(n.tableData&&t.tableData?{...n.tableData,...t.tableData}:null,!!n.error&&!!t.error,e.organization);return(0,d.tZ)(Z,{sendOutcomeAnalytics:e.sendOutcomeAnalytics,organization:e.organization,value:{isLoading:a,outcome:o},children:e.children})}})})})};x.displayName="MetricsCardinalityProvider";const Z=e=>{const t=e.value.outcome?.shouldWarnIncompatibleSDK??!1,n=e.value.outcome?.shouldNotifyUnnamedTransactions??!1,r=!e.value.outcome?.forceTransactionsOnly;return(0,a.useEffect)((()=>{!e.value.isLoading&&e.sendOutcomeAnalytics&&(0,o.Z)("performance_views.mep.metrics_outcome",{organization:e.organization,is_on_metrics:r,fallback_from_null:t,fallback_from_unparam:n})}),[e.organization,e.value.isLoading,r,n,t,e.sendOutcomeAnalytics]),(0,d.tZ)(y,{...e,children:e.children})};Z.displayName="Provider",h.Consumer;const C=v;function _(e){let{sum:t}=e;try{const e=Number(t.metrics);return{metricsCount:e,unparamCount:Number(t.metrics_unparam),nullCount:Number(t.metrics_null)}}catch(e){return{metricsCount:0,unparamCount:0,nullCount:0}}}}}]);
//# sourceMappingURL=../sourcemaps/app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx.b6b05be016bf3262328994815cca4dcb.js.map