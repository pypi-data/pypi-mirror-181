"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_modals_widgetBuilder_addToDashboardModal_tsx"],{"./app/components/modals/widgetBuilder/addToDashboardModal.tsx":(t,e,a)=>{a.r(e),a.d(e,{default:()=>B,modalCss:()=>D});var s=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=a("../node_modules/react/index.js"),o=a("./app/actionCreators/dashboards.tsx"),d=a("./app/actionCreators/indicator.tsx"),n=a("./app/components/button.tsx"),r=a("./app/components/buttonBar.tsx"),l=a("./app/components/forms/controls/selectControl.tsx"),c=a("./app/locale.tsx"),p=a("./app/styles/space.tsx"),u=a("./app/utils/handleXhrErrorResponse.tsx"),h=a("./app/utils/performance/contexts/metricsCardinality.tsx"),g=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),m=a("./app/utils/useApi.tsx"),b=a("./app/views/dashboardsV2/types.tsx"),w=a("./app/views/dashboardsV2/utils.tsx"),x=a("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),y=a("./app/views/dashboardsV2/widgetCard/index.tsx"),Z=a("./app/views/organizationContext.tsx"),f=a("./app/views/performance/landing/metricsDataSwitcher.tsx"),v=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const C=(0,c.t)("Select a dashboard");function A(t){let{Header:e,Body:a,Footer:s,closeModal:r,location:p,organization:A,router:B,selection:D,widget:_,widgetAsQueryParams:k}=t;const q=(0,m.Z)(),[z,j]=(0,i.useState)(null),[E,P]=(0,i.useState)(null),[M,V]=(0,i.useState)(null);(0,i.useEffect)((()=>{let t=!1;return(0,o.j2)(q,A.slug).then((e=>{t||j(e)})),()=>{t=!0}}),[q,A.slug]),(0,i.useEffect)((()=>{let t=!1;return M===x.i0||null===M?P(null):(0,o.AK)(q,A.slug,M).then((e=>{t||P(e)})),()=>{t=!0}}),[q,A.slug,M]);const O=null!==M;return(0,v.BX)(Z.g.Provider,{value:A,children:[(0,v.tZ)(e,{closeButton:!0,children:(0,v.tZ)("h4",{children:(0,c.t)("Add to Dashboard")})}),(0,v.BX)(a,{children:[(0,v.tZ)(S,{children:(0,v.tZ)(l.Z,{disabled:null===z,menuPlacement:"auto",name:"dashboard",placeholder:(0,c.t)("Select Dashboard"),value:M,options:z&&[{label:(0,c.t)("+ Create New Dashboard"),value:"new"},...z.map((t=>{let{title:e,id:a,widgetDisplay:s}=t;return{label:e,value:a,disabled:s.length>=b.ZU,tooltip:s.length>=b.ZU&&(0,c._N)("Max widgets ([maxWidgets]) per dashboard reached.",{maxWidgets:b.ZU}),tooltipOptions:{position:"right"}}}))],onChange:t=>{t.disabled||V(t.value)}})}),(0,v.tZ)(S,{children:(0,c.t)("Any conflicting filters from this query will be overridden by Dashboard filters. This is a preview of how the widget will appear in your dashboard.")}),(0,v.tZ)(h.BT,{organization:A,location:p,children:(0,v.tZ)(f.d,{organization:A,eventView:(0,w.tT)(_.title,_.queries[0],D,_.displayType),location:p,hideLoadingIndicator:!0,children:t=>(0,v.tZ)(g.kP,{location:p,forceTransactions:t.forceTransactionsOnly,children:(0,v.tZ)(y.Z,{organization:A,isEditing:!1,widgetLimitReached:!1,selection:E?(0,w.fK)(E):D,dashboardFilters:(0,w.lM)(p)??E?.filters,widget:_,showStoredAlert:!0})})})})]}),(0,v.tZ)(s,{children:(0,v.BX)(T,{gap:1.5,children:[(0,v.tZ)(n.ZP,{onClick:async function(){if(null===E)return;let t=_.queries[0].orderby;b.FO.AREA&&_.queries[0].columns.length||(t="");const e=_.queries[0],a={..._,title:""===_.title?(0,c.t)("All Events"):_.title,queries:[{...e,orderby:t}]};try{const t={...E,widgets:[...E.widgets,a]};await(0,o.Y)(q,A.slug,t),r(),(0,d.S9)((0,c.t)("Successfully added widget to dashboard"))}catch(t){const e=(0,c.t)("Unable to add widget to dashboard");(0,u.Z)(e)(t),(0,d.Iw)(e)}},disabled:!O||M===x.i0,title:O?void 0:C,children:(0,c.t)("Add + Stay in Discover")}),(0,v.tZ)(n.ZP,{priority:"primary",onClick:function(){const t=M===x.i0?`/organizations/${A.slug}/dashboards/new/widget/new/`:`/organizations/${A.slug}/dashboard/${M}/widget/new/`;B.push({pathname:t,query:{...k,...E?(0,w.aq)(E):{}}}),r()},disabled:!O,title:O?void 0:C,children:(0,c.t)("Open in Widget Builder")})]})})]})}A.displayName="AddToDashboardModal";const B=A,S=(0,s.Z)("div",{target:"erdydty1"})("margin-bottom:",(0,p.Z)(2),";"),T=(0,s.Z)(r.ZP,{target:"erdydty0"})("@media (max-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:repeat(2, 1fr);gap:",(0,p.Z)(1.5),";width:100%;>button{width:100%;}}"),D={name:"jzg5s9",styles:"max-width:700px;margin:70px auto"}}}]);
//# sourceMappingURL=../sourcemaps/app_components_modals_widgetBuilder_addToDashboardModal_tsx.a61fd7beceaf87e5af4b23d8462b75fa.js.map