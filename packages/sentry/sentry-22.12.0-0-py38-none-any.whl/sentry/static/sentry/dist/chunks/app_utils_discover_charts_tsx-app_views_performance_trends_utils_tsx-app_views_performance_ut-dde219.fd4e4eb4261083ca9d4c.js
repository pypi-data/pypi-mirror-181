"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_utils_discover_charts_tsx-app_views_performance_trends_utils_tsx-app_views_performance_ut-dde219"],{"./app/utils/discover/charts.tsx":(e,t,n)=>{n.d(t,{CX:()=>i,Xp:()=>d,gu:()=>u,x1:()=>l});var r=n("./app/locale.tsx"),s=n("./app/utils.tsx"),a=n("./app/utils/formatters.tsx");function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";return(0,s.ri)(e)?o(e,t):"—"}function o(e,t){if(!(0,s.ri)(e))return"—";switch(t){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,a.rl)(e,2);case"duration":return(0,a.g9)(e/1e3,2,!0);case"size":return(0,s.F)(e);default:return e.toString()}}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return l(e,t,n,r)}function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;switch(t){case"integer":case"number":return n?(0,a.Du)(e):e.toLocaleString();case"percentage":return(0,a.rl)(e,0);case"duration":return c(e,r);case"size":return(0,s.F)(e,0);default:return e.toString()}}function c(e,t){if(t??=p(e),0===e)return"0";switch(t){case a.ps:{const t=(e/a.ps).toFixed(0);return(0,r.t)("%swk",t)}case a.x4:{const t=(e/a.x4).toFixed(0);return(0,r.t)("%sd",t)}case a.kr:{const t=(e/a.kr).toFixed(0);return(0,r.t)("%shr",t)}case a.EB:{const t=(e/a.EB).toFixed(0);return(0,r.t)("%smin",t)}case a.sh:{const t=(e/a.sh).toFixed(0);return(0,r.t)("%ss",t)}default:const t=e.toFixed(0);return(0,r.t)("%sms",t)}}function d(e,t){let n=0;const r=function(e,t){let n;if(e[0]?.data){let r,s=e[0];e.forEach(((n,a)=>{let{seriesName:i,data:o}=n;!1!==t?.selected?.[i]&&o.length&&(s=e[a],r??=e[a])})),r?.data&&(n={max:Math.max(...r.data.map((e=>{let{value:t}=e;return t})).filter((e=>!!e))),min:Math.min(...s.data.map((e=>{let{value:t}=e;return t})).filter((e=>!!e)))})}return n}(e,t);if(r){const e=(r.max+r.min)/2;n=p((r.max-r.min)/5),(e/n).toFixed(0).length>6&&(n=p(e))}return n}function p(e){return e>=a.ps?a.ps:e>=a.x4?a.x4:e>=a.kr?a.kr:e>=a.EB?a.EB:e>=a.sh?a.sh:1}},"./app/views/performance/trends/types.tsx":(e,t,n)=>{let r,s,a;n.d(t,{A2:()=>a,ER:()=>r,Z2:()=>s}),function(e){e.IMPROVED="improved",e.REGRESSION="regression"}(r||(r={})),function(e){e.P50="p50",e.P75="p75",e.P95="p95",e.P99="p99",e.AVG="avg"}(s||(s={})),function(e){e.DURATION="transaction.duration",e.LCP="measurements.lcp",e.FCP="measurements.fcp",e.FID="measurements.fid",e.CLS="measurements.cls",e.SPANS_DB="spans.db",e.SPANS_HTTP="spans.http",e.SPANS_BROWSER="spans.browser",e.SPANS_RESOURCE="spans.resource"}(a||(a={}))},"./app/views/performance/trends/utils.tsx":(e,t,n)=>{n.d(t,{CE:()=>y,HF:()=>V,IO:()=>_,Kt:()=>F,P4:()=>C,RP:()=>D,T1:()=>h,Ws:()=>x,_1:()=>m,_H:()=>b,bg:()=>g,cs:()=>E,ed:()=>P,es:()=>S,iF:()=>w,j_:()=>T,kM:()=>O,vq:()=>j,vt:()=>N,wx:()=>A}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../node_modules/downsample/methods/ASAP.js"),s=n("../node_modules/moment/moment.js"),a=n.n(s),i=n("./app/components/charts/utils.tsx"),o=n("./app/locale.tsx"),u=n("./app/utils/discover/fields.tsx"),l=n("./app/utils/queryString.tsx"),c=n("./app/utils/theme.tsx"),d=n("./app/utils/tokenizeSearch.tsx"),p=n("./app/views/performance/utils.tsx"),f=n("./app/views/performance/trends/types.tsx");const m="14d",g="15min",h=[{label:"p50",field:f.Z2.P50,alias:"percentile_range",legendLabel:"p50"},{label:"p75",field:f.Z2.P75,alias:"percentile_range",legendLabel:"p75"},{label:"p95",field:f.Z2.P95,alias:"percentile_range",legendLabel:"p95"},{label:"p99",field:f.Z2.P99,alias:"percentile_range",legendLabel:"p99"},{label:"average",field:f.Z2.AVG,alias:"avg_range",legendLabel:"average"}],E=[{label:"Duration",column:f.A2.DURATION},{label:"LCP",column:f.A2.LCP},{label:"FCP",column:f.A2.FCP},{label:"FID",column:f.A2.FID},{label:"CLS",column:f.A2.CLS},{label:"Spans (http)",column:f.A2.SPANS_HTTP},{label:"Spans (db)",column:f.A2.SPANS_DB},{label:"Spans (browser)",column:f.A2.SPANS_BROWSER},{label:"Spans (resource)",column:f.A2.SPANS_RESOURCE}],S={[f.ER.IMPROVED]:{lighter:c.ZP.green200,default:c.ZP.green300},[f.ER.REGRESSION]:{lighter:c.ZP.red200,default:c.ZP.red300}},R={[f.ER.IMPROVED]:"improvedSelected",[f.ER.REGRESSION]:"regressionSelected"},v={[f.ER.IMPROVED]:"improvedUnselectedSeries",[f.ER.REGRESSION]:"regressionUnselectedSeries"},N={[f.ER.IMPROVED]:"improvedCursor",[f.ER.REGRESSION]:"regressionCursor"};function x(){const e={};return Object.values(N).forEach((t=>e[t]=void 0)),e}function y(e,t){const n=t??(0,l.ro)(e?.query?.trendFunction);return h.find((e=>{let{field:t}=e;return t===n}))||h[0]}function _(e,t,n){const r=(0,l.ro)(e?.query?.trendParameter),s=E.find((e=>{let{label:t}=e;return t===r}));return s||function(e,t){return function(e){switch(e){case p.iy.FRONTEND:return{label:"LCP",column:f.A2.LCP};case p.iy.ANY:case p.iy.BACKEND:case p.iy.FRONTEND_OTHER:default:return{label:"Duration",column:f.A2.DURATION}}}((0,p.Bh)(e,t))}(t,n)}function P(e,t){return(0,u.sN)({kind:"function",function:[e,t,void 0,void 0]})}function F(e,t){return{fromSeconds:e/1e3,toSeconds:t/1e3,showDigits:e>1e3||t>1e3||e<10||t<10}}function b(e,t){if(e.project&&t)return t.find((t=>t.slug===e.project))?.id}function O(e,t,n,r,s){const a=y(t),o=_(t,r,e.project),u=[...s?[]:["transaction"],"project"].map((e=>({field:e}))),c={field:"trend_percentage()",kind:"asc"};e.trendType=n,n===f.ER.REGRESSION&&(c.kind="desc"),a&&o&&(e.trendFunction=P(a.field,o.column)),e.query=function(e){const t=new d.MY(e);return t.hasFilter("count_percentage()")||t.addFilterValues("count_percentage()",[">0.25","<4"]),t.hasFilter("trend_percentage()")||t.addFilterValues("trend_percentage()",[">0%"]),t.hasFilter("confidence()")||t.addFilterValues("confidence()",[">6"]),t.formatString()}(e.query),e.interval=function(e,t){const n=(0,l.ro)(e?.query?.interval),{start:r,end:s,statsPeriod:a}=t,o={start:r||null,end:s||null,period:a},u=(0,i.ZS)(o,"high");return n||u}(t,e),e.sorts=[c],e.fields=u}function w(e,t){const{query:n}=t,r=n.start&&n.end;return n.statsPeriod||r||(e.statsPeriod=m),e}function A(e,t){const n=Math.abs(e);return{seconds:n/1e3,fixedDigits:n>1e3||n<10?1:0,changeLabel:t===f.ER.REGRESSION?(0,o.t)("slower"):(0,o.t)("faster")}}function D(e){const t=a()();return e.map((e=>({...e,received_at:t,transaction:e.transaction})))}function T(e){return R[e]}function C(e){return v[e]}const I=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return(0,r.Cl)(e,t)},V=e=>["p50","p75"].find((t=>e.includes(t)));function j(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;if(!e)return{maxValue:r,minValue:n,smoothedResults:void 0};const s=[];for(const a of e){const e=a.data,i=[],o=I(e.map((e=>{let{name:t,value:n}=e;return[Number(t),n]})));for(let e=0;e<o.length;e++){const t=o[e],s=t.y;if(i.push({name:t.x,value:s}),!isNaN(s)){const e=Math.round(s);n=Math.min(e,n),r=Math.max(e,r)}}s.push({seriesName:t||a.seriesName||"Current",data:i,lineStyle:a.lineStyle,color:a.color})}return{minValue:n,maxValue:r,smoothedResults:s}}},"./app/views/performance/utils.tsx":(e,t,n)=>{n.d(t,{Bh:()=>P,C$:()=>F,Ik:()=>b,JY:()=>j,Ov:()=>D,Pv:()=>R,R8:()=>T,U7:()=>E,Ws:()=>A,YL:()=>q,al:()=>C,bY:()=>M,de:()=>w,iL:()=>O,iy:()=>v,m_:()=>I,n4:()=>V,og:()=>S,p9:()=>k,rL:()=>L,uq:()=>N}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../node_modules/react-router/es/index.js"),s=n("./app/constants/pageFilters.tsx"),a=n("./app/data/platformCategories.tsx"),i=n("./app/locale.tsx"),o=n("./app/utils/analytics.tsx"),u=n("./app/utils/dates.tsx"),l=n("./app/utils/discover/eventView.tsx"),c=n("./app/utils/discover/fields.tsx"),d=n("./app/utils/formatters.tsx"),p=n("./app/utils/getCurrentSentryReactTransaction.tsx"),f=n("./app/utils/queryString.tsx"),m=n("./app/utils/toArray.tsx"),g=n("./app/utils/tokenizeSearch.tsx"),h=n("./app/views/performance/trends/utils.tsx");const E=["environment","project","query","start","end","statsPeriod"],S="<< unparameterized >>";let R,v;function N(e){const t=e.source===R.DISCOVER?["transaction","project","transaction.source","epm()"]:["transaction","project","transaction.source","epm()","p50()","p95()"],n={id:void 0,name:e.source===R.DISCOVER?(0,i.t)("Unparameterized Transactions"):(0,i.t)("Performance - Unparameterized Transactions"),query:'event.type:transaction transaction.source:"url"',projects:[],fields:t,version:2},r=l.ZP.fromNewQueryWithLocation(n,e.location).withSorts([{field:"epm",kind:"desc"}]).getResultsViewUrlTarget(e.organization.slug);return r.query.showUnparameterizedBanner="true",r}!function(e){e.PERFORMANCE="performance",e.DISCOVER="discover"}(R||(R={})),function(e){e.ANY="any",e.FRONTEND="frontend",e.BACKEND="backend",e.FRONTEND_OTHER="frontend_other",e.MOBILE="mobile"}(v||(v={}));const x=[...a.tQ],y=a.y3.filter((e=>"native"!==e)),_=[...a.ai];function P(e,t){if(0===t.length||t[0]===s.mP)return v.ANY;const n=e.filter((e=>t.includes(parseInt(`${e.id}`,10))));return 0===n.length||n.some((e=>!e.platform))?v.ANY:n.every((e=>x.includes(e.platform)))?v.FRONTEND:n.every((e=>y.includes(e.platform)))?v.BACKEND:n.every((e=>_.includes(e.platform)))?v.MOBILE:v.ANY}function F(e,t){const n=P(e,t.project);return n===v.FRONTEND&&new g.MY(t.query).getFilterValues("!transaction.op").some((e=>"pageload"===e))?v.FRONTEND_OTHER:n}function b(e,t){return F(t,e)===v.FRONTEND}function O(e,t){return F(t,e)===v.FRONTEND||F(t,e)===v.FRONTEND_OTHER}function w(e){return`/organizations/${e.slug}/performance/`}function A(e){return`/organizations/${e.slug}/performance/trends/`}function D(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,f.ro)(e.query.query,t).trim()}function T(e){let{location:t,organization:n,projectPlatforms:s}=e;(0,o.ec)({eventKey:"performance_views.change_view",eventName:"Performance Views: Change View",organization_id:parseInt(n.id,10),view_name:"TRENDS",project_platforms:s});const a=C({location:t,organization:n});r.browserHistory.push(a)}function C(e){let{location:t,organization:n,initialConditions:r,additionalQuery:s}=e;const a={...t.query,...s},i=(0,f.ro)(t.query.query,""),o=new g.MY(i),u=r??new g.MY([]);return o.hasFilter("tpm()")?u.setFilterValues("tpm()",o.getFilterValues("tpm()")):u.setFilterValues("tpm()",[">0.01"]),o.hasFilter("transaction.duration")?u.setFilterValues("transaction.duration",o.getFilterValues("transaction.duration")):u.setFilterValues("transaction.duration",[">0",`<${h.bg}`]),a.query=u.formatString(),{pathname:A(n),query:{...a}}}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{excludeTagKeys:new Set(["event.type","project"])};return e.getFilterKeys().forEach((n=>{const r=n.startsWith("!")?n.substr(1):n;(r.match(/\w+\(.*\)/)||c.J8.includes(r)||t.excludeTagKeys.has(r))&&e.removeFilter(n)})),e}function V(e){const t=(0,p.Z)(),n=(0,u.Ri)(e.datetime.period,e.datetime.start,e.datetime.end),r=Math.floor(86400*n);t?.setTag("query.period",r.toString());let s=">30d";r<=86400?s="<=1d":r<=604800?s="<=7d":r<=1209600?s="<=14d":r<=2592e3&&(s="<=30d"),t?.setTag("query.period.grouped",s)}function j(e){const{transaction:t}=e.query;return(0,f.ro)(t)}function q(e){return(0,d.g9)(e/1e3,e>1e3?2:0,!0)}function L(e){return!e.project.length||1===e.project.length&&e.project[0]===s.mP}function M(e,t){const n=e.query.project,r=new Set((0,m.Z)(n));return t.reduce(((e,t)=>(r.has(t.id)&&e.push(t.platform??"undefined"),e)),[])}function k(e,t){return M(e,t).join(", ")}}}]);
//# sourceMappingURL=../sourcemaps/app_utils_discover_charts_tsx-app_views_performance_trends_utils_tsx-app_views_performance_ut-dde219.5d3dc9e78be6ac418cf5796959e88f8e.js.map