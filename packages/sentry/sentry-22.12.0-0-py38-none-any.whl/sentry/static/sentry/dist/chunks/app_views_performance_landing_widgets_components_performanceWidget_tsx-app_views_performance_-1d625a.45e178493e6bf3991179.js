"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_landing_widgets_components_performanceWidget_tsx-app_views_performance_-1d625a"],{"./app/views/performance/landing/widgets/components/performanceWidget.tsx":(e,t,a)=>{a.d(t,{I:()=>T});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=a("../node_modules/react/index.js"),r=a("./app/components/charts/errorPanel.tsx"),s=a("./app/components/placeholder.tsx"),o=a("./app/icons/iconWarning.tsx"),d=a("./app/styles/space.tsx"),l=a("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),c=a("./app/utils/getDynamicText.tsx"),p=(a("../node_modules/core-js/modules/es.array.includes.js"),a("./app/components/tag.tsx")),g=a("./app/utils/useOrganization.tsx"),m=a("./app/views/performance/landing/widgets/utils.tsx"),u=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),y=a("./app/utils/performance/contexts/utils.tsx"),h=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[Z,f]=(0,y.n)({name:"MetricsEnhancedPerformanceDataContext"}),x=e=>{let{children:t,chartSetting:a}=e;const{setAutoSampleState:i}=(0,u.Eg)(),[r,s]=(0,n.useState)(void 0),o=(0,n.useCallback)((e=>{m.zS.includes(a)||(!0===e?i(u.nl.metrics):!1===e&&i(u.nl.transactions),s(e))}),[i,s,a]);return(0,h.tZ)(Z,{value:{isMetricsData:r,setIsMetricsData:o},children:t})};x.displayName="MEPDataProvider";const v=f,w=()=>{const{isMetricsData:e}=v();if(!(0,g.Z)().features.includes("performance-use-metrics"))return null;if(void 0===e)return(0,h.tZ)("span",{"data-test-id":"no-metrics-data-tag"});const t=e?"processed":"indexed";return(0,h.tZ)(p.Z,{"data-test-id":"has-metrics-data-tag",children:t})};w.displayName="MEPTag";var b=a("./app/utils/useApi.tsx"),D=a("./app/components/panels/index.tsx");const q=(0,i.Z)(D.s_,{target:"e1evmidq1"})("padding-top:",(0,d.Z)(2),";margin-bottom:0;"),S=(0,i.Z)("div",{target:"e1evmidq0"})("");function C(e){return e.isErrored?e.errorComponent:e.isLoading&&e.loadingComponent?e.loadingComponent:e.hasData?(0,h.tZ)(n.Fragment,{children:e.dataComponents}):e.emptyComponent}C.displayName="DataStateSwitch";var P=a("./app/utils/dates.tsx");function j(e){const t=e.children??(0,h.tZ)(n.Fragment,{});return e.queries.length?(0,h.tZ)(n.Fragment,{children:e.queries.filter((t=>!t.enabled||t.enabled(e.widgetData))).map((t=>(0,h.tZ)(_,{...e,query:t},t.queryKey)))}):(0,h.tZ)(n.Fragment,{children:t})}function _(e){const t=e.query,a=e.queryProps.eventView.getPageFilters(),i=a.datetime.start?(0,P.hC)(a.datetime.start):null,r=a.datetime.end?(0,P.hC)(a.datetime.end):null;return(0,n.useEffect)((()=>()=>{e.removeWidgetDataForKey(t.queryKey)}),[]),(0,h.tZ)(t.component,{fields:t.fields,yAxis:t.fields,start:i,end:r,period:a.datetime.period,project:a.projects,environment:a.environments,organization:e.queryProps.organization,orgSlug:e.queryProps.organization.slug,eventView:e.queryProps.eventView,query:e.queryProps.eventView.getQueryWithAdditionalConditions(),widgetData:e.widgetData,referrer:(s=e.queryProps.chartSetting,`api.performance.generic-widget-chart.${s.replace(/_/g,"-")}`),children:a=>(0,h.tZ)(n.Fragment,{children:(0,h.tZ)(k,{results:a,...e,query:t})})},t.queryKey);var s}function k(e){const t=v(),{results:a,query:i}=e,r=i.transform(e.queryProps,a,e.query);return(0,n.useEffect)((()=>{const n=a?.seriesAdditionalInfo?.[e.queryProps.fields[0]]?.isMetricsData??a?.histograms?.meta?.isMetricsData??a?.tableData?.meta?.isMetricsData;t.setIsMetricsData(n),e.setWidgetDataForKey(i.queryKey,r)}),[r?.hasData,r?.isLoading,r?.isErrored]),(0,h.tZ)(n.Fragment,{})}j.displayName="QueryHandler",_.displayName="SingleQueryHandler",k.displayName="QueryResultSaver";var z=a("./app/components/charts/styles.tsx"),E=a("./app/components/questionTooltip.tsx"),F=a("./app/components/textOverflow.tsx");function N(e){const{title:t,titleTooltip:a,Subtitle:i,HeaderActions:n,InteractiveTitle:r}=e;return(0,h.BX)(I,{children:[(0,h.BX)(M,{children:[(0,h.BX)(W,{"data-test-id":"performance-widget-title",children:[r?(0,h.tZ)(r,{...e}):(0,h.tZ)(F.Z,{children:t}),(0,h.tZ)(w,{}),a&&(0,h.tZ)(E.Z,{position:"top",size:"sm",title:a})]}),i?(0,h.tZ)(i,{...e}):null]}),(0,h.tZ)(K,{children:n&&(0,h.tZ)(n,{...e})})]})}N.displayName="WidgetHeader";const W=(0,i.Z)(z.ws,{target:"evi51ay3"})({name:"ld8wu3",styles:"position:relative;z-index:initial"}),M=(0,i.Z)("div",{target:"evi51ay2"})({name:"6kz1wu",styles:"display:flex;flex-direction:column;align-items:flex-start"}),I=(0,i.Z)("div",{target:"evi51ay1"})("display:flex;justify-content:space-between;align-items:flex-start;gap:",(0,d.Z)(1),";"),K=(0,i.Z)("div",{target:"evi51ay0"})("display:flex;align-items:center;gap:",(0,d.Z)(1),";");function T(e){const[t,a]=(0,n.useState)({}),i=t[e.chartSetting]??{},r=(0,n.useRef)(i),s=(0,n.useCallback)(((t,i)=>{const n={...r.current,[t]:i};r.current=n,a({[e.chartSetting]:n})}),[t,a]),o=(0,n.useCallback)((t=>{const i={...r.current};delete i[t],r.current=i,a({[e.chartSetting]:i})}),[t,a]),d={widgetData:i,setWidgetDataForKey:s,removeWidgetDataForKey:o},l=Object.entries(e.Queries).map((e=>{let[t,a]=e;return{...a,queryKey:t}})),c=(0,b.Z)(),p=e.Visualizations.reduce(((e,t)=>e+t.height),0);return(0,h.tZ)(n.Fragment,{children:(0,h.BX)(x,{chartSetting:e.chartSetting,children:[(0,h.tZ)(j,{eventView:e.eventView,widgetData:i,setWidgetDataForKey:s,removeWidgetDataForKey:o,queryProps:e,queries:l,api:c}),(0,h.tZ)(L,{...e,...d,totalHeight:p})]})})}function L(e){const{Visualizations:t,chartHeight:a,totalHeight:i,containerType:n,EmptyComponent:r}=e,o=(e=>{let{containerType:t}=e;return"panel"===t?q:S})({containerType:n}),d=Object.keys(e.Queries).length,p=Object.values(e.widgetData).length!==d,g=!p&&Object.values(e.widgetData).every((e=>!e||e.hasData)),m=Object.values(e.widgetData).some((e=>!e||e.isLoading)),u=!p&&Object.values(e.widgetData).some((e=>e&&e.isErrored));return(0,h.BX)(o,{"data-test-id":"performance-widget-container",children:[(0,h.tZ)(H,{children:(0,h.tZ)(N,{...e})}),(0,h.tZ)(C,{isLoading:m,isErrored:u,hasData:g,errorComponent:(0,h.tZ)(V,{height:i}),dataComponents:t.map(((t,i)=>(0,h.tZ)(H,{noPadding:t.noPadding,bottomPadding:t.bottomPadding,"data-test-id":"widget-state-has-data",onClick:()=>{return t=e.chartSetting,a=e.organization,void(0,l.Z)("performance_views.landingv3.widget.interaction",{organization:a,widget_type:t});var t,a},children:(0,c.Z)({value:(0,h.tZ)(t.component,{grid:A,queryFields:t.fields,widgetData:e.widgetData,height:a}),fixed:(0,h.tZ)(s.Z,{height:`${a}px`})})},i))),loadingComponent:(0,h.tZ)(O,{height:`${i}px`}),emptyComponent:r?(0,h.tZ)(r,{}):(0,h.tZ)(O,{height:`${i}px`})})]})}T.displayName="GenericPerformanceWidget",L.displayName="DataDisplay";const V=e=>(0,h.tZ)(r.Z,{"data-test-id":"widget-state-is-errored",height:`${e.height}px`,children:(0,h.tZ)(o.F,{color:"gray300",size:"lg"})});V.displayName="DefaultErrorComponent";const A={left:(0,d.Z)(0),right:(0,d.Z)(0),top:(0,d.Z)(2),bottom:(0,d.Z)(1)},H=(0,i.Z)("div",{target:"eqcpc8s1"})("padding-left:",(e=>e.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-right:",(e=>e.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-bottom:",(e=>e.bottomPadding?(0,d.Z)(1):(0,d.Z)(0)),";"),O=(0,i.Z)(s.Z,{target:"eqcpc8s0"})({name:"cs3onb",styles:"border-color:transparent;border-bottom-right-radius:inherit;border-bottom-left-radius:inherit"});T.defaultProps={containerType:"panel",chartHeight:200}},"./app/views/performance/landing/widgets/components/selectableList.tsx":(e,t,a)=>{a.d(t,{Nm:()=>v,QE:()=>Z,S$:()=>h,ZP:()=>u,qL:()=>f,xq:()=>x});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=a("./app/components/emptyStateWarning.tsx"),r=a("./app/components/forms/controls/radioGroup.tsx"),s=a("./app/components/links/link.tsx"),o=a("./app/components/radio.tsx"),d=a("./app/components/tooltip.tsx"),l=a("./app/icons/index.tsx"),c=a("./app/locale.tsx"),p=a("./app/styles/space.tsx"),g=a("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),m=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){return(0,m.tZ)("div",{children:e.items.map(((t,a)=>(0,g.az)(y,{...e,isSelected:a===e.selectedIndex,currentIndex:a,key:a},t())))})}function y(e){let{isSelected:t,currentIndex:a,children:i,setSelectedIndex:n,radioColor:s}=e;return(0,m.BX)(q,{children:[(0,m.tZ)(S,{color:s??"",children:(0,m.tZ)(r.V,{index:a,role:"radio",children:(0,m.tZ)(o.Z,{checked:t,onChange:()=>n(a)})})}),i]})}u.displayName="SelectableList",y.displayName="SelectableItem";const h=(0,i.Z)("div",{target:"e1fgyx4u7"})("text-align:right;display:flex;align-items:center;justify-content:center;padding:0 ",(0,p.Z)(1),";"),Z=(0,i.Z)("span",{target:"e1fgyx4u6"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeMedium),";display:inline-block;"),f=(0,i.Z)(s.Z,{target:"e1fgyx4u5"})({name:"pu304d",styles:"flex-grow:1;display:inherit"}),x=()=>(0,m.tZ)(D,{small:!0,children:(0,c.t)("No results")});function v(e){return(0,m.tZ)(w,{title:(0,c.t)("Exclude this transaction from the search filter."),children:(0,m.tZ)(b,{onClick:()=>{e.onClick(),e.setSelectListIndex(0)}})})}x.displayName="WidgetEmptyStateWarning",v.displayName="ListClose";const w=(0,i.Z)(d.Z,{target:"e1fgyx4u4"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),b=(0,i.Z)(l.bM,{target:"e1fgyx4u3"})("cursor:pointer;color:",(e=>e.theme.gray200),";"),D=(0,i.Z)(n.Z,{target:"e1fgyx4u2"})({name:"1t1oqhu",styles:"min-height:300px;justify-content:center"}),q=(0,i.Z)("div",{target:"e1fgyx4u1"})("display:flex;border-top:1px solid ",(e=>e.theme.border),";padding:",(0,p.Z)(1)," ",(0,p.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";"),S=(0,i.Z)("div",{target:"e1fgyx4u0"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(e=>e.color),";}")}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_widgets_components_performanceWidget_tsx-app_views_performance_-1d625a.9de54a1d3219943c2375d70266c93dbe.js.map