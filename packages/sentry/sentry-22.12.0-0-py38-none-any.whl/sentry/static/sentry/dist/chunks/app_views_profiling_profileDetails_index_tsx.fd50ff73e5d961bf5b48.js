"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_profileDetails_index_tsx"],{"./app/components/gridEditable/sortLink.tsx":(e,t,r)=>{r.d(t,{Z:()=>g});var o=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react-router/es/index.js"),s=r("../node_modules/lodash/omit.js"),i=r.n(s),a=r("./app/components/links/link.tsx"),l=r("./app/icons/index.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){let{align:t,title:r,canSort:o,generateSortLink:s,onClick:i,direction:a,replace:l}=e;const u=s();if(!u||!o)return(0,c.tZ)(d,{align:t,children:r});const g=a?(0,c.tZ)(m,{size:"xs",direction:"desc"===a?"down":"up"}):null;return(0,c.BX)(p,{align:t,to:u,onClick:e=>{l&&(e.preventDefault(),n.browserHistory.replace(u)),i?.(e)},children:[r," ",g]})}u.displayName="SortLink";const p=(0,o.Z)((e=>{const t=i()(e,["align","css"]);return(0,c.tZ)(a.Z,{...t})}),{target:"e1xb2te62"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),d=(0,o.Z)("div",{target:"e1xb2te61"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),m=(0,o.Z)(l.CC,{target:"e1xb2te60"})({name:"40f4ru",styles:"vertical-align:top"}),g=u},"./app/components/searchBar.tsx":(e,t,r)=>{r.d(t,{Z:()=>h,p:()=>f});var o=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react/index.js"),s=r("./app/components/button.tsx"),i=r("./app/components/inputGroup.tsx"),a=r("./app/icons/index.tsx"),l=r("./app/icons/iconClose.tsx"),c=r("./app/locale.tsx"),u=r("./app/styles/space.tsx"),p=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{query:t,defaultQuery:r="",onChange:o,onSearch:s,width:u,size:d,className:h,trailing:y,...b}=e;const k=(0,n.useRef)(null),[w,x]=(0,n.useState)(t??r);(0,n.useEffect)((()=>{"string"==typeof t&&x(t)}),[t]);const v=(0,n.useCallback)((e=>{const{value:t}=e.target;x(t),o?.(t)}),[o]),C=(0,n.useCallback)((e=>{e.preventDefault(),k.current?.blur(),s?.(w)}),[s,w]),S=(0,n.useCallback)((()=>{x(""),o?.(""),s?.("")}),[o,s]);return(0,p.tZ)(m,{onSubmit:C,className:h,children:(0,p.BX)(i.BZ,{children:[(0,p.tZ)(i.t_,{disablePointerEvents:!0,children:(0,p.tZ)(a.jV,{color:"subText",size:"xs"===d?"xs":"sm"})}),(0,p.tZ)(g,{...b,ref:k,type:"text",name:"query",autoComplete:"off",value:w,onChange:v,width:u,size:d}),(0,p.BX)(i.Oj,{children:[y,!!w&&(0,p.tZ)(f,{type:"button",size:"zero",borderless:!0,onClick:S,icon:(0,p.tZ)(l.b,{size:"xs"}),"aria-label":(0,c.t)("Clear")})]})]})})}d.displayName="SearchBar";const m=(0,o.Z)("form",{target:"e4xnwji2"})({name:"4bgdod",styles:"display:block;position:relative"}),g=(0,o.Z)(i.II,{target:"e4xnwji1"})((e=>e.width&&`width: ${e.width};`),";"),f=(0,o.Z)(s.ZP,{target:"e4xnwji0"})("color:",(e=>e.theme.subText),";padding:",(0,u.Z)(.5),";"),h=d},"./app/utils/profiling/tableRenderer.tsx":(e,t,r)=>{r.d(t,{w:()=>s});var o=r("./app/components/gridEditable/sortLink.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(e){let{currentSort:t,generateSortLink:r,rightAlignedColumns:s,sortableColumns:i,onClick:a}=e;return(e,l)=>(0,n.tZ)(o.Z,{onClick:t=>a?.(e,t),align:s?.has(e.key)?"right":"left",title:e.name,direction:t?.key===e.key?t?.order:void 0,canSort:i?.has(e.key)||!1,generateSortLink:r?.(e.key)??(()=>{}),replace:!0})}},"./app/utils/profiling/units/units.ts":(e,t,r)=>{r.d(t,{CD:()=>n,ab:()=>l,s4:()=>i}),r("../node_modules/core-js/modules/es.error.cause.js");const o={nanoseconds:1e-9,microseconds:1e-6,milliseconds:.001,seconds:1};function n(e,t,r){const n=Math.log10(o[t]),s=Math.log10(o[r]);return e*Math.pow(10,n-s)}const s=(e,t,r)=>e.toFixed(r)+t;function i(e){const t=o[e];if(void 0===t)throw new Error(`Cannot format unit ${e}, duration mapping is not defined`);return e=>{const r=e*t;return r>=1?s(r,"s",2):r/.001>=1?s(r/.001,"ms",2):r/1e-6>=1?s(r/1e-6,"Î¼s",2):s(r/1e-9,"ns",2)}}function a(e,t){return Math.floor(e).toString().padStart(t,"0")}function l(e){const t=o[e];if(void 0===t)throw new Error(`Cannot format unit ${e}, duration mapping is not defined`);return e=>{const r=e*t,o=1e3*r;return`${a(r/60,2)}:${a(r%60,2)}.${a(o%1e3,3)}`}}},"./app/utils/useEffectAfterFirstRender.ts":(e,t,r)=>{r.d(t,{K:()=>n});var o=r("../node_modules/react/index.js");const n=(e,t)=>{const r=(0,o.useRef)(!0);(0,o.useEffect)((()=>{r.current?r.current=!1:e()}),t)}},"./app/views/profiling/profileDetails/index.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>Q});var o=r("../node_modules/react/index.js"),n=r("./app/components/layouts/thirds.tsx"),s=r("./app/components/sentryDocumentTitle.tsx"),i=r("./app/locale.tsx"),a=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),l=r("./app/utils/useOrganization.tsx"),c=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),u=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/react-router/es/index.js")),p=r("../node_modules/lodash/debounce.js"),d=r.n(p),m=r("./app/components/compactSelect.tsx"),g=r("./app/components/gridEditable/index.tsx"),f=r("./app/components/pagination.tsx"),h=r("./app/components/searchBar.tsx"),y=r("./app/styles/space.tsx"),b=r("./app/utils/discover/styles.tsx"),k=r("./app/utils/profiling/routes.tsx"),w=r("./app/utils/profiling/tableRenderer.tsx"),x=r("./app/utils/profiling/units/units.ts"),v=r("./app/utils/useEffectAfterFirstRender.ts"),C=r("./app/utils/useLocation.tsx"),S=r("./app/utils/useParams.tsx"),Z=r("./app/views/profiling/profileGroupProvider.tsx"),j=r("../node_modules/lodash/groupBy.js"),_=r.n(j);function A(e){const t=[];return e.forEach((e=>{e.selfWeight>0&&t.push(e)}),(()=>{})),t.sort(((e,t)=>t.selfWeight-e.selfWeight)).map((t=>({symbol:t.frame.name,file:t.frame.file,image:t.frame.image,thread:e.threadId,type:t.frame.is_application?"application":"system","self weight":t.selfWeight,"total weight":t.totalWeight})))}function P(e,t){return e.reduce(((e,r)=>{const o=r[t];return o&&!e.includes(o)&&e.push(o),e}),[])}function z(e,t,r){const o=_()(e,(e=>function(e,t){return t.map((t=>e[t])).join($)}(e,t))),n=[];for(const e in o){const s=L(e,t),i=o[e];r.forEach((e=>{s[e.key]=e.compute(i)})),n.push(s)}return n}const $=String.fromCharCode(31);function L(e,t){const r=e.split($);return t.reduce(((e,t,o)=>(e[t]=r[o],e)),{})}var E=r("../node_modules/fuse.js/dist/fuse.esm.js"),q=r("../node_modules/query-string/index.js");function T(e){let{key:t,initialState:r}=e;const n=(0,C.T)(),[s,i]=(0,o.useState)(n.query[t]??r),a=(0,o.useCallback)((e=>{const r=u.browserHistory.getCurrentLocation();return{...r,query:{...r.query,[t]:e}}}),[t]),l=(0,o.useCallback)((e=>{u.browserHistory.replace(a(e)),i(e)}),[a]);return(0,o.useEffect)((()=>u.browserHistory.listenBefore((e=>{u.browserHistory.getCurrentLocation().pathname!==e.pathname&&t in e.query&&delete e.query[t]}))),[t]),[s,l,a]}var M=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function B(){const e=(0,C.T)(),[t]=(0,Z.useProfileGroup)(),[r,n]=T({key:"detailView",initialState:"occurrence"}),[s,a]=T({key:"query",initialState:""}),[l,c]=T({key:"cursor",initialState:""}),u=K[r]??K.occurrence,p=l?parseInt(l,10):0,y=(0,o.useMemo)((()=>{const e="resolved"===t.type?t.data.profiles.flatMap(A):[];return u.transform(e)}),[t,u]),{search:b}=function(e,t){const r=(0,o.useMemo)((()=>new E.default(e,t)),[e]);return{search:(0,o.useCallback)(((t,o)=>t?r.search(t,o).map((e=>e.item)):e),[r,e]),searchIndex:r}}(y,{keys:u.search.key,threshold:.3}),k=(0,o.useMemo)((()=>d()((e=>S(b(e))),500)),[b]),[x,S]=(0,o.useState)(y),[j,_]=T({key:"type"}),[z,$]=T({key:"image"}),{filters:L,columnFilters:B,filterPredicate:W}=function(e,t){const{columns:r}=t,[n,s]=(0,o.useState)((i=t.initialState)?Object.entries(i).reduce(((e,t)=>{let[r,o]=t;return e[r]=void 0,Array.isArray(o)&&(e[r]=o),"string"==typeof o&&(e[r]=[o]),e}),{}):{});var i;const a=(0,o.useMemo)((()=>{function t(e){return t=>{s((r=>({...r,[e]:t.length>0?t.map((e=>e.value)):void 0})))}}return r.reduce(((r,o)=>(r[o]={values:P(e,o).sort(((e,t)=>e.localeCompare(t))),onChange:t(o)},r)),{})}),[e,r]),l=(0,o.useRef)(!1);(0,o.useEffect)((()=>{l.current||0===e.length||(s((e=>Object.entries(e).reduce(((e,t)=>{const[r,o]=t,n=a[r].values,s=o?.filter((e=>n.includes(e)));return e[r]=Array.isArray(s)&&s.length>0?s:void 0,e}),{}))),l.current=!0)}),[e.length,a,n]);const c=(0,o.useCallback)((e=>{let t=!0;for(const r in n){const o=n[r];if(!o)continue;const s=e[r];if(t=o.includes(s),!t)return!1}return t}),[n]);return{filters:n,columnFilters:a,filterPredicate:c}}(y,{columns:["type","image"],initialState:{type:j,image:z}});(0,o.useEffect)((()=>{_(L.type),$(L.image)}),[L,_,$]);const{currentSort:H,generateSortLink:R,sortCompareFn:N}=function(e){const{sortableColumns:t,querystringKey:r,defaultSort:n}=e,[s,i,a]=T({key:r}),l=(0,o.useMemo)((()=>{let e=s??"";const r="-"===e[0];return r&&(e=e.slice(1)),e&&t.includes(e)?{key:e,order:r?"desc":"asc"}:n}),[t,n,s]),c=(0,o.useCallback)((e=>{if(!t.includes(e))return()=>{};if(!l)return()=>a(e);const r=l.key===e&&"desc"===l.order?"asc":"desc";return()=>a(`${"desc"===r?"-":""}${e}`)}),[l,t,a]),u=(0,o.useCallback)(((e,t)=>{const r=e[l.key],o=t[l.key];return r&&o?"number"==typeof r&&"number"==typeof o?"asc"===l.order?r-o:o-r:"string"==typeof r&&"string"==typeof o?"asc"===l.order?r.localeCompare(o):o.localeCompare(r):1:1}),[l]);return{currentSort:l,generateSortLink:c,sortCompareFn:u}}({...u.sort,querystringKey:"functionsSort"}),G=(0,o.useCallback)((e=>{a(e),c(void 0),k(e)}),[c,a,k]);(0,v.K)((()=>{S(b(s??""))}),[y,b]);const O=(0,o.useMemo)((()=>x.filter(W)),[W,x]),X=(0,o.useMemo)((()=>O.sort(N)),[O,N]),V=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const n=(0,C.T)();return(0,o.useMemo)((()=>{const o=t>=r?"true":"false",s=t>=r?t-r:0,i={...n.query,cursor:s},a=`<${n.pathname}${q.stringify(i)}>; rel="previous"; results="${o}"; cursor="${s}"`,l=t+r<e.length?"true":"false",c=t+r<e.length?t+r:0,u={...n.query,cursor:c};return`${a},<${n.pathname}${q.stringify(u)}>; rel="next"; results="${l}"; cursor="${c}"`}),[t,n,e,r])}(X,p),Q=X.slice(p,p+50);return(0,M.BX)(o.Fragment,{children:[(0,M.BX)(F,{children:[(0,M.tZ)(m.Z,{options:Object.values(K).map((e=>e.option)),value:u.option.value,triggerProps:{prefix:(0,i.t)("View")},placement:"bottom right",onChange:e=>{a(""),c(void 0),n(e.value)}}),(0,M.tZ)(h.Z,{defaultQuery:"",query:s,placeholder:u.search.placeholder,onChange:G}),(0,M.tZ)(m.Z,{options:B.type.values.map((e=>({value:e,label:e}))),value:L.type,triggerLabel:!L.type||Array.isArray(L.type)&&L.type.length===B.type.values.length?(0,i.t)("All"):void 0,triggerProps:{prefix:(0,i.t)("Type")},multiple:!0,onChange:B.type.onChange,placement:"bottom right"}),(0,M.tZ)(m.Z,{options:B.image.values.map((e=>({value:e,label:e}))),value:L.image,triggerLabel:!L.image||Array.isArray(L.image)&&L.image.length===B.image.values.length?(0,i.t)("All"):void 0,triggerProps:{prefix:(0,i.t)("Package")},multiple:!0,onChange:B.image.onChange,placement:"bottom right",isSearchable:!0})]}),(0,M.tZ)(g.ZP,{isLoading:"loading"===t.type,error:"errored"===t.type,data:Q,columnOrder:u.columns.map((e=>D[e])),columnSortBy:[H],scrollable:!0,stickyHeader:!0,height:"75vh",grid:{renderHeadCell:(0,w.w)({rightAlignedColumns:new Set(u.rightAlignedColumns),sortableColumns:new Set(u.rightAlignedColumns),currentSort:H,generateSortLink:R}),renderBodyCell:I},location:e}),(0,M.tZ)(f.Z,{pageLinks:V})]})}B.displayName="ProfileDetailsTable";const F=(0,c.Z)("div",{target:"ecfujpj0"})("display:grid;grid-template-columns:auto 1fr auto auto;gap:",(0,y.Z)(2),";margin-bottom:",(0,y.Z)(2),";");function I(e,t,r,o){return(0,M.tZ)(H,{column:e,dataRow:t,rowIndex:r,columnIndex:o})}I.displayName="renderFunctionCell";const W=(0,x.s4)("nanoseconds");function H(e){let{column:t,dataRow:r}=e;const o=r[t.key],{orgId:n,projectId:s,eventId:a}=(0,S.U)();switch(t.key){case"p75":case"p95":case"self weight":case"total weight":return(0,M.tZ)(b.Hw,{children:W(o)});case"count":return(0,M.tZ)(b.Hw,{children:o});case"image":return(0,M.tZ)(b.W2,{children:o??(0,i.t)("Unknown")});case"thread":return(0,M.tZ)(b.W2,{children:(0,M.tZ)(u.Link,{to:(0,k.TH)({orgSlug:n,projectSlug:s,profileId:a,query:{tid:r.thread}}),children:o})});case"symbol":return(0,M.tZ)(b.W2,{children:(0,M.tZ)(u.Link,{to:(0,k.TH)({orgSlug:n,projectSlug:s,profileId:a,query:{frameName:r.symbol,framePackage:r.image,tid:r.thread??r.tids?.[0]}}),children:o})});default:return(0,M.tZ)(b.W2,{children:o})}}const D={symbol:{key:"symbol",name:(0,i.t)("Symbol"),width:g.z7},image:{key:"image",name:(0,i.t)("Package"),width:g.z7},file:{key:"file",name:(0,i.t)("File"),width:g.z7},thread:{key:"thread",name:(0,i.t)("Thread"),width:g.z7},type:{key:"type",name:(0,i.t)("Type"),width:g.z7},"self weight":{key:"self weight",name:(0,i.t)("Self Weight"),width:g.z7},"total weight":{key:"total weight",name:(0,i.t)("Total Weight"),width:g.z7},p75:{key:"p75",name:(0,i.t)("P75(Self)"),width:g.z7},p95:{key:"p95",name:(0,i.t)("P95(Self)"),width:g.z7},count:{key:"count",name:(0,i.t)("Count"),width:g.z7}},R=(e,t)=>{const r=Array.from(e).sort(((e,t)=>e-t)),o=t*(r.length-1),n=Math.floor(o),s=o%1;return o===n?r[o]:r[n]*(1-s)+r[n+1]*s},N={key:"p75",compute:e=>R(e.map((e=>e["self weight"])),.75)},G={key:"p95",compute:e=>R(e.map((e=>e["self weight"])),.95)},O={key:"count",compute:e=>e.length},X={key:"tids",compute:e=>e.reduce(((e,t)=>{const r=t.thread;return e.includes(r)||e.push(r),e}),[])},K={occurrence:{option:{label:(0,i.t)("Slowest Functions"),value:"occurrence"},columns:["symbol","image","file","thread","type","self weight","total weight"],transform:e=>e.slice(0,500),search:{key:["symbol"],placeholder:(0,i.t)("Search for frames")},sort:{sortableColumns:["self weight","total weight"],defaultSort:{key:"self weight",order:"desc"}},rightAlignedColumns:["self weight","total weight"]},symbol:{option:{label:(0,i.t)("Group by Symbol"),value:"symbol"},columns:["symbol","type","image","p75","p95","count"],search:{key:["symbol"],placeholder:(0,i.t)("Search for frames")},transform:e=>z(e,["symbol","type","image"],[N,G,O,X]),sort:{sortableColumns:["p75","p95","count"],defaultSort:{key:"p75",order:"desc"}},rightAlignedColumns:["p75","p95","count"]},package:{option:{label:(0,i.t)("Group by Package"),value:"package"},columns:["image","type","p75","p95","count"],search:{key:["image"],placeholder:(0,i.t)("Search for packages")},transform:e=>z(e,["type","image"],[N,G,O]),sort:{sortableColumns:["p75","p95","count"],defaultSort:{key:"p75",order:"desc"}},rightAlignedColumns:["p75","p95","count"]},file:{option:{label:(0,i.t)("Group by File"),value:"file"},columns:["file","type","image","p75","p95","count"],search:{key:["file"],placeholder:(0,i.t)("Search for files")},transform:e=>z(e,["type","image","file"],[N,G,O]),sort:{sortableColumns:["p75","p95","count"],defaultSort:{key:"p75",order:"desc"}},rightAlignedColumns:["p75","p95","count"]}};function V(){const e=(0,l.Z)();return(0,o.useEffect)((()=>{(0,a.Z)("profiling_views.profile_summary",{organization:e})}),[e]),(0,M.tZ)(o.Fragment,{children:(0,M.tZ)(s.Z,{title:(0,i.t)("Profiling â Details"),orgSlug:e.slug,children:(0,M.tZ)(n.uT,{children:(0,M.tZ)(n.or,{fullWidth:!0,children:(0,M.tZ)(B,{})})})})})}V.displayName="ProfileDetails";const Q=V}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_profileDetails_index_tsx.86b29fd3b695edd05fca3ec39d87bcb1.js.map